# Popisná statistika

Jak jsme zmínili v úvodu popisná statistika je jeden z hlavních cílů statistiky. Úkolem popisné statistiky je shrnout informace o našem výběru do pár čísel, které nám pomohou pochopit jaké má náš výběr vlastnosti. Hlavními vlastnostmi, které nás zajímají je:

1) Jaká je typická hodnota měřené proměnné (míra centrální tendence)

2) Na kolik se liší hodnoty jendotlivých pozorování (míra rozptýlenosti)

Abychom si popisnou statistiku představili, budeme používat Novoroční/Vánoční projev prezidenta republiky.

Nejdříve si data načteme. Text můžeme načíst různými způsoby, my použijeme funkci `readLines`, která vrátí zpět vektor.
```{r}
prezident <- readLines("../dats/prezident.txt", encoding = "UTF-8")
```

Nejdříve text očistíme o mezery a čárky, přeneseme vše do malých písmen, rozdělíme na věty a potom na slova. Protože tuto proceduru budeme dělat vícekrát uděláme si na to funkci. Výstupem této funkce bude list, jehož každý element reprezentuje jednu větu a v rámci této věty jaká obsahuje slova.  
```{r}
vycistit_text <- function(.text) {
  # vse malym pismem
  .text <- tolower(.text)

  # odstranime prazdne radky
  .text <- .text[.text != ""]

  # odstranime carky
  .text <- gsub(pattern = ",", replacement = "", x = .text)

  # rozdelit na vety, pokud najdeme "." nebo "!" nebo "?"
  .text <- unlist(strsplit(.text, split = "\\.|\\!|\\?"))

  # vymazeme mezery na zacatku a konci
  .text <- trimws(.text, which = c("left"))
  .text <- trimws(.text, which = c("right"))

  # odstranime prazdne prvky, ktere vznikly protoze po tecce neni zadny text
  .text <- .text[.text != ""]

  # rozdelime na slova
  slova <- list()
  for (i in 1:length(.text)) {
    slova[[i]] <- unlist(strsplit(.text[i], split = " "))
  }
  return(slova)
}
```

```{r}
prezident_clean <- vycistit_text(prezident)
```

## Míry centrální tendence
Míry centrální tendence se snaží popsat nějakou typickou hodnotu proměnné. My si představíme modus, medián, průměr, absolutní a relativní četnost. Jaké míry centrální tendence můžeme na proměnné vypočítat se liší podle typu proměnné. Nominální proměnná je taková proměnná, u které nemůžeme hodnoty seřadit od nejmenšího po největší a nemůžeme ani určit o kolik je jedna hodnota větší než jiná. Tou nejzákladnější popisnou statistikou je četnost nějakého jevu a z ní odvozená míra centrální tendence **modus**. Modus je tedy nejčastější hodnota proměnné. Když se zamyslíte, tak u proměnné u které nemůžeme hodnoty seřadit ani jinak matematicky porovnat je nejčastější hodnota nejvíce vypovídající o typické hodnotě proměnné. Pojďme si jako příklad vypočítat nejčastější slovo z projevu.  

```{r}
# nejprve prevedeme list na vekor
slova <- unlist(prezident_clean)
tabulka_slov <- table(slova)
```

Jak je vidět, naše tabulka četností je velká, obsahuje 651 hodnot. To mimo jiné znamená, že v projevu bylo použito 651 slov. Abychom získali nejčastější hodnotu musíme si tabulku seřadit od největší četnost po nejmenší a zobrazit prvních 10 hodnot.  
```{r}
dim(tabulka_slov)
```
```{r}
tabulka_slov_serazena <- sort(tabulka_slov, decreasing = TRUE)
head(tabulka_slov_serazena, 10)
```

Modus této proměnné by byla hodnota "a", která se vyskytla 45x. To je v textové analýze typické a tato slova se označují jako "stopwords" a jsou zpravidla a textové analýzy vyřazena.


Další měrou centrální tendence je **median**. Medián nám značí prostřední hodnotu nějaké proměnné. Můžeme si jeho výpočet představit tak, že hodnoty proměnné seřadíme od nejmenší po největší a vyberete hodnotu, která bude přesně uprostřed. Tato hodnota je medián. Matematicky se medián u proměnné $x$ vypočítá jako $median(x) = x_{(n + 1)/2}$. Pokud má naše proměnná sudý počet čísel, vypočítá se medián zpravidla jako průměr dvou prostředních hodnot, tedy $median(x) = \frac{x_{n/2} + x_{n/2+1}}{2}$. 

Řekněme, že bychom chtěli vědět medián počtu slov ve větě. Nejdříve si musíme pro každou větu (prvek listu `prezident_clean`) vypočítat počet slov. 
```{r}
pocet_slov <- sapply(prezident_clean, length)
```

Velmi dobrým zvykem je si rozložení hodnot proměnné zobrazit graficky. Grafické zobrzení nám vždy poví nejenom o typické hodnotě proměnné, ale i o tom, jak se hodnoty liší (viz Míry rozptýlenosti \@ref(#desc-vars)). Pokud máme číselnou proměnnou je nejčastějším způsobem, jak zobrazit hodnoty proměnné histogram. Histogram je:

> "...je to grafické znázornění distribuce dat pomocí sloupcového grafu se sloupci stejné šířky, vyjadřující šířku intervalů 
> (tříd), přičemž výška sloupců vyjadřuje četnost sledované veličiny v daném intervalu."
Zdroj: [Wikipedia](https://cs.wikipedia.org/wiki/Histogram)

Můžeme ho vytvořit pomocí funkce `hist`. Vidíme, že nejvíce nejčastěji věta obsahuje mezi 5 až 25 slovy, ale některé věty obsahují i více než 35 slov. 
```{r, fig.cap='Příklad histogramu na číselné (kardinální) proměnné'}
hist(pocet_slov, col = "#1f77b4", xlab = "Počet slov ve větě", ylab = "Četnost", main = "Histogram počtu slov ve větě")
```

Medián můžeme vypočítat pomocí funkce `median`. Mediánový počet slov ve větě je tedy 15.5.

```{r}
n <- length(pocet_slov)
# protoze mame sudy pocet slov vypocitame prumer dvou prostrednich hodnot
i1 <- n / 2
i2 <- i1 + 1
.median <- mean(pocet_slov[c(i1, i2)])
# nebo pomoci funkce median(pocet_slov)
.median
```

Pojďme si výpočet zobrazit graficky a seřadit si počet slov od nejmenšího po největší a zobrazit si medián na grafu
```{r, fig.cap='Seřazení proměnné pro ilustraci výpočtu mediánu'}
plot(1:n,
  sort(pocet_slov),
  col = "#1f77b4",
  ylab = "Počet slov ve větě", xlab = "Pořadí", main = "Počet slov ve větě seřazený podle velikosti",
  type = "h",
  lwd = 5
)
# pridame prostredni hodnoty
lines(i1, pocet_slov[i1], col = "grey", type = "h", lwd = 5)
lines(i2, pocet_slov[i2], col = "grey", type = "h", lwd = 5)

# pridame median
lines(mean(c(i1, i2)), .median, col = "red", type = "h", lwd = 1, lty = 2)
lines(c(-2, mean(c(i1, i2))), c(.median, .median), col = "red", type = "l", lwd = 1, lty = 2)
legend("topleft",
  col = c("grey", "red"),
  lwd = c(4, 4),
  legend = c("Prostřední hodnoty", "Median"),
  cex = 0.7
)
```


Asi nejčastější mírou centrální tendence, která se používá je průměr. Průměr je možné vypočítat pouze pro kardinální proměnné. Technicky kardinální proměnné rozlišujeme na **diskrétní** a **spojitou**. Diskrétní nabývá celých čísel (1,2,3,4 etc., například počet dětí), tedy $\in Z$. Spojitá proměnná pak teoreticky nebývá nekonečně mnoho hodnot, prakticky je ale omezena tím, jak přesně dokážeme danou metriku měřit. Platí ale, že spojité proměnné nabývají racionálních čísel, tedy $\in R$. Průměr proměnné $x$ vypočítáme jako $\overline{x} = \frac{1}{n}\sum_{i=1}^{n} x_i$. Pojďme tedy vypočítat průměrný počet slov ve větě. V `R` můžeme použít funkci `mean`.
```{r}
sum(pocet_slov) / length(pocet_slov)
```

Někdy nechceme všem pozorováním při výpočtu průměru dát stejnou váhu. V takovém případě vypočítáme **vážený průměr**. Jeho vzorec je $\overline{x} = \frac{\sum_{i=1}^{n} w_ix_i}{\sum_{i=1}^{n}w_i}$. Řekněme například, že bychom průměrný počet slov chtěli vážit pozicí v textu a dát slovům v první větě menší váhu, než slovům, které se objevily později v textu.
```{r}
w <- 1:length(pocet_slov)
sum(w * pocet_slov) / sum(w)
```



## Míry rozptýlenosti {#desc-vars}


Na tomto grafu se můžete podívat co se stane z daty, která jsou normálně rozdělena (viz Kapitola Pravděpodobnostní rozložení) s průměrem 0 a směrodatnou odchylkou 10, 20, 30 a 40.
```{r, warning=FALSE, message=FALSE}
library(plotly)
```
```{r}

# vytvorime data, ktera chceme zobrazit
n <- 1000
mu <- 0
stds <- seq(10, 40, by = 10)
dats <- list()

for(step in 1:length(stds)) {
  dats[[step]] <- list(visible = TRUE,
                        name = paste0('sd = ', stds[step]),
                        x=rnorm(n, mu, stds[step]))
}


# do grafu pridame nase data
fig <- plotly::plot_ly(alpha = 0.3)
for(i in 1:length(stds)) {
  fig  <- fig %>% plotly::add_histogram(x = dats[[i]][["x"]], 
                        visible = dats[[i]][["visible"]], 
                        showlegend = TRUE,
                        name = dats[[i]][["name"]]) 
}
# upravime nastaveni
fig <- fig %>% plotly::layout(barmode = "overlay",
                      xaxis = list(title = "X", range = c(-100,100)))

# zobrazime
fig
```