<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 10 Neparametrické testy | Úvod do statistiky</title>
  <meta name="description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 10 Neparametrické testy | Úvod do statistiky" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 10 Neparametrické testy | Úvod do statistiky" />
  
  <meta name="twitter:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

<meta name="author" content="Jan Schubert" />


<meta name="date" content="2022-05-03" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="korelace.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Úvod do statistiky</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Úvod<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#příklad-popisné-statistiky"><i class="fa fa-check"></i><b>1.1</b> Příklad popisné statistiky<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#příklad-inferenční-statistiky"><i class="fa fa-check"></i><b>1.2</b> Příklad inferenční statistiky<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#simulace"><i class="fa fa-check"></i><b>1.3</b> Simulace<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#o-modelech"><i class="fa fa-check"></i><b>1.4</b> O modelech<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="desc-stats.html"><a href="desc-stats.html"><i class="fa fa-check"></i><b>2</b> Popisná statistika<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="desc-stats.html"><a href="desc-stats.html#central-tend"><i class="fa fa-check"></i><b>2.1</b> Míry centrální tendence<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="desc-stats.html"><a href="desc-stats.html#desc-vars"><i class="fa fa-check"></i><b>2.2</b> Míry rozptýlenosti<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="desc-stats.html"><a href="desc-stats.html#kvantily"><i class="fa fa-check"></i><b>2.3</b> Míry polohy<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prob-dist.html"><a href="prob-dist.html"><i class="fa fa-check"></i><b>3</b> Pravděpodobnostní rozdělení<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="prob-dist.html"><a href="prob-dist.html#stats-lang"><i class="fa fa-check"></i><b>3.1</b> Pravděpodobnostní rozdělení jako jazyk statistiky<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="prob-dist.html"><a href="prob-dist.html#binom-dist"><i class="fa fa-check"></i><b>3.2</b> Binomické<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="prob-dist.html"><a href="prob-dist.html#norm-dist"><i class="fa fa-check"></i><b>3.3</b> Normální<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="prob-dist.html"><a href="prob-dist.html#t-dist"><i class="fa fa-check"></i><b>3.4</b> T<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="prob-dist.html"><a href="prob-dist.html#unif-dist"><i class="fa fa-check"></i><b>3.5</b> Uniformní<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="prob-dist.html"><a href="prob-dist.html#pois-dist"><i class="fa fa-check"></i><b>3.6</b> Poisson<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="prob-dist.html"><a href="prob-dist.html#chi-kvadrát"><i class="fa fa-check"></i><b>3.7</b> Chi-kvadrát<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="prob-dist.html"><a href="prob-dist.html#jak-vybrat-správný-model-pro-data"><i class="fa fa-check"></i><b>3.8</b> Jak vybrat správný model pro data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dist-params.html"><a href="dist-params.html"><i class="fa fa-check"></i><b>4</b> Výběrové rozdělení parametrů<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="dist-params.html"><a href="dist-params.html#clv-procento"><i class="fa fa-check"></i><b>4.1</b> Relativní četnost<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="dist-params.html"><a href="dist-params.html#clv-is"><i class="fa fa-check"></i><b>4.2</b> Interval spolehlivosti<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="dist-params.html"><a href="dist-params.html#bootstrap"><i class="fa fa-check"></i><b>4.3</b> Bootstrap<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="dist-params.html"><a href="dist-params.html#clv-mean"><i class="fa fa-check"></i><b>4.4</b> Průměr<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="dist-params.html"><a href="dist-params.html#rozptyl"><i class="fa fa-check"></i><b>4.5</b> Rozptyl<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-test-single.html"><a href="stats-test-single.html"><i class="fa fa-check"></i><b>5</b> Statistické testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats-test-single.html"><a href="stats-test-single.html#postup-statistického-testování"><i class="fa fa-check"></i><b>5.1</b> Postup statistického testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stats-test-single.html"><a href="stats-test-single.html#zvolení-testu"><i class="fa fa-check"></i><b>5.1.1</b> Zvolení testu<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="stats-test-single.html"><a href="stats-test-single.html#test-h0"><i class="fa fa-check"></i><b>5.1.2</b> Formulace nulové a alternativní hypotézy<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="stats-test-single.html"><a href="stats-test-single.html#test-t-statistika"><i class="fa fa-check"></i><b>5.1.3</b> Výpočet testovací statistiky<span></span></a></li>
<li class="chapter" data-level="5.1.4" data-path="stats-test-single.html"><a href="stats-test-single.html#interpretace-výsledku"><i class="fa fa-check"></i><b>5.1.4</b> Interpretace výsledku<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-účinku"><i class="fa fa-check"></i><b>5.2</b> Velikost účinku<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="stats-test-single.html"><a href="stats-test-single.html#souvislost-s-intervalem-spolehlivosti"><i class="fa fa-check"></i><b>5.3</b> Souvislost s intervalem spolehlivosti<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="stats-test-single.html"><a href="stats-test-single.html#test-power"><i class="fa fa-check"></i><b>5.4</b> Síla testu<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-výběru"><i class="fa fa-check"></i><b>5.5</b> Velikost výběru<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="stats-test-single.html"><a href="stats-test-single.html#tests-many"><i class="fa fa-check"></i><b>5.6</b> Mnoho testů<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html"><i class="fa fa-check"></i><b>6</b> Porovnání dvou průměrů a relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#průměry"><i class="fa fa-check"></i><b>6.1</b> Průměry<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#t2-test-ind"><i class="fa fa-check"></i><b>6.1.1</b> Dva nezávislé výběry<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#dva-závislé-výběry"><i class="fa fa-check"></i><b>6.1.2</b> Dva závislé výběry<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#relativní-četnosti"><i class="fa fa-check"></i><b>6.2</b> Relativní četnosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html"><i class="fa fa-check"></i><b>7</b> Porovnání více relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#test-dobré-shody"><i class="fa fa-check"></i><b>7.1</b> Test dobré shody<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#chi-kvadrát-test-nezávislosti"><i class="fa fa-check"></i><b>7.2</b> Chi-kvadrát test nezávislosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html"><i class="fa fa-check"></i><b>8</b> Porovnání více průměrů<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#problém-více-testů"><i class="fa fa-check"></i><b>8.1</b> Problém více testů<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#anova"><i class="fa fa-check"></i><b>8.2</b> ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="korelace.html"><a href="korelace.html"><i class="fa fa-check"></i><b>9</b> Korelace<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="korelace.html"><a href="korelace.html#kovariance"><i class="fa fa-check"></i><b>9.1</b> Kovariance<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="korelace.html"><a href="korelace.html#korelační-koeficient"><i class="fa fa-check"></i><b>9.2</b> Korelační koeficient<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="korelace.html"><a href="korelace.html#statistické-testování-a-interval-spolehlivosti"><i class="fa fa-check"></i><b>9.3</b> Statistické testování a interval spolehlivosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="neparametrické-testy.html"><a href="neparametrické-testy.html"><i class="fa fa-check"></i><b>10</b> Neparametrické testy<span></span></a>
<ul>
<li class="chapter" data-level="10.1" data-path="neparametrické-testy.html"><a href="neparametrické-testy.html#znaménkový-test"><i class="fa fa-check"></i><b>10.1</b> Znaménkový test<span></span></a></li>
<li class="chapter" data-level="10.2" data-path="neparametrické-testy.html"><a href="neparametrické-testy.html#mann-whitney-u-test"><i class="fa fa-check"></i><b>10.2</b> Mann-Whitney U test<span></span></a></li>
<li class="chapter" data-level="10.3" data-path="neparametrické-testy.html"><a href="neparametrické-testy.html#wilcoxon-rank-test"><i class="fa fa-check"></i><b>10.3</b> Wilcoxon Rank Test<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />Tato kniha podléhá <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Úvod do statistiky</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="neparametrické-testy" class="section level1 hasAnchor" number="10">
<h1><span class="header-section-number">Kapitola 10</span> Neparametrické testy<a href="neparametrické-testy.html#neparametrické-testy" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Neparametrické testy používáme, pokud jsou předpoklady některých parametrických testů porušeny, nejčastěji normalita rozdělení nebo předpoklady o spojitosti proměnné. Alternativně bychom na vypočtení výběrových rozdělení statistik mohli použít metodu bootstrapu.</p>
<div id="znaménkový-test" class="section level2 hasAnchor" number="10.1">
<h2><span class="header-section-number">10.1</span> Znaménkový test<a href="neparametrické-testy.html#znaménkový-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Nejjednodušším testem je znaménkový test. Tento test používáme, když chceme porovnat medián proměnné k populační hodnotě. Jde tedy o ekvivalement jednovýběrového t-testu (viz <a href="stats-test-single.html#stats-test-single">5</a>. Pojďme si znaménkový test ukázat na následujícím příkladu. Na filmové databázi IMDb mohou registrovaní uživatelé a uživatelky hodnotit filmy na škále od 1 do 10. Víte, že daný film na této databázi hodnotilo více než půl milionu uživatelů. Správce databáze vám při pracovním pohovoru na pozici datového analytika náhodně vygeneruje 14 hodnocení tohoto filmu:
<span class="math inline">\(x = [3, 7, 4, 10, 1, 6, 9, 8, 3, 6, 7, 5, 9, 8]\)</span>. Vedoucí analytického týmu databáze IMDb vám při pracovním pohovoru stanoví následující úlohu: Jaká je pravděpodobnost, že se jedná o zcela výjimečný film, který dostal od poloviny hodnotících uživatelů databáze známky 9 nebo 10 (tedy medián všech hodnocení je 9 nebo větší)? Graf <a href="neparametrické-testy.html#fig:znam-data">10.1</a> ukazuje hodnocení od nejmenší po největší hodnotu. Horizontální přímka vyjadřuje teoretickou hodnotu 9.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="neparametrické-testy.html#cb160-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">7</span>, <span class="dv">4</span>, <span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">8</span>, <span class="dv">3</span>, <span class="dv">6</span>, <span class="dv">7</span>, <span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">8</span>)</span>
<span id="cb160-2"><a href="neparametrické-testy.html#cb160-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span><span class="fu">length</span>(X)</span>
<span id="cb160-3"><a href="neparametrické-testy.html#cb160-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-4"><a href="neparametrické-testy.html#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">sort</span>(X), </span>
<span id="cb160-5"><a href="neparametrické-testy.html#cb160-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, </span>
<span id="cb160-6"><a href="neparametrické-testy.html#cb160-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Pořadí&quot;</span>,</span>
<span id="cb160-7"><a href="neparametrické-testy.html#cb160-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Hodnocení&quot;</span>,</span>
<span id="cb160-8"><a href="neparametrické-testy.html#cb160-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>)</span>
<span id="cb160-9"><a href="neparametrické-testy.html#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> <span class="dv">9</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:znam-data"></span>
<img src="book_files/figure-html/znam-data-1.png" alt="Sloupcový graf 14 hodnocení filmů" width="672" />
<p class="caption">
Graf 10.1: Sloupcový graf 14 hodnocení filmů
</p>
</div>
<p>V tomto případě tedy testujeme, zda <span class="math inline">\(H_0: \eta \le 8\)</span>, <span class="math inline">\(H_1: \eta &gt; 8\)</span> (tedy 9 a více). Začněme tím, že se podíváme, kolik hodnot je vyšších, než testovaná hodnota <span class="math inline">\(8\)</span>. Znaménko <code>"-"</code> značí hodnotu menší než 8 a znaménko <code>"+"</code> hodnotu větší než 8.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="neparametrické-testy.html#cb161-1" aria-hidden="true" tabindex="-1"></a>h0 <span class="ot">&lt;-</span> <span class="dv">8</span></span>
<span id="cb161-2"><a href="neparametrické-testy.html#cb161-2" aria-hidden="true" tabindex="-1"></a>znamenka <span class="ot">&lt;-</span> X<span class="sc">&gt;</span>h0</span>
<span id="cb161-3"><a href="neparametrické-testy.html#cb161-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb161-4"><a href="neparametrické-testy.html#cb161-4" aria-hidden="true" tabindex="-1"></a>znamenka_table <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(znamenka, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb161-5"><a href="neparametrické-testy.html#cb161-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(znamenka_table) <span class="ot">&lt;-</span> X</span>
<span id="cb161-6"><a href="neparametrické-testy.html#cb161-6" aria-hidden="true" tabindex="-1"></a>znamenka_table</span></code></pre></div>
<pre><code>##   3   7   4  10   1   6   9   8   3   6   7   5   9   8 
## &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;+&quot; &quot;-&quot; &quot;-&quot; &quot;+&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;-&quot; &quot;+&quot; &quot;-&quot;</code></pre>
<p>Pokud by populační hodnota byla rovna <span class="math inline">\(\eta=8\)</span>, z 14 hodnot bychom očekávali 7 vyšších než <span class="math inline">\(\eta=8\)</span> a 7 menších než <span class="math inline">\(\eta=8\)</span>. Jedná se tedy vlastně o příklad binomického rozložení (<a href="prob-dist.html#binom-dist">3.2</a>) s <span class="math inline">\(k=14\)</span> pokusy a pravděpodobností úspěchu <span class="math inline">\(p=0.5\)</span>, tedy <span class="math inline">\(B(14, 0.5)\)</span>. V našem případě je celkem 3 vyšších než testovaná hodnota 8.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="neparametrické-testy.html#cb163-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">14</span></span>
<span id="cb163-2"><a href="neparametrické-testy.html#cb163-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb163-3"><a href="neparametrické-testy.html#cb163-3" aria-hidden="true" tabindex="-1"></a>plusova_znamenka <span class="ot">&lt;-</span> <span class="fu">sum</span>(znamenka)</span>
<span id="cb163-4"><a href="neparametrické-testy.html#cb163-4" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> k, <span class="at">prob =</span> p)</span>
<span id="cb163-5"><a href="neparametrické-testy.html#cb163-5" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> <span class="fu">sum</span>(pmf[x<span class="sc">&gt;=</span>plusova_znamenka])</span>
<span id="cb163-6"><a href="neparametrické-testy.html#cb163-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-7"><a href="neparametrické-testy.html#cb163-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb163-8"><a href="neparametrické-testy.html#cb163-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pmf,</span>
<span id="cb163-9"><a href="neparametrické-testy.html#cb163-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb163-10"><a href="neparametrické-testy.html#cb163-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PMF&quot;</span>,</span>
<span id="cb163-11"><a href="neparametrické-testy.html#cb163-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb163-12"><a href="neparametrické-testy.html#cb163-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>,</span>
<span id="cb163-13"><a href="neparametrické-testy.html#cb163-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, k),</span>
<span id="cb163-14"><a href="neparametrické-testy.html#cb163-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;p=&quot;</span>, <span class="fu">round</span>(p_hodnota, <span class="dv">2</span>))</span>
<span id="cb163-15"><a href="neparametrické-testy.html#cb163-15" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb163-16"><a href="neparametrické-testy.html#cb163-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&gt;=</span>plusova_znamenka], pmf[x<span class="sc">&gt;=</span>plusova_znamenka], <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>)</span>
<span id="cb163-17"><a href="neparametrické-testy.html#cb163-17" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span>k, <span class="dv">0</span><span class="sc">:</span>k)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:znam-chart"></span>
<img src="book_files/figure-html/znam-chart-1.png" alt="Distribuce pozorování větších než teoretická hodnota za předpokladu H0. příklad jednosměrného testu." width="672" />
<p class="caption">
Graf 10.2: Distribuce pozorování větších než teoretická hodnota za předpokladu H0. příklad jednosměrného testu.
</p>
</div>
<p>Graf <a href="neparametrické-testy.html#fig:znam-chart">10.2</a> ukazuje rozdělení počtu hodnot větších než teoretická hodnota 8, pokud by v populaci platila <span class="math inline">\(H_0\)</span>. V našem případě jsme měli 3 hodnoty větší než teoretická hodnota 8. Pokud platí <span class="math inline">\(H_0\)</span>, pak je pravděpodobnost, že bychom z 14 pozorování viděli 3 nebo více větších hodnot než <span class="math inline">\(H_0\)</span> je 0.99. Tedy nemůžeme zamítnout <span class="math inline">\(H_0: \eta \le 8\)</span> ve prospěch <span class="math inline">\(H_1\)</span>. Nelze tedy říci, že by byl medián hodnocení větší nebo roven 9.</p>
<p>Dále na stejných datech formulujeme hypotézu, že medián všech hodnocení tohoto filmu se nerovná 5. Formulujte odpovídající nulovou a alternativní hypotézu. Tedy <span class="math inline">\(H_0: \eta = 5\)</span>, <span class="math inline">\(H_1: \eta \ne 5\)</span>. Opět spočítáme počet případů, kdy je hodnocení vyšší než teoretická hodnota.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="neparametrické-testy.html#cb164-1" aria-hidden="true" tabindex="-1"></a>h0 <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb164-2"><a href="neparametrické-testy.html#cb164-2" aria-hidden="true" tabindex="-1"></a>znamenka <span class="ot">&lt;-</span> X<span class="sc">&gt;</span>h0</span>
<span id="cb164-3"><a href="neparametrické-testy.html#cb164-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb164-4"><a href="neparametrické-testy.html#cb164-4" aria-hidden="true" tabindex="-1"></a>znamenka_table <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(znamenka, <span class="st">&quot;+&quot;</span>, <span class="st">&quot;-&quot;</span>)</span>
<span id="cb164-5"><a href="neparametrické-testy.html#cb164-5" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(znamenka_table) <span class="ot">&lt;-</span> X</span>
<span id="cb164-6"><a href="neparametrické-testy.html#cb164-6" aria-hidden="true" tabindex="-1"></a>znamenka_table</span></code></pre></div>
<pre><code>##   3   7   4  10   1   6   9   8   3   6   7   5   9   8 
## &quot;-&quot; &quot;+&quot; &quot;-&quot; &quot;+&quot; &quot;-&quot; &quot;+&quot; &quot;+&quot; &quot;+&quot; &quot;-&quot; &quot;+&quot; &quot;+&quot; &quot;-&quot; &quot;+&quot; &quot;+&quot;</code></pre>
<p>Pokud by populační hodnota byla rovna 5, pak bychom opět v našem výběru čekali 7 pozorování menších, než teoretická hodnota a 7 větších, než teoretická hodnota. Opět tedy modelujele <span class="math inline">\(B(14,0.5)\)</span>. Graf <a href="neparametrické-testy.html#fig:znam-chart2">10.3</a> ukazuje toto binomické rozložení. Modře je opět vyznačena oblast zamítnutí <span class="math inline">\(H_0\)</span>. Protože používáme oboustranný test, pak je oblast zamítnutí symetricky na obou strannách od očekávané hodnoty.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="neparametrické-testy.html#cb166-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">14</span></span>
<span id="cb166-2"><a href="neparametrické-testy.html#cb166-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb166-3"><a href="neparametrické-testy.html#cb166-3" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">sum</span>(znamenka)</span>
<span id="cb166-4"><a href="neparametrické-testy.html#cb166-4" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> k, <span class="at">prob =</span> p)</span>
<span id="cb166-5"><a href="neparametrické-testy.html#cb166-5" aria-hidden="true" tabindex="-1"></a><span class="co"># *2, protože  máme oboustranný test</span></span>
<span id="cb166-6"><a href="neparametrické-testy.html#cb166-6" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> <span class="fu">sum</span>(pmf[x<span class="sc">&gt;=</span>t])<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb166-7"><a href="neparametrické-testy.html#cb166-7" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb166-8"><a href="neparametrické-testy.html#cb166-8" aria-hidden="true" tabindex="-1"></a>kriticka_hodnota <span class="ot">&lt;-</span> <span class="fu">qbinom</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">size =</span> k, <span class="at">prob =</span> p)</span>
<span id="cb166-9"><a href="neparametrické-testy.html#cb166-9" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pmf,</span>
<span id="cb166-10"><a href="neparametrické-testy.html#cb166-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;x&quot;</span>,</span>
<span id="cb166-11"><a href="neparametrické-testy.html#cb166-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PMF&quot;</span>,</span>
<span id="cb166-12"><a href="neparametrické-testy.html#cb166-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb166-13"><a href="neparametrické-testy.html#cb166-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>,</span>
<span id="cb166-14"><a href="neparametrické-testy.html#cb166-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, k),</span>
<span id="cb166-15"><a href="neparametrické-testy.html#cb166-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;p=&quot;</span>, <span class="fu">round</span>(p_hodnota, <span class="dv">2</span>))</span>
<span id="cb166-16"><a href="neparametrické-testy.html#cb166-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb166-17"><a href="neparametrické-testy.html#cb166-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb166-18"><a href="neparametrické-testy.html#cb166-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&lt;</span>kriticka_hodnota[<span class="dv">1</span>]], pmf[x<span class="sc">&lt;</span>kriticka_hodnota[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>)</span>
<span id="cb166-19"><a href="neparametrické-testy.html#cb166-19" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&gt;</span>kriticka_hodnota[<span class="dv">2</span>]], pmf[x<span class="sc">&gt;</span>kriticka_hodnota[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">15</span>)</span>
<span id="cb166-20"><a href="neparametrické-testy.html#cb166-20" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> t, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb166-21"><a href="neparametrické-testy.html#cb166-21" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">1</span>, <span class="dv">0</span><span class="sc">:</span>k, <span class="dv">0</span><span class="sc">:</span>k)</span>
<span id="cb166-22"><a href="neparametrické-testy.html#cb166-22" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb166-23"><a href="neparametrické-testy.html#cb166-23" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb166-24"><a href="neparametrické-testy.html#cb166-24" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;B(14,0.5)&quot;</span>,</span>
<span id="cb166-25"><a href="neparametrické-testy.html#cb166-25" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Oblast zamítnutí&quot;</span>,</span>
<span id="cb166-26"><a href="neparametrické-testy.html#cb166-26" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Testovací statistika&quot;</span>),</span>
<span id="cb166-27"><a href="neparametrické-testy.html#cb166-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb166-28"><a href="neparametrické-testy.html#cb166-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">1</span>),</span>
<span id="cb166-29"><a href="neparametrické-testy.html#cb166-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb166-30"><a href="neparametrické-testy.html#cb166-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb166-31"><a href="neparametrické-testy.html#cb166-31" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:znam-chart2"></span>
<img src="book_files/figure-html/znam-chart2-1.png" alt="Distribuce pozorování větších než teoretická hodnota za předpokladu H0. Příklad obousměrného testu." width="672" />
<p class="caption">
Graf 10.3: Distribuce pozorování větších než teoretická hodnota za předpokladu H0. Příklad obousměrného testu.
</p>
</div>
<p>Jak je vidět, pravděpodobnost, že bychom za předpokladu <span class="math inline">\(H_0: \eta=5\)</span> sledovali více než 3 hodnot větších než teoretická hodnota nebo 11 menších než teoretická hodnota je 0.42. Nemůžeme tedy zamítnout <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>. V <code>R</code> je možné tento test provést pomocí funkce <code>binom.test</code>.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="neparametrické-testy.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="co"># prvni priklad (H0: eta&lt;=8, H1: eta &gt; 8)</span></span>
<span id="cb167-2"><a href="neparametrické-testy.html#cb167-2" aria-hidden="true" tabindex="-1"></a><span class="co"># binom.test(3, 14, alternative = &quot;greater&quot;)</span></span>
<span id="cb167-3"><a href="neparametrické-testy.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="co"># druhy priklad (H0: eta=5, H1: eta != 5)</span></span>
<span id="cb167-4"><a href="neparametrické-testy.html#cb167-4" aria-hidden="true" tabindex="-1"></a><span class="co"># binom.test(9, 14, alternative = &quot;two.sided&quot;)</span></span></code></pre></div>
</div>
<div id="mann-whitney-u-test" class="section level2 hasAnchor" number="10.2">
<h2><span class="header-section-number">10.2</span> Mann-Whitney U test<a href="neparametrické-testy.html#mann-whitney-u-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tento typ testu se používá, pokud chceme porovnat medián dvou nezávislých výběrů. Narozdíl od t-testu nemusí být proměnné normálně rozděleny.</p>
<p>Pětadvacet studentů angličtiny bylo na začátku školního roku náhodně rozděleno do dvou seminárních skupin. V první skupině probíhala výuka standardním způsobem a ve druhé skupině byla v průběhu roku aplikována nová metoda výuky angličtiny. Na konci školního roku absolvovali obě skupiny studentů jazykovou zkoušku TOEFL (skládající se čtyř částí: reading, listening, speaking a writing). Souhrnné výsledky obou skupin shrnuje následující tabulka:</p>
<table>
<tbody>
<tr class="odd">
<td>Standardní metoda výuky</td>
<td>96</td>
<td>65</td>
<td>67</td>
<td>72</td>
<td>63</td>
<td>55</td>
<td>56</td>
<td>64</td>
<td>84</td>
<td>80</td>
<td>52</td>
<td>51</td>
<td></td>
</tr>
<tr class="even">
<td>Nová metoda výuky</td>
<td>76</td>
<td>80</td>
<td>88</td>
<td>70</td>
<td>83</td>
<td>94</td>
<td>87</td>
<td>90</td>
<td>73</td>
<td>89</td>
<td>79</td>
<td>69</td>
<td>97</td>
</tr>
</tbody>
</table>
<p>Zajímá nás, zda jsou mezi oběma metodami rozdíly u standardizované jazykové zkoušky TOEFL? Tedy <span class="math inline">\(H_0: \eta_1 = \eta_2\)</span> a <span class="math inline">\(H_1: \eta_1 \ne \eta_2\)</span>.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="neparametrické-testy.html#cb168-1" aria-hidden="true" tabindex="-1"></a>standard <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">96</span>, <span class="dv">65</span>, <span class="dv">67</span>, <span class="dv">72</span>, <span class="dv">63</span>, <span class="dv">55</span>, <span class="dv">56</span>, <span class="dv">64</span>, <span class="dv">84</span>, <span class="dv">80</span>, <span class="dv">52</span>, <span class="dv">51</span>)</span>
<span id="cb168-2"><a href="neparametrické-testy.html#cb168-2" aria-hidden="true" tabindex="-1"></a>experiment <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">76</span>, <span class="dv">80</span>, <span class="dv">88</span>, <span class="dv">70</span>, <span class="dv">83</span>, <span class="dv">94</span>, <span class="dv">87</span>, <span class="dv">90</span>, <span class="dv">73</span>, <span class="dv">89</span>, <span class="dv">79</span>, <span class="dv">69</span>, <span class="dv">97</span>)</span>
<span id="cb168-3"><a href="neparametrické-testy.html#cb168-3" aria-hidden="true" tabindex="-1"></a>eta_1 <span class="ot">&lt;-</span> <span class="fu">median</span>(standard)</span>
<span id="cb168-4"><a href="neparametrické-testy.html#cb168-4" aria-hidden="true" tabindex="-1"></a>eta_2 <span class="ot">&lt;-</span> <span class="fu">median</span>(experiment)</span></code></pre></div>
<p>Medián v prvním výběru standardní výuky je 64.5. Medián v druhém výběru experimentální výuky je 83. Jako první vypočítáme pořadí všech hodnot, od nejmenšího po největší hodnotu a sečteme pořadí hodnot pro každou skupinu do <span class="math inline">\(R_1\)</span> a <span class="math inline">\(R_2\)</span>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="neparametrické-testy.html#cb169-1" aria-hidden="true" tabindex="-1"></a>n1 <span class="ot">&lt;-</span> <span class="fu">length</span>(standard)</span>
<span id="cb169-2"><a href="neparametrické-testy.html#cb169-2" aria-hidden="true" tabindex="-1"></a>n2 <span class="ot">&lt;-</span> <span class="fu">length</span>(experiment)</span>
<span id="cb169-3"><a href="neparametrické-testy.html#cb169-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="fu">c</span>(standard, experiment))</span>
<span id="cb169-4"><a href="neparametrické-testy.html#cb169-4" aria-hidden="true" tabindex="-1"></a>R1 <span class="ot">&lt;-</span> <span class="fu">sum</span>(r[<span class="dv">1</span><span class="sc">:</span>n1])</span>
<span id="cb169-5"><a href="neparametrické-testy.html#cb169-5" aria-hidden="true" tabindex="-1"></a>R2 <span class="ot">&lt;-</span> <span class="fu">sum</span>(r[(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>(n1<span class="sc">+</span>n2)])</span></code></pre></div>
<p>Součet pořadí hodnot ve standardní skupině je 104.5. Součet pořadí hodnot v experimentální skupině je 220.5. Nyní vypočítáme testovací statistiku <span class="math inline">\(U\)</span> pro oba výběry. <span class="math inline">\(U_1 = R_1-\frac{n_1(n_1+1)}{2}\)</span> a <span class="math inline">\(U_2 = R_2-\frac{n_2(n_2+1)}{2}\)</span>.</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="neparametrické-testy.html#cb170-1" aria-hidden="true" tabindex="-1"></a>U1 <span class="ot">&lt;-</span> R1 <span class="sc">-</span> (n1<span class="sc">*</span>(n1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb170-2"><a href="neparametrické-testy.html#cb170-2" aria-hidden="true" tabindex="-1"></a>U2 <span class="ot">&lt;-</span> R2 <span class="sc">-</span> (n2<span class="sc">*</span>(n2<span class="sc">+</span><span class="dv">1</span>)<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb170-3"><a href="neparametrické-testy.html#cb170-3" aria-hidden="true" tabindex="-1"></a>U <span class="ot">&lt;-</span> <span class="fu">min</span>(U1, U2)</span>
<span id="cb170-4"><a href="neparametrické-testy.html#cb170-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb170-5"><a href="neparametrické-testy.html#cb170-5" aria-hidden="true" tabindex="-1"></a>mu_U <span class="ot">&lt;-</span> n1<span class="sc">*</span>n2<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb170-6"><a href="neparametrické-testy.html#cb170-6" aria-hidden="true" tabindex="-1"></a>sigma_U <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n1<span class="sc">*</span>n2<span class="sc">*</span>(n1<span class="sc">+</span>n2<span class="sc">+</span><span class="dv">1</span>))<span class="sc">/</span><span class="dv">12</span>)</span>
<span id="cb170-7"><a href="neparametrické-testy.html#cb170-7" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (U<span class="sc">-</span>mu_U) <span class="sc">/</span> sigma_U</span></code></pre></div>
<p>Testovací statistika pro výběr standardní výuky je 26.5 a pro výběr experimentální výuky je 129.5. Jako testovací statistiku <span class="math inline">\(U\)</span> vybereme menší z obou hodnot, tedy <span class="math inline">\(U=min(U_1, U_2)\)</span>. V našem případě je tedy <span class="math inline">\(U\)</span> rovno 26.5. Protože testovací statistika nabývá normálního rozdělení, abyhcom ji mohli porovnat k očekávanému rozdělní za platnosti <span class="math inline">\(H_0\)</span>, musíme vypočítat průměr a směrodatbou odchylku rozdělení této testovací statistiky. Průměr výběrového rozdělení testovací statistiku <span class="math inline">\(U\)</span> vypočítáme jako <span class="math inline">\(\mu_U=\frac{n_1n_2}{2}\)</span>. V našem případě je tato hodnota rovna 78. Směrodatná chyba odhadu <span class="math inline">\(U\)</span> se vypočítá jako <span class="math inline">\(\sigma_U = \sqrt{\frac{n_1n_2(n_1+n_2+1)}{12}}\)</span>. Hodnotu kvantilu testovací statistiky vypočítáme jako <span class="math inline">\(z=\frac{U-\mu_U}{\sigma_U}\)</span>. Graf <a href="neparametrické-testy.html#fig:h0-u">10.4</a> ukazuje rozdělení testovací statistiky <span class="math inline">\(U\)</span> za předpokladu <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="neparametrické-testy.html#cb171-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>,<span class="dv">150</span>, <span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb171-2"><a href="neparametrické-testy.html#cb171-2" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu_U, sigma_U)</span>
<span id="cb171-3"><a href="neparametrické-testy.html#cb171-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb171-4"><a href="neparametrické-testy.html#cb171-4" aria-hidden="true" tabindex="-1"></a>kriticka_mez <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">mean =</span> mu_U, sigma_U)</span>
<span id="cb171-5"><a href="neparametrické-testy.html#cb171-5" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(z))) <span class="sc">*</span><span class="dv">2</span></span>
<span id="cb171-6"><a href="neparametrické-testy.html#cb171-6" aria-hidden="true" tabindex="-1"></a><span class="co"># p_hodnota &lt;- pnorm(U, mu_U, sigma_U) *2 # nebo take</span></span>
<span id="cb171-7"><a href="neparametrické-testy.html#cb171-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-8"><a href="neparametrické-testy.html#cb171-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf, </span>
<span id="cb171-9"><a href="neparametrické-testy.html#cb171-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb171-10"><a href="neparametrické-testy.html#cb171-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb171-11"><a href="neparametrické-testy.html#cb171-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb171-12"><a href="neparametrické-testy.html#cb171-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;U&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb171-13"><a href="neparametrické-testy.html#cb171-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> U, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb171-14"><a href="neparametrické-testy.html#cb171-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&lt;</span>kriticka_mez[<span class="dv">1</span>]], pdf[x<span class="sc">&lt;</span>kriticka_mez[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb171-15"><a href="neparametrické-testy.html#cb171-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&gt;</span>kriticka_mez[<span class="dv">2</span>]], pdf[x<span class="sc">&gt;</span>kriticka_mez[<span class="dv">2</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb171-16"><a href="neparametrické-testy.html#cb171-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb171-17"><a href="neparametrické-testy.html#cb171-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb171-18"><a href="neparametrické-testy.html#cb171-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb171-19"><a href="neparametrické-testy.html#cb171-19" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(</span>
<span id="cb171-20"><a href="neparametrické-testy.html#cb171-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;N(&quot;</span>, mu_U, <span class="st">&quot;, &quot;</span>,</span>
<span id="cb171-21"><a href="neparametrické-testy.html#cb171-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(sigma_U, <span class="dv">3</span>), <span class="st">&quot;)&quot;</span></span>
<span id="cb171-22"><a href="neparametrické-testy.html#cb171-22" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb171-23"><a href="neparametrické-testy.html#cb171-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Testovací statistika&quot;</span>),</span>
<span id="cb171-24"><a href="neparametrické-testy.html#cb171-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb171-25"><a href="neparametrické-testy.html#cb171-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb171-26"><a href="neparametrické-testy.html#cb171-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb171-27"><a href="neparametrické-testy.html#cb171-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb171-28"><a href="neparametrické-testy.html#cb171-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:h0-u"></span>
<img src="book_files/figure-html/h0-u-1.png" alt="Výběrové rozdělení U za předpokladu H0" width="672" />
<p class="caption">
Graf 10.4: Výběrové rozdělení U za předpokladu H0
</p>
</div>
<p>Pravděpodobnost, že bychom za předpokladu <span class="math inline">\(H_0: \eta_1 = \eta_2\)</span> sledovali testovací statistiku takovou nebo extrémnější je 0.005, tedy pod hranicí zvolené <span class="math inline">\(\alpha=0.05\)</span>. Zamítáme tedy <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>.</p>
</div>
<div id="wilcoxon-rank-test" class="section level2 hasAnchor" number="10.3">
<h2><span class="header-section-number">10.3</span> Wilcoxon Rank Test<a href="neparametrické-testy.html#wilcoxon-rank-test" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Tento test je neparametrickou obdobou párového t-testu. Používáme ho tedy, když chceme porovnat medián dvou závislých výběrů. Příklad výpočtu tohoto testu si ukážeme na následujícím příkladu:
Máme náhodný výběr 21 studentů, kteří se v přijímacím řízení hlásí na FSV UK. Všichni studenti dvakrát psali test obecných studijních předpokladů (OSP). Jejich výsledky v podobě percentilů z obou pokusů OSP zobrazuje následující tabulka:</p>
<table style="width:100%;">
<colgroup>
<col width="32%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
<col width="3%" />
</colgroup>
<tbody>
<tr class="odd">
<td>První test</td>
<td>67</td>
<td>80</td>
<td>55</td>
<td>90</td>
<td>71</td>
<td>81</td>
<td>31</td>
<td>72</td>
<td>96</td>
<td>79</td>
<td>82</td>
<td>39</td>
<td>28</td>
<td>65</td>
<td>47</td>
<td>77</td>
<td>17</td>
<td>98</td>
<td>64</td>
<td>43</td>
<td>59</td>
</tr>
<tr class="even">
<td>Druhý test</td>
<td>83</td>
<td>82</td>
<td>67</td>
<td>96</td>
<td>64</td>
<td>95</td>
<td>31</td>
<td>89</td>
<td>95</td>
<td>83</td>
<td>93</td>
<td>37</td>
<td>31</td>
<td>69</td>
<td>42</td>
<td>67</td>
<td>32</td>
<td>97</td>
<td>51</td>
<td>52</td>
<td>67</td>
</tr>
</tbody>
</table>
<p>Dochází mezi uchazeči o studium na FSV UK při druhém pokusu ke zlepšení jejich výsledku testu OSP? Tedy <span class="math inline">\(H_0: \eta_1 = \eta_2\)</span> a <span class="math inline">\(H_1: \eta_1 \ne \eta_2\)</span>.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="neparametrické-testy.html#cb172-1" aria-hidden="true" tabindex="-1"></a>prvni <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">67</span>, <span class="dv">80</span>, <span class="dv">55</span>, <span class="dv">90</span>, <span class="dv">71</span>, <span class="dv">81</span>, <span class="dv">31</span>, <span class="dv">72</span>, <span class="dv">96</span>, <span class="dv">79</span>, <span class="dv">82</span>, <span class="dv">39</span>, <span class="dv">28</span>, <span class="dv">65</span>, <span class="dv">47</span>, <span class="dv">77</span>, <span class="dv">17</span>, <span class="dv">98</span>, <span class="dv">64</span>, <span class="dv">43</span>, <span class="dv">59</span>)</span>
<span id="cb172-2"><a href="neparametrické-testy.html#cb172-2" aria-hidden="true" tabindex="-1"></a>druhy <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">83</span>, <span class="dv">82</span>, <span class="dv">67</span>, <span class="dv">96</span>, <span class="dv">64</span>, <span class="dv">95</span>, <span class="dv">31</span>, <span class="dv">89</span>, <span class="dv">95</span>, <span class="dv">83</span>, <span class="dv">93</span>, <span class="dv">37</span>, <span class="dv">31</span>, <span class="dv">69</span>, <span class="dv">42</span>, <span class="dv">67</span>, <span class="dv">32</span>, <span class="dv">97</span>, <span class="dv">51</span>, <span class="dv">52</span>, <span class="dv">67</span>)</span></code></pre></div>
<p>Medián v prvním výběru standardní výuky je 67. Medián v druhém výběru experimentální výuky je 67.</p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="neparametrické-testy.html#cb173-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> druhy <span class="sc">-</span> prvni</span>
<span id="cb173-2"><a href="neparametrické-testy.html#cb173-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vyradime stejne vysledky, protoze to tvori komplikaci pri vypoctu rozdeleni testovaci statistiky</span></span>
<span id="cb173-3"><a href="neparametrické-testy.html#cb173-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> d[d<span class="sc">!=</span><span class="dv">0</span>]</span>
<span id="cb173-4"><a href="neparametrické-testy.html#cb173-4" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">rank</span>(<span class="fu">abs</span>(d))</span>
<span id="cb173-5"><a href="neparametrické-testy.html#cb173-5" aria-hidden="true" tabindex="-1"></a>W <span class="ot">&lt;-</span> <span class="fu">sum</span>(R <span class="sc">*</span> <span class="fu">sign</span>(d))</span>
<span id="cb173-6"><a href="neparametrické-testy.html#cb173-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(d)</span>
<span id="cb173-7"><a href="neparametrické-testy.html#cb173-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb173-8"><a href="neparametrické-testy.html#cb173-8" aria-hidden="true" tabindex="-1"></a>mu_W <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb173-9"><a href="neparametrické-testy.html#cb173-9" aria-hidden="true" tabindex="-1"></a>sigma_W <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="sc">*</span>(n<span class="sc">+</span><span class="dv">1</span>)<span class="sc">*</span>(<span class="dv">2</span><span class="sc">*</span>n<span class="sc">+</span><span class="dv">1</span>)) <span class="sc">/</span> <span class="dv">6</span>)</span>
<span id="cb173-10"><a href="neparametrické-testy.html#cb173-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> (W <span class="sc">-</span> mu_W) <span class="sc">/</span> sigma_W </span></code></pre></div>
<p>Nejdříve vypočítáme rozdíly mezi hodnotami z obou výběrů a poté vypočítáme pořadí těchto rozdílů <span class="math inline">\(R\)</span>. Poté pořadí přidáme znaménko podle toho, zda byl původní rozdíl záporný nebo kladný. Součet těchto hodnot nám dá testovací statistiku <span class="math inline">\(W\)</span>, která se tedy vypočítá jako <span class="math inline">\(W=\sum_{i=1}^{n}{sgn(x_i-y_i)R_i}\)</span>. V našem případě je <span class="math inline">\(W\)</span> rovno 103. Testovací statistika <span class="math inline">\(W\)</span> nabývá normálního rozdělení, které má za předpokladu <span class="math inline">\(H_0\)</span> průměr <span class="math inline">\(\mu_w=0\)</span><a href="#fn35" class="footnote-ref" id="fnref35"><sup>35</sup></a> a směrodatnou odchylku <span class="math inline">\(\sigma_W=\sqrt{\frac{n(n+1)(2n+1)}{6}}\)</span>. Hodnotu kvantilu testovací statistiky vypočítáme jako <span class="math inline">\(z=\frac{U-\mu_W}{\sigma_W}\)</span>. V našem případě je <span class="math inline">\(\mu_W\)</span> rovno 0 a směrodatná chyba odhadu <span class="math inline">\(W\)</span> je rovna 53.572.Graf <a href="neparametrické-testy.html#fig:h0-w">10.5</a> ukazuje rozdělení testovací statistiky <span class="math inline">\(W\)</span> za předpokladu <span class="math inline">\(H_0\)</span>.</p>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="neparametrické-testy.html#cb174-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">200</span>,<span class="dv">200</span>, <span class="at">length.out=</span><span class="dv">1000</span>)</span>
<span id="cb174-2"><a href="neparametrické-testy.html#cb174-2" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, mu_W, sigma_W)</span>
<span id="cb174-3"><a href="neparametrické-testy.html#cb174-3" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb174-4"><a href="neparametrické-testy.html#cb174-4" aria-hidden="true" tabindex="-1"></a>kriticka_mez <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">mean =</span> mu_W, sigma_W)</span>
<span id="cb174-5"><a href="neparametrické-testy.html#cb174-5" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">pnorm</span>(<span class="fu">abs</span>(z))) <span class="sc">*</span><span class="dv">2</span></span>
<span id="cb174-6"><a href="neparametrické-testy.html#cb174-6" aria-hidden="true" tabindex="-1"></a><span class="co"># p_hodnota &lt;- (1-pnorm(W, mu_W, sigma_W)) *2 # nebo take</span></span>
<span id="cb174-7"><a href="neparametrické-testy.html#cb174-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-8"><a href="neparametrické-testy.html#cb174-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf, </span>
<span id="cb174-9"><a href="neparametrické-testy.html#cb174-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, </span>
<span id="cb174-10"><a href="neparametrické-testy.html#cb174-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb174-11"><a href="neparametrické-testy.html#cb174-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb174-12"><a href="neparametrické-testy.html#cb174-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;U&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb174-13"><a href="neparametrické-testy.html#cb174-13" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> W, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb174-14"><a href="neparametrické-testy.html#cb174-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&lt;</span>kriticka_mez[<span class="dv">1</span>]], pdf[x<span class="sc">&lt;</span>kriticka_mez[<span class="dv">1</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb174-15"><a href="neparametrické-testy.html#cb174-15" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x<span class="sc">&gt;</span>kriticka_mez[<span class="dv">2</span>]], pdf[x<span class="sc">&gt;</span>kriticka_mez[<span class="dv">2</span>]], <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">lwd =</span> <span class="dv">1</span>)</span>
<span id="cb174-16"><a href="neparametrické-testy.html#cb174-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb174-17"><a href="neparametrické-testy.html#cb174-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb174-18"><a href="neparametrické-testy.html#cb174-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb174-19"><a href="neparametrické-testy.html#cb174-19" aria-hidden="true" tabindex="-1"></a>         <span class="fu">paste0</span>(</span>
<span id="cb174-20"><a href="neparametrické-testy.html#cb174-20" aria-hidden="true" tabindex="-1"></a>           <span class="st">&quot;N(&quot;</span>, mu_W, <span class="st">&quot;, &quot;</span>,</span>
<span id="cb174-21"><a href="neparametrické-testy.html#cb174-21" aria-hidden="true" tabindex="-1"></a>           <span class="fu">round</span>(sigma_W, <span class="dv">3</span>), <span class="st">&quot;)&quot;</span></span>
<span id="cb174-22"><a href="neparametrické-testy.html#cb174-22" aria-hidden="true" tabindex="-1"></a>         ),</span>
<span id="cb174-23"><a href="neparametrické-testy.html#cb174-23" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;Testovací statistika&quot;</span>),</span>
<span id="cb174-24"><a href="neparametrické-testy.html#cb174-24" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;black&quot;</span>),</span>
<span id="cb174-25"><a href="neparametrické-testy.html#cb174-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb174-26"><a href="neparametrické-testy.html#cb174-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),</span>
<span id="cb174-27"><a href="neparametrické-testy.html#cb174-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb174-28"><a href="neparametrické-testy.html#cb174-28" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:h0-w"></span>
<img src="book_files/figure-html/h0-w-1.png" alt="Výběrové rozdělení W za předpokladu H0" width="672" />
<p class="caption">
Graf 10.5: Výběrové rozdělení W za předpokladu H0
</p>
</div>
<p>Pravděpodobnost, že bychom za předpokladu <span class="math inline">\(H_0: \eta_1 = \eta_2\)</span> sledovali testovací statistiku takovou nebo extrémnější je 0.055, tedy těsně nad hranicí zvolené <span class="math inline">\(\alpha=0.05\)</span>. Nezamítáme tedy <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>.</p>

</div>
</div>








































<div class="footnotes">
<hr />
<ol start="35">
<li id="fn35"><p>Pokud není mezi prvním a druhým výběrem rozdíl, jsou rozdíly náhodně kladná a záporná čísla a jejich součet je roven 0.<a href="neparametrické-testy.html#fnref35" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="korelace.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
