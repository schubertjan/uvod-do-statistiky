<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 4 Centrální limitní věta | Úvod do statistiky</title>
  <meta name="description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 4 Centrální limitní věta | Úvod do statistiky" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 4 Centrální limitní věta | Úvod do statistiky" />
  
  <meta name="twitter:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

<meta name="author" content="Jan Schubert" />


<meta name="date" content="2022-02-22" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prob-dist.html"/>

<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Úvod do statistiky</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Úvod</a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#příklad-popisné-statistiky"><i class="fa fa-check"></i><b>1.1</b> Příklad popisné statistiky</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#příklad-inferenční-statistiky"><i class="fa fa-check"></i><b>1.2</b> Příklad inferenční statistiky</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#simulace"><i class="fa fa-check"></i><b>1.3</b> Simulace</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#o-modelech"><i class="fa fa-check"></i><b>1.4</b> O modelech</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="popisná-statistika.html"><a href="popisná-statistika.html"><i class="fa fa-check"></i><b>2</b> Popisná statistika</a>
<ul>
<li class="chapter" data-level="2.1" data-path="popisná-statistika.html"><a href="popisná-statistika.html#central-tend"><i class="fa fa-check"></i><b>2.1</b> Míry centrální tendence</a></li>
<li class="chapter" data-level="2.2" data-path="popisná-statistika.html"><a href="popisná-statistika.html#desc-vars"><i class="fa fa-check"></i><b>2.2</b> Míry rozptýlenosti</a></li>
<li class="chapter" data-level="2.3" data-path="popisná-statistika.html"><a href="popisná-statistika.html#cvičení"><i class="fa fa-check"></i><b>2.3</b> Cvičení</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prob-dist.html"><a href="prob-dist.html"><i class="fa fa-check"></i><b>3</b> Pravděpodobnostní rozložení</a>
<ul>
<li class="chapter" data-level="3.1" data-path="prob-dist.html"><a href="prob-dist.html#stats-lang"><i class="fa fa-check"></i><b>3.1</b> Pravděpodobnostní rozložení jako jazyk statistiky</a></li>
<li class="chapter" data-level="3.2" data-path="prob-dist.html"><a href="prob-dist.html#binom-dist"><i class="fa fa-check"></i><b>3.2</b> Binomické</a></li>
<li class="chapter" data-level="3.3" data-path="prob-dist.html"><a href="prob-dist.html#norm-dist"><i class="fa fa-check"></i><b>3.3</b> Normální</a></li>
<li class="chapter" data-level="3.4" data-path="prob-dist.html"><a href="prob-dist.html#t-dist"><i class="fa fa-check"></i><b>3.4</b> T</a></li>
<li class="chapter" data-level="3.5" data-path="prob-dist.html"><a href="prob-dist.html#uniformní"><i class="fa fa-check"></i><b>3.5</b> Uniformní</a></li>
<li class="chapter" data-level="3.6" data-path="prob-dist.html"><a href="prob-dist.html#poisson"><i class="fa fa-check"></i><b>3.6</b> Poisson</a></li>
<li class="chapter" data-level="3.7" data-path="prob-dist.html"><a href="prob-dist.html#chi-kvadrát"><i class="fa fa-check"></i><b>3.7</b> Chi-kvadrát</a></li>
<li class="chapter" data-level="3.8" data-path="prob-dist.html"><a href="prob-dist.html#jak-vybrat-správný-model-pro-data"><i class="fa fa-check"></i><b>3.8</b> Jak vybrat správný model pro data</a></li>
<li class="chapter" data-level="3.9" data-path="prob-dist.html"><a href="prob-dist.html#cvičení-1"><i class="fa fa-check"></i><b>3.9</b> Cvičení</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html"><i class="fa fa-check"></i><b>4</b> Centrální limitní věta</a>
<ul>
<li class="chapter" data-level="4.1" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#procenta"><i class="fa fa-check"></i><b>4.1</b> Procenta</a></li>
<li class="chapter" data-level="4.2" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#interval-spolehlivosti"><i class="fa fa-check"></i><b>4.2</b> Interval spolehlivosti</a></li>
<li class="chapter" data-level="4.3" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#bootstrap"><i class="fa fa-check"></i><b>4.3</b> Bootstrap</a></li>
<li class="chapter" data-level="4.4" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#průměr"><i class="fa fa-check"></i><b>4.4</b> Průměr</a></li>
<li class="chapter" data-level="4.5" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#simulace-1"><i class="fa fa-check"></i><b>4.5</b> simulace</a></li>
<li class="chapter" data-level="4.6" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#směrodatná-odchylka"><i class="fa fa-check"></i><b>4.6</b> Směrodatná odchylka</a></li>
<li class="chapter" data-level="4.7" data-path="centrální-limitní-věta.html"><a href="centrální-limitní-věta.html#cvičení-2"><i class="fa fa-check"></i><b>4.7</b> Cvičení</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Úvod do statistiky</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="centrální-limitní-věta" class="section level1" number="4">
<h1><span class="header-section-number">Kapitola 4</span> Centrální limitní věta</h1>
<p>Centrální limitní věta (CLV) je jednín z úžasných jevů matematiky. Během této kapitoly se dostaneme dále do základů statistiky a představíme si jeden z nejpoužívanějších principů statistiky, který nás bude provázat po zbytku semestru. Opět to bude náročnější kapitola a možná se k ní budete chtít vrátit zpět, jak budeme centrální limitní větu aplikovat na další statistické problémy. V této kapitole si představíme její princip. V kapitole o pravděpodobnostních rozloženích <a href="prob-dist.html#prob-dist">3</a> jsme si ukázali, že existují různé typy rozložení, které je možné použít k popsání (připodobnění) toho, jakých hodnot bude proměnná nabývat a v jaké četnosti. Často nás zajímají nejenom hodnoty náhodné proměnné, ale také některé její <strong>parametry</strong>, jako například průměr nebo procenta. Už víme, že hodnoty náhodné proměnné jsou ovlivněny náhodou, které může mít různé důvody. Je asi intuitivní, že i parametry této proměnné budou touto náhodou ovlivněny a že nebudou vždy stejné.</p>
<div id="procenta" class="section level2" number="4.1">
<h2><span class="header-section-number">4.1</span> Procenta</h2>
<p>Vraťme se zpět ke Galtonově boxu. My jsme tento proces simulovali jako <span class="math inline">\(x_i \sim B(10000, 0.5)\)</span>. Řekněme, že nás zajímá zjistit jaké procento míčků skončí v prostředním (sedmém) sloupci <span class="math inline">\(p\)</span>. Procento je nějaký parametr naší proměnné, který jsme zvolili, ale mohli bychom si zvolit například medián. Toto procento bude pokaždé když kuličky spustíme znova trochu jiné. Centrální limitní věta nám pomůže kvantifikovat, jak jiné toto procento bude.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="centrální-limitní-věta.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">4</span>)</span>
<span id="cb62-2"><a href="centrální-limitní-věta.html#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet micku</span></span>
<span id="cb62-3"><a href="centrální-limitní-věta.html#cb62-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb62-4"><a href="centrální-limitní-věta.html#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pravdepodobnost uspechu (napravo)</span></span>
<span id="cb62-5"><a href="centrální-limitní-věta.html#cb62-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb62-6"><a href="centrální-limitní-věta.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 by znamenalo všechny kulicky nalevo, 12 všechny kulicky napravo,</span></span>
<span id="cb62-7"><a href="centrální-limitní-věta.html#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="co"># celkem 13 možností, jak mohou kulicky skončit</span></span>
<span id="cb62-8"><a href="centrální-limitní-věta.html#cb62-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb62-9"><a href="centrální-limitní-věta.html#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="centrální-limitní-věta.html#cb62-10" aria-hidden="true" tabindex="-1"></a>vysledek <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb62-11"><a href="centrální-limitní-věta.html#cb62-11" aria-hidden="true" tabindex="-1"></a>cetnost <span class="ot">&lt;-</span> <span class="fu">table</span>(vysledek)</span>
<span id="cb62-12"><a href="centrální-limitní-věta.html#cb62-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-13"><a href="centrální-limitní-věta.html#cb62-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pouzijeme nazev 6 v tabulce, protoze 0 je prvni sloupec</span></span>
<span id="cb62-14"><a href="centrální-limitní-věta.html#cb62-14" aria-hidden="true" tabindex="-1"></a>p_7 <span class="ot">&lt;-</span> cetnost[<span class="fu">names</span>(cetnost) <span class="sc">==</span> <span class="st">&quot;6&quot;</span>] <span class="sc">/</span> n</span></code></pre></div>
<p>Například v simulaci, kterou jsme provedli v kodu nahoře je procento kuliček v sedmém sloupci <span class="math inline">\(p_7\)</span> rovné 0.2234. Když jsme simulovali hodnoty náhodné proměnné, tak každá kulička představovala jedno pozorování. V simulaci, kterou si teď předvedeme, vždy spustíme kuličky, spočítáme procento v sedmém sloupci, kuličky pustíme znova, opět spočítáme procento kuliček v sedmém sloupci a tak dále. Každé procento, které takto vypočítáme, představuje jednu hodnotu nějaké nové náhodné proměnné. Nakonec si ukážeme jak vypadá histogram těchto procent. Předtím, než se na animaci podíváte zkuste pomocí vašich znalostí pravděpodobnostních rozložení odhadnout, jaké bude mít rozložení průměrů tvar.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="centrální-limitní-věta.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># funkce na vypocet p_7</span></span>
<span id="cb63-2"><a href="centrální-limitní-věta.html#cb63-2" aria-hidden="true" tabindex="-1"></a>rel_cetnost <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb63-3"><a href="centrální-limitní-věta.html#cb63-3" aria-hidden="true" tabindex="-1"></a>  cetnost <span class="ot">&lt;-</span> <span class="fu">table</span>(x)</span>
<span id="cb63-4"><a href="centrální-limitní-věta.html#cb63-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cetnost[<span class="fu">names</span>(cetnost) <span class="sc">==</span> k] <span class="sc">/</span> <span class="fu">sum</span>(cetnost)</span>
<span id="cb63-5"><a href="centrální-limitní-věta.html#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb63-6"><a href="centrální-limitní-věta.html#cb63-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-7"><a href="centrální-limitní-věta.html#cb63-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-8"><a href="centrální-limitní-věta.html#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb63-9"><a href="centrální-limitní-věta.html#cb63-9" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">90</span></span>
<span id="cb63-10"><a href="centrální-limitní-věta.html#cb63-10" aria-hidden="true" tabindex="-1"></a>p_7 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(S))</span>
<span id="cb63-11"><a href="centrální-limitní-věta.html#cb63-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-12"><a href="centrální-limitní-věta.html#cb63-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> S) {</span>
<span id="cb63-13"><a href="centrální-limitní-věta.html#cb63-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spustime kulicky</span></span>
<span id="cb63-14"><a href="centrální-limitní-věta.html#cb63-14" aria-hidden="true" tabindex="-1"></a>  vysledek <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb63-15"><a href="centrální-limitní-věta.html#cb63-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocitame procento kulicek v kazdem sloupci</span></span>
<span id="cb63-16"><a href="centrální-limitní-věta.html#cb63-16" aria-hidden="true" tabindex="-1"></a>  p_7[i] <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(vysledek, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb63-17"><a href="centrální-limitní-věta.html#cb63-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-18"><a href="centrální-limitní-věta.html#cb63-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(p_7,</span>
<span id="cb63-19"><a href="centrální-limitní-věta.html#cb63-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">by =</span> <span class="fl">0.002</span>),</span>
<span id="cb63-20"><a href="centrální-limitní-věta.html#cb63-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>),</span>
<span id="cb63-21"><a href="centrální-limitní-věta.html#cb63-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Počet opakových spuštění kuliček: &quot;</span>, S[i]),</span>
<span id="cb63-22"><a href="centrální-limitní-věta.html#cb63-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb63-23"><a href="centrální-limitní-věta.html#cb63-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Procento&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb63-24"><a href="centrální-limitní-věta.html#cb63-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb63-25"><a href="centrální-limitní-věta.html#cb63-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-anim"></span>
<img src="book_files/figure-html/clv-anim-.gif" alt="Rozložení procenta kuliček v sedmém sloupci při opakovaném spuštění kuliček" width="672" />
<p class="caption">
Graf 4.1: Rozložení procenta kuliček v sedmém sloupci při opakovaném spuštění kuliček
</p>
</div>
<p>Jak je vidět z histogramu v <a href="centrální-limitní-věta.html#fig:clv-anim">4.1</a>, rozložení procent z opakovaných spuštění kuliček je zhruba normálně rozloženo s průměrem 0.22 a směrodatnou odchylkou 0, nebo jinak <span class="math inline">\(p \sim N(\)</span> 0.225 <span class="math inline">\(,\)</span> 0 <span class="math inline">\()\)</span>. To není žádné překvapení. Jak víme z <a href="prob-dist.html#norm-dist">3.3</a> spojité proměnné, které se shlukují okolo nějakého bodu a mohou nabývat hodnot na levo a na pravo od tohoto bodu bývají často normálně rozděleny. <strong>Centrální limitní věta</strong> nám popisuje tento fenomen a říká nám, jak vypočítat parametry tohoto normálního rozložení (tedy průměr a směrodatnou odchylku). V našem případě bychom parametry takového rozložení mohli vypočítat jako <span class="math display">\[p \sim N(p, \frac{\sigma_p}{\sqrt{n}})\]</span>kde <span class="math inline">\(n\)</span> je velikost výběru (10000 v našem případě), pričemž z <a href="prob-dist.html#binom-dist">3.2</a> víme, že rozptyl u procent vypočítáme jako <span class="math inline">\(\sigma^2 = p*(1-p)\)</span> a směrodatnou odchylku jako <span class="math inline">\(\sigma = \sqrt{p*(1-p)}\)</span>. Protože teoretická rozložení parametru využívá k aproximaci normální rozložení, platí pro PDF stejné překlady, jaké jsme si ukazovali v <a href="prob-dist.html#norm-dist">3.3</a>, tedy, že jednotlivé hodnoty jsou na sobě nezávislé. Graf <a href="centrální-limitní-věta.html#fig:clv-comp">4.2</a> ukazuje porovnání histogramu z 90 opakovaných puštění kuliček a jejich procent v sedmém sloupci s teoretickým rozložením tohoto parametru podle CLV<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="centrální-limitní-věta.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame p</span></span>
<span id="cb64-2"><a href="centrální-limitní-věta.html#cb64-2" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb64-3"><a href="centrální-limitní-věta.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame rozptyl dat</span></span>
<span id="cb64-4"><a href="centrální-limitní-věta.html#cb64-4" aria-hidden="true" tabindex="-1"></a>s_hat <span class="ot">&lt;-</span> p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat)</span>
<span id="cb64-5"><a href="centrální-limitní-věta.html#cb64-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-6"><a href="centrální-limitní-věta.html#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame pdf rozlozeni procent</span></span>
<span id="cb64-7"><a href="centrální-limitní-věta.html#cb64-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb64-8"><a href="centrální-limitní-věta.html#cb64-8" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> p_hat, <span class="at">sd =</span> <span class="fu">sqrt</span>(s_hat <span class="sc">/</span> n))</span>
<span id="cb64-9"><a href="centrální-limitní-věta.html#cb64-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-10"><a href="centrální-limitní-věta.html#cb64-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-11"><a href="centrální-limitní-věta.html#cb64-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_7,</span>
<span id="cb64-12"><a href="centrální-limitní-věta.html#cb64-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">by =</span> <span class="fl">0.002</span>),</span>
<span id="cb64-13"><a href="centrální-limitní-věta.html#cb64-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>),</span>
<span id="cb64-14"><a href="centrální-limitní-věta.html#cb64-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb64-15"><a href="centrální-limitní-věta.html#cb64-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb64-16"><a href="centrální-limitní-věta.html#cb64-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Procento&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb64-17"><a href="centrální-limitní-věta.html#cb64-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-18"><a href="centrální-limitní-věta.html#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame na druhou osu</span></span>
<span id="cb64-19"><a href="centrální-limitní-věta.html#cb64-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb64-20"><a href="centrální-limitní-věta.html#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb64-21"><a href="centrální-limitní-věta.html#cb64-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb64-22"><a href="centrální-limitní-věta.html#cb64-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb64-23"><a href="centrální-limitní-věta.html#cb64-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb64-24"><a href="centrální-limitní-věta.html#cb64-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb64-25"><a href="centrální-limitní-věta.html#cb64-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb64-26"><a href="centrální-limitní-věta.html#cb64-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-27"><a href="centrální-limitní-věta.html#cb64-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-28"><a href="centrální-limitní-věta.html#cb64-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb64-29"><a href="centrální-limitní-věta.html#cb64-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb64-30"><a href="centrální-limitní-věta.html#cb64-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;Rozložení procent&quot;</span>,</span>
<span id="cb64-31"><a href="centrální-limitní-věta.html#cb64-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;N(&quot;</span>, <span class="fu">round</span>(p_hat, <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(<span class="fu">sqrt</span>(s_hat <span class="sc">/</span> n), <span class="dv">3</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb64-32"><a href="centrální-limitní-věta.html#cb64-32" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb64-33"><a href="centrální-limitní-věta.html#cb64-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb64-34"><a href="centrální-limitní-věta.html#cb64-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;#1f77b4&quot;</span>),</span>
<span id="cb64-35"><a href="centrální-limitní-věta.html#cb64-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb64-36"><a href="centrální-limitní-věta.html#cb64-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-37"><a href="centrální-limitní-věta.html#cb64-37" aria-hidden="true" tabindex="-1"></a>thicks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(pdf), <span class="at">by =</span> <span class="dv">10</span>), <span class="dv">2</span>)</span>
<span id="cb64-38"><a href="centrální-limitní-věta.html#cb64-38" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">at =</span> thicks, <span class="at">labels =</span> thicks)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-comp"></span>
<img src="book_files/figure-html/clv-comp-1.png" alt="Porovnání rozložení 90 opakování procent kuliček v sedmém sloupci s teoretickým rozložením procent kuliček v sedmém sloupci podle CLV" width="672" />
<p class="caption">
Graf 4.2: Porovnání rozložení 90 opakování procent kuliček v sedmém sloupci s teoretickým rozložením procent kuliček v sedmém sloupci podle CLV
</p>
</div>
<p>Jak je zřejmé s parametrů rozložení, poloha tohoto rozložení určena průměrem a šířka rozložení bude ovlivněna <span class="math inline">\(\frac{\sigma_p}{\sqrt{n}}\)</span>, tedy mírou variability v datech a velikostí našeho výběru. Čím větší velikost výběru, tím menší je směrodatná odchylka rozložení parametru<a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>. Aby nedocházelo k záměně směrodatné odchylky rozložení parametru a směrodatné odchylky výběru, používá se pro směrodatnou odchylku rozložení parametru pojem <strong>směrodatná chyba</strong>.</p>
<p>Doposud jsme pro průměr rozložení parametru a směrodatnou odchylku používali populační parametry, tedy věděli jsme hodnotu <span class="math inline">\(p\)</span> v populaci a také rozptyl dat <span class="math inline">\(p*(1-p)\)</span>. To vychází z toho, že u Galtonova boxu víme, jaký náhodný proces data generuje. Většinou ale tento náhodný proces neznáme a nemáme tedy informace o populačním průměru a směrodatné odchylce. V takovém případě odhadneme obě hodnoty z dat (výběru). Je asi intuitivní, že pokud bude velikost našeho výběru <span class="math inline">\(n\)</span> malá, bude existovat větší nejistota o odhadu populačního průměru a směrodatné odchylky z dat. Abychom tuto dodatečnou nejistotu zachytili v teoretickém pravděpodobnostním rozložení parametru, použijeme k jeho aproximaci t-rozdělení s <span class="math inline">\(n-1\)</span> stupni volnosti, tedy <span class="math display">\[p \sim T(p, \frac{s_p}{\sqrt{n}}, n-1)\]</span><a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>Jak víme z <a href="prob-dist.html#t-dist">3.4</a>, t-rozložení dává větší pravděpodobnost hodnotám více vzdáleným od průměru.</p>
<p>Graf <a href="centrální-limitní-věta.html#fig:clv-t">4.3</a> ukazuje teoretické rozložení procenta kuliček v sedmém sloupci <span class="math inline">\(p_7\)</span> při <span class="math inline">\(n=20\)</span>, <span class="math inline">\(n=50\)</span> a <span class="math inline">\(n=100\)</span>. Tedy místo 10000, pustíme pouze 20, 50 a 100 kuliček. Abychom ukázali použití t-rozložení a odhadu průměru a směrodatné odchylky z výběru, budeme chvilku předstírat, že nevíme jejich teoretické hodnoty a proto <span class="math inline">\(p_7\)</span> a <span class="math inline">\(s_7\)</span> odhadneme z výběru Jak je vidět při puštění pouze 20 kuliček je náš odhad velmi nepřesný. Procento kuliček, které skončí v sedmém sloupci může klidně být od 0 do 0.4<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>. To dává smysl, představte si, jaká míra nejistoty existuje, pokud do Galtonova boxu nasypeme pouze 20 kuliček. S tím, jak se zvětšuje velikost výběru <span class="math inline">\(n\)</span>, klesá míra naší nejistoty o odhadu procenta kuliček v sedmém sloupci, klesá směrodatná chyba odhadu a tím pádem o šířka teoretického rozložení parametru.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="centrální-limitní-věta.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definujeme velikost vyberu</span></span>
<span id="cb65-2"><a href="centrální-limitní-věta.html#cb65-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb65-3"><a href="centrální-limitní-věta.html#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># definujeme hodnoty pro ktere budeme pocitat pdf</span></span>
<span id="cb65-4"><a href="centrální-limitní-věta.html#cb65-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.00</span>,<span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb65-5"><a href="centrální-limitní-věta.html#cb65-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-6"><a href="centrální-limitní-věta.html#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime prazdný graf, do ktereho budeme pridavat</span></span>
<span id="cb65-7"><a href="centrální-limitní-věta.html#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb65-8"><a href="centrální-limitní-věta.html#cb65-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb65-9"><a href="centrální-limitní-věta.html#cb65-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>),</span>
<span id="cb65-10"><a href="centrální-limitní-věta.html#cb65-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">7</span>),</span>
<span id="cb65-11"><a href="centrální-limitní-věta.html#cb65-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Procento&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb65-12"><a href="centrální-limitní-věta.html#cb65-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-13"><a href="centrální-limitní-věta.html#cb65-13" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">length</span>(N) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">&quot;Blues&quot;</span>)  )</span>
<span id="cb65-14"><a href="centrální-limitní-věta.html#cb65-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-15"><a href="centrální-limitní-věta.html#cb65-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N)) {</span>
<span id="cb65-16"><a href="centrální-limitní-věta.html#cb65-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provedeme vyber a odhadneme p a sd</span></span>
<span id="cb65-17"><a href="centrální-limitní-věta.html#cb65-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> N[i]</span>
<span id="cb65-18"><a href="centrální-limitní-věta.html#cb65-18" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb65-19"><a href="centrální-limitní-věta.html#cb65-19" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(vyber, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb65-20"><a href="centrální-limitní-věta.html#cb65-20" aria-hidden="true" tabindex="-1"></a>  s_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat))</span>
<span id="cb65-21"><a href="centrální-limitní-věta.html#cb65-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-22"><a href="centrální-limitní-věta.html#cb65-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocteme pdf pro T(p, s/sqrt(n), n-1) podle zobecneneho t-rozlozeni</span></span>
<span id="cb65-23"><a href="centrální-limitní-věta.html#cb65-23" aria-hidden="true" tabindex="-1"></a>  pdf_t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(s_hat <span class="sc">/</span> n) <span class="sc">*</span> <span class="fu">dt</span>((x <span class="sc">-</span> p_hat)<span class="sc">/</span><span class="fu">sqrt</span>(s_hat <span class="sc">/</span> n), <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb65-24"><a href="centrální-limitní-věta.html#cb65-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-25"><a href="centrální-limitní-věta.html#cb65-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pridame t-rozlozeni</span></span>
<span id="cb65-26"><a href="centrální-limitní-věta.html#cb65-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, pdf_t, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> cols[i])</span>
<span id="cb65-27"><a href="centrální-limitní-věta.html#cb65-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb65-28"><a href="centrální-limitní-věta.html#cb65-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-29"><a href="centrální-limitní-věta.html#cb65-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pridame legendu</span></span>
<span id="cb65-30"><a href="centrální-limitní-věta.html#cb65-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb65-31"><a href="centrální-limitní-věta.html#cb65-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;T(p, s/sqrt(n), &quot;</span>, N, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb65-32"><a href="centrální-limitní-věta.html#cb65-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N)],</span>
<span id="cb65-33"><a href="centrální-limitní-věta.html#cb65-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb65-34"><a href="centrální-limitní-věta.html#cb65-34" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-t"></span>
<img src="book_files/figure-html/clv-t-1.png" alt="Porovnání vlivu velikosti výběru n na směrodatnou chybu odhadu" width="960" />
<p class="caption">
Graf 4.3: Porovnání vlivu velikosti výběru n na směrodatnou chybu odhadu
</p>
</div>
</div>
<div id="interval-spolehlivosti" class="section level2" number="4.2">
<h2><span class="header-section-number">4.2</span> Interval spolehlivosti</h2>
</div>
<div id="bootstrap" class="section level2" number="4.3">
<h2><span class="header-section-number">4.3</span> Bootstrap</h2>
<p>Podíl kuliček 7 a 10 sloupce.</p>
</div>
<div id="průměr" class="section level2" number="4.4">
<h2><span class="header-section-number">4.4</span> Průměr</h2>
</div>
<div id="simulace-1" class="section level2" number="4.5">
<h2><span class="header-section-number">4.5</span> simulace</h2>
<p>Následující animace ukazuje princip centrálního limitní věty.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="centrální-limitní-věta.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb66-2"><a href="centrální-limitní-věta.html#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet vyberu</span></span>
<span id="cb66-3"><a href="centrální-limitní-věta.html#cb66-3" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">^</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>)</span>
<span id="cb66-4"><a href="centrální-limitní-věta.html#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ulozeni dat</span></span>
<span id="cb66-5"><a href="centrální-limitní-věta.html#cb66-5" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="dv">0</span>, <span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="cb66-6"><a href="centrální-limitní-věta.html#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(X) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;x&quot;</span>, <span class="st">&quot;frame&quot;</span>)</span>
<span id="cb66-7"><a href="centrální-limitní-věta.html#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="co"># vyber o velikosti n</span></span>
<span id="cb66-8"><a href="centrální-limitní-věta.html#cb66-8" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb66-9"><a href="centrální-limitní-věta.html#cb66-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-10"><a href="centrální-limitní-věta.html#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="co"># simulace</span></span>
<span id="cb66-11"><a href="centrální-limitní-věta.html#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(S)) {</span>
<span id="cb66-12"><a href="centrální-limitní-věta.html#cb66-12" aria-hidden="true" tabindex="-1"></a>  s <span class="ot">&lt;-</span> S[i]</span>
<span id="cb66-13"><a href="centrální-limitní-věta.html#cb66-13" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (n <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>s) {</span>
<span id="cb66-14"><a href="centrální-limitní-věta.html#cb66-14" aria-hidden="true" tabindex="-1"></a>    mu <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">runif</span>(N, <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>))</span>
<span id="cb66-15"><a href="centrální-limitní-věta.html#cb66-15" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">rbind</span>(X, <span class="fu">c</span>(mu, s))</span>
<span id="cb66-16"><a href="centrální-limitní-věta.html#cb66-16" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-17"><a href="centrální-limitní-věta.html#cb66-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-18"><a href="centrální-limitní-věta.html#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazeni dat</span></span>
<span id="cb66-19"><a href="centrální-limitní-věta.html#cb66-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (s <span class="cf">in</span> S) {</span>
<span id="cb66-20"><a href="centrální-limitní-věta.html#cb66-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(X[X[, <span class="dv">2</span>] <span class="sc">==</span> s, <span class="dv">1</span>],</span>
<span id="cb66-21"><a href="centrální-limitní-věta.html#cb66-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb66-22"><a href="centrální-limitní-věta.html#cb66-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Průměr U ~ (-10, 10)&quot;</span>, <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Počet výběrů: &quot;</span>, s),</span>
<span id="cb66-23"><a href="centrální-limitní-věta.html#cb66-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb66-24"><a href="centrální-limitní-věta.html#cb66-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="dv">10</span></span>
<span id="cb66-25"><a href="centrální-limitní-věta.html#cb66-25" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb66-26"><a href="centrální-limitní-věta.html#cb66-26" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-48"></span>
<img src="book_files/figure-html/unnamed-chunk-48-.gif" alt="Princip centrálního limitní věty" width="672" />
<p class="caption">
Graf 4.4: Princip centrálního limitní věty
</p>
</div>
</div>
<div id="směrodatná-odchylka" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Směrodatná odchylka</h2>
<p>Ukázat teoretické rozložení populační směrodatné odchylky. Simulovat predikce proměnné</p>
</div>
<div id="cvičení-2" class="section level2" number="4.7">
<h2><span class="header-section-number">4.7</span> Cvičení</h2>
<p>Spočtěte, v jakém intervalu se bude pohybovat průměrná doba čekání na tramvaj, když tramvaj pojede jednou za 8 minut. Spočtěte 90% interval spolehlivosti a okomentuje, co tento interval vyjadřuje.</p>
<p>Klíčové pojmy:</p>
<ul>
<li>Zákon velkých čísel</li>
<li>Centrální limitní věta</li>
<li>Inference</li>
<li>Bodový odhad</li>
<li>Interval spolehlivosti</li>
</ul>
<p>My jsme zákon velkých čísel používali intuitivně už v minulém semestru. Zákon velkých čísel říká, že průměr velkého počtu pozorování (výsledků pokusů) se bude limitně přibližovat očekávané hodnotě, neboli <span class="math inline">\(\overline{X_n} = \frac{1}{n}\sum_{i=1}^{n} X_i\)</span> <span class="math inline">\(\overline{X_n} \to \mu\)</span>, pokud <span class="math inline">\(n \to \infty\)</span>. Pojďme si to ukázat na příkladu hodu kostkou. Očekávaná hodnota hodu kostkou je <span class="math inline">\(E(X) = \frac{(a+b)}{2}\)</span>. Předpokládáme přitom, že hodnoty náhodné proměné <span class="math inline">\(X\)</span> jsou jsou nezávislé a stejně rozdělené (independent, identically distributed <span class="math inline">\(X_{iid}\)</span>).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="centrální-limitní-věta.html#cb67-1" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb67-2"><a href="centrální-limitní-věta.html#cb67-2" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb67-3"><a href="centrální-limitní-věta.html#cb67-3" aria-hidden="true" tabindex="-1"></a>ocekavana_hodnota <span class="ot">&lt;-</span> (a <span class="sc">+</span> b) <span class="sc">/</span> <span class="dv">2</span></span>
<span id="cb67-4"><a href="centrální-limitní-věta.html#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="centrální-limitní-věta.html#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 10 hodů</span></span>
<span id="cb67-6"><a href="centrální-limitní-věta.html#cb67-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb67-7"><a href="centrální-limitní-věta.html#cb67-7" aria-hidden="true" tabindex="-1"></a>kostka <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb67-8"><a href="centrální-limitní-věta.html#cb67-8" aria-hidden="true" tabindex="-1"></a>hody_n10 <span class="ot">&lt;-</span> <span class="fu">sample</span>(kostka, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-9"><a href="centrální-limitní-věta.html#cb67-9" aria-hidden="true" tabindex="-1"></a>prumer_n10 <span class="ot">&lt;-</span> <span class="fu">mean</span>(hody_n10)</span>
<span id="cb67-10"><a href="centrální-limitní-věta.html#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Průměr &quot;</span>, n, <span class="st">&quot; hodů je: &quot;</span>, prumer_n10))</span></code></pre></div>
<pre><code>## [1] &quot;Průměr 10 hodů je: 2.9&quot;</code></pre>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="centrální-limitní-věta.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nasimulujeme si velke mnozstvi hodu kostkou</span></span>
<span id="cb69-2"><a href="centrální-limitní-věta.html#cb69-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb69-3"><a href="centrální-limitní-věta.html#cb69-3" aria-hidden="true" tabindex="-1"></a>hody <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">rep</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="dv">6</span>, <span class="dv">6</span>), <span class="at">size =</span> n)</span>
<span id="cb69-4"><a href="centrální-limitní-věta.html#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime si vektor, do ktereho budeme ukladat prumery</span></span>
<span id="cb69-5"><a href="centrální-limitní-věta.html#cb69-5" aria-hidden="true" tabindex="-1"></a>prumer <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb69-6"><a href="centrální-limitní-věta.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame kumulativni prumer</span></span>
<span id="cb69-7"><a href="centrální-limitní-věta.html#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)) {</span>
<span id="cb69-8"><a href="centrální-limitní-věta.html#cb69-8" aria-hidden="true" tabindex="-1"></a>  prumer[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(hody[<span class="dv">1</span><span class="sc">:</span>i])</span>
<span id="cb69-9"><a href="centrální-limitní-věta.html#cb69-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-10"><a href="centrální-limitní-věta.html#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazime</span></span>
<span id="cb69-11"><a href="centrální-limitní-věta.html#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prumer,</span>
<span id="cb69-12"><a href="centrální-limitní-věta.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Pořadí hodů&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Průměr&quot;</span>,</span>
<span id="cb69-13"><a href="centrální-limitní-věta.html#cb69-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Průměrná hodnota hodu kostkou v závislosti na počtu hodů&quot;</span>,</span>
<span id="cb69-14"><a href="centrální-limitní-věta.html#cb69-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.main =</span> <span class="fl">0.9</span>, <span class="co"># mensi title, aby se vesel</span></span>
<span id="cb69-15"><a href="centrální-limitní-věta.html#cb69-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb69-16"><a href="centrální-limitní-věta.html#cb69-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb69-17"><a href="centrální-limitní-věta.html#cb69-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-18"><a href="centrální-limitní-věta.html#cb69-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10000</span>), <span class="fu">c</span>(ocekavana_hodnota, ocekavana_hodnota),</span>
<span id="cb69-19"><a href="centrální-limitní-věta.html#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb69-20"><a href="centrální-limitní-věta.html#cb69-20" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-21"><a href="centrální-limitní-věta.html#cb69-21" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb69-22"><a href="centrální-limitní-věta.html#cb69-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Očekávaná hodnota&quot;</span>),</span>
<span id="cb69-23"><a href="centrální-limitní-věta.html#cb69-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb69-24"><a href="centrální-limitní-věta.html#cb69-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb69-25"><a href="centrální-limitní-věta.html#cb69-25" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-49-1.png" width="672" /></p>
<p>Stejně tak platí, že průměr proměnné pocházejícího z binomického rozložení se bude blížit očekávané hodnotě rozložení, z kterého pochází. Jako příklad si ukážeme data o narozených dětech. Předpokládejme, že měsíc narození dětí je uniformně rozložen, tedy, že existuje stejná pravděpodobnost, že se děti rodí v lednu jako v červenci. Tedy pravděpodobnost toho, že se dítě narodí v nějaký měsíc je 1/12. Simulujme proces, v kterém se dítě buď narodí v dubnu (1) nebo nenarodí (0).</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="centrální-limitní-věta.html#cb70-1" aria-hidden="true" tabindex="-1"></a>ocekavana_hodnota <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">/</span> <span class="dv">12</span></span>
<span id="cb70-2"><a href="centrální-limitní-věta.html#cb70-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb70-3"><a href="centrální-limitní-věta.html#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="co"># nasimulujeme velke mnozstvi deti. 1 pokud se narodily v dubnu 0, pokud ne</span></span>
<span id="cb70-4"><a href="centrální-limitní-věta.html#cb70-4" aria-hidden="true" tabindex="-1"></a>deti <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> ocekavana_hodnota)</span>
<span id="cb70-5"><a href="centrální-limitní-věta.html#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="centrální-limitní-věta.html#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vektor kam budeme ukladat kumulativni prumer</span></span>
<span id="cb70-7"><a href="centrální-limitní-věta.html#cb70-7" aria-hidden="true" tabindex="-1"></a>prumer <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb70-8"><a href="centrální-limitní-věta.html#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>n)) {</span>
<span id="cb70-9"><a href="centrální-limitní-věta.html#cb70-9" aria-hidden="true" tabindex="-1"></a>  prumer[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(deti[<span class="dv">1</span><span class="sc">:</span>i])</span>
<span id="cb70-10"><a href="centrální-limitní-věta.html#cb70-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb70-11"><a href="centrální-limitní-věta.html#cb70-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-12"><a href="centrální-limitní-věta.html#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazeni</span></span>
<span id="cb70-13"><a href="centrální-limitní-věta.html#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(prumer,</span>
<span id="cb70-14"><a href="centrální-limitní-věta.html#cb70-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Pořadí dítěte&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Průměr&quot;</span>,</span>
<span id="cb70-15"><a href="centrální-limitní-věta.html#cb70-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Průměrná hodnota, že se dítě narodilo v dubnu&quot;</span>,</span>
<span id="cb70-16"><a href="centrální-limitní-věta.html#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex.main =</span> <span class="fl">0.9</span>, <span class="co"># mensi title, aby se vesel</span></span>
<span id="cb70-17"><a href="centrální-limitní-věta.html#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb70-18"><a href="centrální-limitní-věta.html#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb70-19"><a href="centrální-limitní-věta.html#cb70-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-20"><a href="centrální-limitní-věta.html#cb70-20" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">10000</span>), <span class="fu">c</span>(ocekavana_hodnota, ocekavana_hodnota),</span>
<span id="cb70-21"><a href="centrální-limitní-věta.html#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span></span>
<span id="cb70-22"><a href="centrální-limitní-věta.html#cb70-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-23"><a href="centrální-limitní-věta.html#cb70-23" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb70-24"><a href="centrální-limitní-věta.html#cb70-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Očekávaná hodnota&quot;</span>),</span>
<span id="cb70-25"><a href="centrální-limitní-věta.html#cb70-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lty =</span> <span class="dv">1</span>,</span>
<span id="cb70-26"><a href="centrální-limitní-věta.html#cb70-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb70-27"><a href="centrální-limitní-věta.html#cb70-27" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>Zákon velkých čísel má pro statistiku velké implikace. Pokud totiž máme dostatečně velké množství hodnot náhodné proměnné, bude se její průměr blížit průměru rozložení, z kterého pochází (za dodržení předpokladů, tedy <span class="math inline">\(X_{iid}\)</span>). Jak jsme ale viděli ze simulací nahoře, to jak se bude průměr proměnné blížit očekávané hodnoty rozložení, záleží na tom, kolik hodnot naše proměnná obsahuje. Průměr kardinální proměnné je také náhodná proměnná, která bude proměnnou spojitou. Označme ji třeba <span class="math inline">\(\overline{X}\)</span>. I tato náhodná proměnná bude mít svoje rozložení. Průměrem tohoto rozložení bude průměr proměnné <span class="math inline">\(\overline{X}\)</span> (označme ho třeba <span class="math inline">\(\mu\)</span>) a rozptyl bude <span class="math inline">\(\frac{\sigma^2}{n}\)</span>, kde <span class="math inline">\(\sigma^2\)</span> značí rozptyl původního rozložení a <span class="math inline">\(n\)</span> počet hodnot proměnné <span class="math inline">\(\overline{X}\)</span>. Tedy <span class="math inline">\(\overline{X} \sim N(\mu, \frac{\sigma}{\sqrt{n}})\)</span>. Ukažme si jak centrální limitní věta funguje na příkladu proměnné pohlaví. Ze sčítání lidu víme, že v ČR je zhruba 51% žen a 49% mužů. Při sčítání lidů se ptáme úplně všech občanů ČR, známe tedy hodnoty celého rozložení proměnné. Většinou se ale v sociologických šetřeních všech občanů ptát nemůžeme a používáme pouze výběr z této populace. My si teď tuto situaci nasimulujeme a ukážeme si, že průměry jednotlivých výběrů z této populace (z tohoto rozložení) budou mít normální rozložení <span class="math inline">\(\overline{X} \sim N(\mu, \frac{\sigma}{\sqrt{n}})\)</span>. <span class="math inline">\(\frac{\sigma}{\sqrt{n}}\)</span> se nazývá standardní chyba. Tedy, že pokud bychom měli jenom jeden průměr, mohli bychom centrální limitní větu použít k tomu, abychom odhadli rozložení průměru.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="centrální-limitní-věta.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># populacni hodnoty rozlozeni</span></span>
<span id="cb71-2"><a href="centrální-limitní-věta.html#cb71-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.51</span></span>
<span id="cb71-3"><a href="centrální-limitní-věta.html#cb71-3" aria-hidden="true" tabindex="-1"></a>rozptyl <span class="ot">&lt;-</span> p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p)</span>
<span id="cb71-4"><a href="centrální-limitní-věta.html#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="centrální-limitní-věta.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet vyberu</span></span>
<span id="cb71-6"><a href="centrální-limitní-věta.html#cb71-6" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb71-7"><a href="centrální-limitní-věta.html#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># velikost vyberu</span></span>
<span id="cb71-8"><a href="centrální-limitní-věta.html#cb71-8" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb71-9"><a href="centrální-limitní-věta.html#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime vektor, kam budeme ukladat nase prumery</span></span>
<span id="cb71-10"><a href="centrální-limitní-věta.html#cb71-10" aria-hidden="true" tabindex="-1"></a>prumery <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb71-11"><a href="centrální-limitní-věta.html#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k)) {</span>
<span id="cb71-12"><a href="centrální-limitní-věta.html#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># udelame nahodny vyber z populace</span></span>
<span id="cb71-13"><a href="centrální-limitní-věta.html#cb71-13" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.51</span>, <span class="fl">0.49</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-14"><a href="centrální-limitní-věta.html#cb71-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a ulozime prumer z vyberu</span></span>
<span id="cb71-15"><a href="centrální-limitní-věta.html#cb71-15" aria-hidden="true" tabindex="-1"></a>  prumery[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(vyber)</span>
<span id="cb71-16"><a href="centrální-limitní-věta.html#cb71-16" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-17"><a href="centrální-limitní-věta.html#cb71-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-18"><a href="centrální-limitní-věta.html#cb71-18" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame parametry, ktere potrebujeme na zobrazeni teoretickeho normalniho rozlozeni prumeru, podle centralni limitni vety</span></span>
<span id="cb71-19"><a href="centrální-limitní-věta.html#cb71-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(rozptyl)</span>
<span id="cb71-20"><a href="centrální-limitní-věta.html#cb71-20" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb71-21"><a href="centrální-limitní-věta.html#cb71-21" aria-hidden="true" tabindex="-1"></a>standardni_chyba <span class="ot">&lt;-</span> sigma <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb71-22"><a href="centrální-limitní-věta.html#cb71-22" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(prumery), <span class="at">sd =</span> standardni_chyba) <span class="co"># hustota pravdepodobnosti</span></span>
<span id="cb71-23"><a href="centrální-limitní-věta.html#cb71-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-24"><a href="centrální-limitní-věta.html#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazime histogram prumeru (nase simulace)</span></span>
<span id="cb71-25"><a href="centrální-limitní-věta.html#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prumery,</span>
<span id="cb71-26"><a href="centrální-limitní-věta.html#cb71-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Výběrový průměr (% žen)&quot;</span>,</span>
<span id="cb71-27"><a href="centrální-limitní-věta.html#cb71-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="co"># musime urcit, aby byly prekryvajici ve stejne pozici vuci ose x</span></span>
<span id="cb71-28"><a href="centrální-limitní-věta.html#cb71-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb71-29"><a href="centrální-limitní-věta.html#cb71-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;X~N(0.51,0.25/sqrt(100))&quot;</span></span>
<span id="cb71-30"><a href="centrální-limitní-věta.html#cb71-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-31"><a href="centrální-limitní-věta.html#cb71-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>) <span class="co"># na pridani nove osy</span></span>
<span id="cb71-32"><a href="centrální-limitní-věta.html#cb71-32" aria-hidden="true" tabindex="-1"></a><span class="co"># nyni prekryjeme teoretickou hustotou pravdepodobnosti podle centralni limitni vety</span></span>
<span id="cb71-33"><a href="centrální-limitní-věta.html#cb71-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb71-34"><a href="centrální-limitní-věta.html#cb71-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb71-35"><a href="centrální-limitní-věta.html#cb71-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="co"># nezobrazujeme osy, jinak by se prekryvaly</span></span>
<span id="cb71-36"><a href="centrální-limitní-věta.html#cb71-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>), <span class="co"># musime urcit, aby byly prekryvajici ve stejne pozici vuci ose x</span></span>
<span id="cb71-37"><a href="centrální-limitní-věta.html#cb71-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb71-38"><a href="centrální-limitní-věta.html#cb71-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-39"><a href="centrální-limitní-věta.html#cb71-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(p, p), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">8</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb71-40"><a href="centrální-limitní-věta.html#cb71-40" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>)</span>
<span id="cb71-41"><a href="centrální-limitní-věta.html#cb71-41" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;f(x)&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb71-42"><a href="centrální-limitní-věta.html#cb71-42" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame legendu</span></span>
<span id="cb71-43"><a href="centrální-limitní-věta.html#cb71-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb71-44"><a href="centrální-limitní-věta.html#cb71-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;PDF&quot;</span>, <span class="st">&quot;Populační průměr&quot;</span>),</span>
<span id="cb71-45"><a href="centrální-limitní-věta.html#cb71-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb71-46"><a href="centrální-limitní-věta.html#cb71-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.6</span></span>
<span id="cb71-47"><a href="centrální-limitní-věta.html#cb71-47" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>Pojďme si ukázat, že průměry budou mít normální rozdělení nezávisle na tom, z kterého rozložení pocházejí. Ve skutečnosti, většinou neznáme populační rozptyl <span class="math inline">\(\sigma\)</span> a tak ho nahrazujeme odhadem, který uděláme z našeho výběru. Tento odhad označujeme jako <span class="math inline">\(S^2\)</span> a vypočátáme ho jako <span class="math inline">\(S^2 = \frac{\sum_{i=1}^{n} (x_i - \overline{x})^2}{(n-1)}\)</span>.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="centrální-limitní-věta.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nejdrive si vytvorme nejake silene rozlozeni</span></span>
<span id="cb72-2"><a href="centrální-limitní-věta.html#cb72-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">12</span>, <span class="at">length.out =</span> <span class="dv">10000</span>)</span>
<span id="cb72-3"><a href="centrální-limitní-věta.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime rozlozeni, ktere ma 2 vrcholy</span></span>
<span id="cb72-4"><a href="centrální-limitní-věta.html#cb72-4" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">4</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">8</span>, <span class="at">sd =</span> <span class="dv">1</span>)</span>
<span id="cb72-5"><a href="centrální-limitní-věta.html#cb72-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-6"><a href="centrální-limitní-věta.html#cb72-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ted vygenerujeme nahodnou promennou z tohoto rozlozeni</span></span>
<span id="cb72-7"><a href="centrální-limitní-věta.html#cb72-7" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> pdf <span class="sc">/</span> <span class="fu">sum</span>(pdf) <span class="co"># pdf neni pravdepodonost, proto ji musime standardizovat, aby byla mezi 0 a 1</span></span>
<span id="cb72-8"><a href="centrální-limitní-věta.html#cb72-8" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> <span class="fl">1e6</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> p) <span class="co"># vybere hodnoty x s pravdepodobnostni, ktera se rovna jejich standardizovane hustote pravdepodobnosti</span></span>
<span id="cb72-9"><a href="centrální-limitní-věta.html#cb72-9" aria-hidden="true" tabindex="-1"></a>ocekavana_hodnota <span class="ot">&lt;-</span> <span class="fu">mean</span>(X)</span>
<span id="cb72-10"><a href="centrální-limitní-věta.html#cb72-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-11"><a href="centrální-limitní-věta.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazime si nasi promennou</span></span>
<span id="cb72-12"><a href="centrální-limitní-věta.html#cb72-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb72-13"><a href="centrální-limitní-věta.html#cb72-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;f(x)&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">main =</span> <span class="st">&quot;PDF strašidelné proměnné&quot;</span>,</span>
<span id="cb72-14"><a href="centrální-limitní-věta.html#cb72-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb72-15"><a href="centrální-limitní-věta.html#cb72-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="centrální-limitní-věta.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pojdme si opet ukazat,ze pokud bychom delali mnoho vyberu z tohoto rozlozeni, tak jejich prumery by byly normalne rozlozene a odpovidaly by rozlozeni popsanem v centralni limitni vete</span></span>
<span id="cb73-2"><a href="centrální-limitní-věta.html#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="centrální-limitní-věta.html#cb73-3" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet vyberu</span></span>
<span id="cb73-4"><a href="centrální-limitní-věta.html#cb73-4" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb73-5"><a href="centrální-limitní-věta.html#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># velikost vyberu</span></span>
<span id="cb73-6"><a href="centrální-limitní-věta.html#cb73-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb73-7"><a href="centrální-limitní-věta.html#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime vektor, kam budeme ukladat nase prumery</span></span>
<span id="cb73-8"><a href="centrální-limitní-věta.html#cb73-8" aria-hidden="true" tabindex="-1"></a>prumery <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb73-9"><a href="centrální-limitní-věta.html#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k)) {</span>
<span id="cb73-10"><a href="centrální-limitní-věta.html#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># udelame nahodny vyber z populace</span></span>
<span id="cb73-11"><a href="centrální-limitní-věta.html#cb73-11" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">prob =</span> p, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb73-12"><a href="centrální-limitní-věta.html#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># a ulozime prumer z vyberu</span></span>
<span id="cb73-13"><a href="centrální-limitní-věta.html#cb73-13" aria-hidden="true" tabindex="-1"></a>  prumery[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(vyber)</span>
<span id="cb73-14"><a href="centrální-limitní-věta.html#cb73-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb73-15"><a href="centrální-limitní-věta.html#cb73-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-16"><a href="centrální-limitní-věta.html#cb73-16" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame parametry, ktere potrebujeme na zobrazeni teoretickeho normalniho rozlozeni prumeru, podle centralni limitni vety</span></span>
<span id="cb73-17"><a href="centrální-limitní-věta.html#cb73-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-18"><a href="centrální-limitní-věta.html#cb73-18" aria-hidden="true" tabindex="-1"></a><span class="co"># odhadneme smerodatnou odchylku z vyberu (treba toho posledniho z nasi for loop)</span></span>
<span id="cb73-19"><a href="centrální-limitní-věta.html#cb73-19" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(vyber)</span>
<span id="cb73-20"><a href="centrální-limitní-věta.html#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co"># standardni chyba</span></span>
<span id="cb73-21"><a href="centrální-limitní-věta.html#cb73-21" aria-hidden="true" tabindex="-1"></a>standardni_chyba <span class="ot">&lt;-</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb73-22"><a href="centrální-limitní-věta.html#cb73-22" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="fu">mean</span>(prumery), <span class="at">sd =</span> standardni_chyba)</span>
<span id="cb73-23"><a href="centrální-limitní-věta.html#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="centrální-limitní-věta.html#cb73-24" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazime histogram prumeru (nase simulace)</span></span>
<span id="cb73-25"><a href="centrální-limitní-věta.html#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prumery,</span>
<span id="cb73-26"><a href="centrální-limitní-věta.html#cb73-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;Výběrové průměry&quot;</span>,</span>
<span id="cb73-27"><a href="centrální-limitní-věta.html#cb73-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>), <span class="co"># musime urcit, aby byly prekryvajici ve stejne pozici vuci ose x</span></span>
<span id="cb73-28"><a href="centrální-limitní-věta.html#cb73-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb73-29"><a href="centrální-limitní-věta.html#cb73-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;Histogram průměrů ze strašidelné proměnné&quot;</span></span>
<span id="cb73-30"><a href="centrální-limitní-věta.html#cb73-30" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-31"><a href="centrální-limitní-věta.html#cb73-31" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>) <span class="co"># na pridani nove osy</span></span>
<span id="cb73-32"><a href="centrální-limitní-věta.html#cb73-32" aria-hidden="true" tabindex="-1"></a><span class="co"># nyni prekryjeme teoretickou hustotou pravdepodobnosti podle centralni limitni vety</span></span>
<span id="cb73-33"><a href="centrální-limitní-věta.html#cb73-33" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb73-34"><a href="centrální-limitní-věta.html#cb73-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb73-35"><a href="centrální-limitní-věta.html#cb73-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="cn">FALSE</span>, <span class="at">bty =</span> <span class="st">&quot;n&quot;</span>, <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>, <span class="co"># nezobrazujeme osy, jinak by se prekryvaly</span></span>
<span id="cb73-36"><a href="centrální-limitní-věta.html#cb73-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">5</span>, <span class="dv">7</span>), <span class="co"># musime urcit, aby byly prekryvajici ve stejne pozici vuci ose x</span></span>
<span id="cb73-37"><a href="centrální-limitní-věta.html#cb73-37" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb73-38"><a href="centrální-limitní-věta.html#cb73-38" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-39"><a href="centrální-limitní-věta.html#cb73-39" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(ocekavana_hodnota, ocekavana_hodnota), <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb73-40"><a href="centrální-limitní-věta.html#cb73-40" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">4</span>)</span>
<span id="cb73-41"><a href="centrální-limitní-věta.html#cb73-41" aria-hidden="true" tabindex="-1"></a><span class="fu">mtext</span>(<span class="st">&quot;f(x)&quot;</span>, <span class="at">side =</span> <span class="dv">4</span>, <span class="at">line =</span> <span class="dv">3</span>)</span>
<span id="cb73-42"><a href="centrální-limitní-věta.html#cb73-42" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame legendu</span></span>
<span id="cb73-43"><a href="centrální-limitní-věta.html#cb73-43" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topleft&quot;</span>,</span>
<span id="cb73-44"><a href="centrální-limitní-věta.html#cb73-44" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;PDF&quot;</span>, <span class="st">&quot;Populační průměr&quot;</span>),</span>
<span id="cb73-45"><a href="centrální-limitní-věta.html#cb73-45" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>),</span>
<span id="cb73-46"><a href="centrální-limitní-věta.html#cb73-46" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.6</span></span>
<span id="cb73-47"><a href="centrální-limitní-věta.html#cb73-47" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-52-2.png" width="672" /></p>
<p>To, co jsme si právě ukázali má ohromné důsledky pro schopnost statistiky podávát informace o původním rozložení, i když máme pouze jeho část. Protože dokážeme odhadnout, v jakém rozmezí se zhruba bude výběrový průměr pohybovat, můžeme tak udělat odhad o tom, kde se bude nacházet průměr celé populace. Takovému procesu se říká statistická inference a budeme ji využívat v celém zbytku semestru k tomu, abychom usoudili něco o populačním parametru. Můžeme mít buď bodový odhad, kde odhadujeme jednu populační statisitku, nebo intervalový odhad, kde odhadujeme interval, kterém se populační statistika nachází. Ve zbytku cvičení se zaměříme na jednu implikaci, interval spolehlivosti. Interval spolehlivosti vyjadřuje interval možných hodnot parametru, který můžeme z výběrových dat očekávat. Tento interval má hladinu spolehlivosti, která určuje šířku intervalu. Interval spolehlivosti znáte například z předvolebních průzkumů, kdy je vedle % podpory strany uvedeno např. +/- 3%. Interval spolehlivosti se vypočítá jako <span class="math inline">\(IS_{1-\alpha} = \overline{x} +/- z \frac{s}{\sqrt{n}}\)</span>, kde <span class="math inline">\(z\)</span> je z skor, tedy hodnota, která pochází ze standardizovaného rozložení s průměrem 0 a směrodatnou odchylkou 1. Pojďme se vrátit k příkladu proměnné pohlaví, kde známe populační průměr a ukážme si, jak interval spolehlivosti vypočítat.</p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="centrální-limitní-věta.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nyni si nasimulujeme situaci, kdy mame pouze jeden vyber o velikosti 100 (jako v realnem vyzkumu)</span></span>
<span id="cb74-2"><a href="centrální-limitní-věta.html#cb74-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb74-3"><a href="centrální-limitní-věta.html#cb74-3" aria-hidden="true" tabindex="-1"></a>vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.51</span>, <span class="fl">0.49</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb74-4"><a href="centrální-limitní-věta.html#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="centrální-limitní-věta.html#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="co"># urcime hladinu spolehlivosti (1-alpha)</span></span>
<span id="cb74-6"><a href="centrální-limitní-věta.html#cb74-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb74-7"><a href="centrální-limitní-věta.html#cb74-7" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame vyberovy prumer</span></span>
<span id="cb74-8"><a href="centrální-limitní-věta.html#cb74-8" aria-hidden="true" tabindex="-1"></a>vyberovy_prumer <span class="ot">&lt;-</span> <span class="fu">mean</span>(vyber)</span>
<span id="cb74-9"><a href="centrální-limitní-věta.html#cb74-9" aria-hidden="true" tabindex="-1"></a><span class="co"># smerodatnou odchylku odhadneme z vyberu</span></span>
<span id="cb74-10"><a href="centrální-limitní-věta.html#cb74-10" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fu">sd</span>(vyber)</span>
<span id="cb74-11"><a href="centrální-limitní-věta.html#cb74-11" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame standardni chybu (tedy smerodatnou odchylku rozlozeni prumeru)</span></span>
<span id="cb74-12"><a href="centrální-limitní-věta.html#cb74-12" aria-hidden="true" tabindex="-1"></a>standardni_chyba <span class="ot">&lt;-</span> s <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb74-13"><a href="centrální-limitní-věta.html#cb74-13" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame z (vzdalenost od prumeru). Alpha /2 protoze chceme mit stejne procento rozlozeni na leve a prave strane rozlozeni</span></span>
<span id="cb74-14"><a href="centrální-limitní-věta.html#cb74-14" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb74-15"><a href="centrální-limitní-věta.html#cb74-15" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame interval spolehlivosti</span></span>
<span id="cb74-16"><a href="centrální-limitní-věta.html#cb74-16" aria-hidden="true" tabindex="-1"></a>IS_89 <span class="ot">&lt;-</span> <span class="fu">c</span>(vyberovy_prumer <span class="sc">-</span> z <span class="sc">*</span> standardni_chyba, vyberovy_prumer <span class="sc">+</span> z <span class="sc">*</span> standardni_chyba)</span>
<span id="cb74-17"><a href="centrální-limitní-věta.html#cb74-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-18"><a href="centrální-limitní-věta.html#cb74-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Interval spolehlivosti na konfidenční hladině &quot;</span>, <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="st">&quot; je: &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Interval spolehlivosti na konfidenční hladině 0.89 je: &quot;</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="centrální-limitní-věta.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(IS_89)</span></code></pre></div>
<pre><code>## [1] 0.3898325 0.5501675</code></pre>
<p>Pojďme si udělat funkci, která interval spolehlivosti vypočítá.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="centrální-limitní-věta.html#cb78-1" aria-hidden="true" tabindex="-1"></a>interval_spolehlivosti <span class="ot">&lt;-</span> <span class="cf">function</span>(x, alpha) {</span>
<span id="cb78-2"><a href="centrální-limitní-věta.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb78-3"><a href="centrální-limitní-věta.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  vyberovy_prumer <span class="ot">&lt;-</span> <span class="fu">mean</span>(x)</span>
<span id="cb78-4"><a href="centrální-limitní-věta.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  standardni_chyba <span class="ot">&lt;-</span> <span class="fu">sd</span>(x) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb78-5"><a href="centrální-limitní-věta.html#cb78-5" aria-hidden="true" tabindex="-1"></a>  z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="at">p =</span> <span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>)</span>
<span id="cb78-6"><a href="centrální-limitní-věta.html#cb78-6" aria-hidden="true" tabindex="-1"></a>  IS <span class="ot">&lt;-</span> <span class="fu">c</span>(vyberovy_prumer <span class="sc">-</span> z <span class="sc">*</span> standardni_chyba, vyberovy_prumer <span class="sc">+</span> z <span class="sc">*</span> standardni_chyba)</span>
<span id="cb78-7"><a href="centrální-limitní-věta.html#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(IS)</span>
<span id="cb78-8"><a href="centrální-limitní-věta.html#cb78-8" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>V praxi tato hodnota znamena, že pokud bychom dělali výběry dokola a dokola, tak by další intervaly spolehlivosti obsahovaly skutečnou hodnotu v <span class="math inline">\(1-\alpha\)</span> případů. Pojďme si teď tuto situaci ukázat. Budeme simulovat 100 výběrů, z každého výběru spočítáme interval spolehlivosti a zobrazíme ho šedě, pokud nepokrývá populační hodnotu a modře pokud ji pokrývá. Protože naše hladina spolehlivosti je 89%, očekáváme, že ze 100 intervalů spolehlivosti, jich asi 89 pokryje populační hodnotu a asi 11 ji nepokryje.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="centrální-limitní-věta.html#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb79-2"><a href="centrální-limitní-věta.html#cb79-2" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb79-3"><a href="centrální-limitní-věta.html#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="co"># velikost vyberu</span></span>
<span id="cb79-4"><a href="centrální-limitní-věta.html#cb79-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb79-5"><a href="centrální-limitní-věta.html#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="co"># urcime hladinu spolehlivosti</span></span>
<span id="cb79-6"><a href="centrální-limitní-věta.html#cb79-6" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb79-7"><a href="centrální-limitní-věta.html#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="co"># populacni hodnota (tu sem davame, abychom se presvedcili, ze co jsme rekli nahore je pravda)</span></span>
<span id="cb79-8"><a href="centrální-limitní-věta.html#cb79-8" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.51</span></span>
<span id="cb79-9"><a href="centrální-limitní-věta.html#cb79-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-10"><a href="centrální-limitní-věta.html#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="co"># pripravime si prazdny graf</span></span>
<span id="cb79-11"><a href="centrální-limitní-věta.html#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k), <span class="fu">seq</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>, <span class="at">length.out =</span> k),</span>
<span id="cb79-12"><a href="centrální-limitní-věta.html#cb79-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;n&quot;</span>, <span class="co"># nechceme nic zobrazit</span></span>
<span id="cb79-13"><a href="centrální-limitní-věta.html#cb79-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Výběry z populace&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;% žen&quot;</span>,</span>
<span id="cb79-14"><a href="centrální-limitní-věta.html#cb79-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;IS (konfidenční hladina=&quot;</span>, <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="st">&quot; ) pro opakované výběry&quot;</span>), <span class="at">cex.main =</span> <span class="fl">0.9</span>,</span>
<span id="cb79-15"><a href="centrální-limitní-věta.html#cb79-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb79-16"><a href="centrální-limitní-věta.html#cb79-16" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb79-17"><a href="centrální-limitní-věta.html#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="centrální-limitní-věta.html#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="co"># nyní provedeme simulaci</span></span>
<span id="cb79-19"><a href="centrální-limitní-věta.html#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k)) {</span>
<span id="cb79-20"><a href="centrální-limitní-věta.html#cb79-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># udelame si vyber</span></span>
<span id="cb79-21"><a href="centrální-limitní-věta.html#cb79-21" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.51</span>, <span class="fl">0.49</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb79-22"><a href="centrální-limitní-věta.html#cb79-22" aria-hidden="true" tabindex="-1"></a>  is_ <span class="ot">&lt;-</span> <span class="fu">interval_spolehlivosti</span>(<span class="at">x =</span> vyber, <span class="at">alpha =</span> alpha)</span>
<span id="cb79-23"><a href="centrální-limitní-věta.html#cb79-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zobrazime na grafu</span></span>
<span id="cb79-24"><a href="centrální-limitní-věta.html#cb79-24" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> ((is_[<span class="dv">1</span>] <span class="sc">&gt;=</span> p) <span class="sc">|</span> ((is_[<span class="dv">2</span>] <span class="sc">&lt;=</span> p))) { <span class="co"># pokud je nas interval spolehlivosti mimo populacni hodnotu udelaj sede</span></span>
<span id="cb79-25"><a href="centrální-limitní-věta.html#cb79-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(i, <span class="fu">mean</span>(vyber),</span>
<span id="cb79-26"><a href="centrální-limitní-věta.html#cb79-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span></span>
<span id="cb79-27"><a href="centrální-limitní-věta.html#cb79-27" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-28"><a href="centrální-limitní-věta.html#cb79-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">c</span>(i, i), is_, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb79-29"><a href="centrální-limitní-věta.html#cb79-29" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> { <span class="co"># pokud je p uvnitr intervalu spolehlivosti pak zobraz modre</span></span>
<span id="cb79-30"><a href="centrální-limitní-věta.html#cb79-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">points</span>(i, <span class="fu">mean</span>(vyber),</span>
<span id="cb79-31"><a href="centrální-limitní-věta.html#cb79-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">pch =</span> <span class="dv">20</span></span>
<span id="cb79-32"><a href="centrální-limitní-věta.html#cb79-32" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb79-33"><a href="centrální-limitní-věta.html#cb79-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">lines</span>(<span class="fu">c</span>(i, i), is_, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>)</span>
<span id="cb79-34"><a href="centrální-limitní-věta.html#cb79-34" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb79-35"><a href="centrální-limitní-věta.html#cb79-35" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb79-36"><a href="centrální-limitní-věta.html#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame populacni prumer</span></span>
<span id="cb79-37"><a href="centrální-limitní-věta.html#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="fu">c</span>(<span class="dv">1</span>, n), <span class="fu">c</span>(p, p), <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb79-38"><a href="centrální-limitní-věta.html#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame legendu</span></span>
<span id="cb79-39"><a href="centrální-limitní-věta.html#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;bottomleft&quot;</span>,</span>
<span id="cb79-40"><a href="centrální-limitní-věta.html#cb79-40" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;Populační průměr&quot;</span>),</span>
<span id="cb79-41"><a href="centrální-limitní-věta.html#cb79-41" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;red&quot;</span>), <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb79-42"><a href="centrální-limitní-věta.html#cb79-42" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.6</span></span>
<span id="cb79-43"><a href="centrální-limitní-věta.html#cb79-43" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
<p>Zkuste si nyni hrat s konfidenční hladinou intervalu spolehlivosti a s velikostí výběru (<span class="math inline">\(n\)</span>).</p>
<p><strong>Následující text je dobrovolný</strong></p>
<p>Interval spolehlivosti pro průměr, které jsme si ukázali nahoře má analytické řešení (dá se vypočítat). Ne všechny statistiky mají interval spolehlivosti, který se dá vypočítat analyticky. V takovém případě je možné použít techniku, která se nazývá bootstrapping. Principlem této techniky je simulování více výběrů a vytvoření rozložení statistiky empiricky (tedy z dat). Bootstrapping provádí náhodné výběry s opakováním o velikosti <span class="math inline">\(n\)</span> z naší výběrové proměnné, která má velikost <span class="math inline">\(n\)</span>. Pojďme si ukázat bootstrapping na příkladu naší proměnné. Použijeme proměnnou <code>vyber</code> z naší simulace nahoře. Provedeme 10000 výběrů s opakováním z této proměnné <code>vyber</code> a u každého výběru vypočítáme průměr (protože to je statistika, která nás teď zajímá, pokud byste chtěli interval spolehlivosti pro jinou statistiku, místo průměru byste vypočítali jinou statistiku). Nakonec z tohoto empirické rozložení vypočítáme kvantily, které odpovídají zvolené konfidenční hladině a porovnáme k intervalu spolehlivosti, který jsme vypočítali pomocí analytického vzorce nahoře. Při boostrappingu mame tedy také pouze jeden výběr z populace, jako u analytického výpočtu intervalu spolehlivosti, ale výsledné rozložení statistiky (např. průměru) odhadneme empiricky.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="centrální-limitní-věta.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># mame pouze jeden vyber o velikosti 100 (jako v realnem vyzkumu)</span></span>
<span id="cb80-2"><a href="centrální-limitní-věta.html#cb80-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb80-3"><a href="centrální-limitní-věta.html#cb80-3" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.51</span></span>
<span id="cb80-4"><a href="centrální-limitní-věta.html#cb80-4" aria-hidden="true" tabindex="-1"></a>vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>), <span class="at">size =</span> n, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.51</span>, <span class="fl">0.49</span>), <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb80-5"><a href="centrální-limitní-věta.html#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="centrální-limitní-věta.html#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet vyberu s opakovanim z nasi promenne</span></span>
<span id="cb80-7"><a href="centrální-limitní-věta.html#cb80-7" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb80-8"><a href="centrální-limitní-věta.html#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime si vektor, kam ulozime prumery</span></span>
<span id="cb80-9"><a href="centrální-limitní-věta.html#cb80-9" aria-hidden="true" tabindex="-1"></a>prumery_b <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, k)</span>
<span id="cb80-10"><a href="centrální-limitní-věta.html#cb80-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-11"><a href="centrální-limitní-věta.html#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="co"># udelame bootstrapping</span></span>
<span id="cb80-12"><a href="centrální-limitní-věta.html#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>k)) {</span>
<span id="cb80-13"><a href="centrální-limitní-věta.html#cb80-13" aria-hidden="true" tabindex="-1"></a>  prumery_b[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">sample</span>(vyber, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>))</span>
<span id="cb80-14"><a href="centrální-limitní-věta.html#cb80-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb80-15"><a href="centrální-limitní-věta.html#cb80-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-16"><a href="centrální-limitní-věta.html#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="co"># urcime hladinu spolehlivosti (1-alpha)</span></span>
<span id="cb80-17"><a href="centrální-limitní-věta.html#cb80-17" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb80-18"><a href="centrální-limitní-věta.html#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame kvantily</span></span>
<span id="cb80-19"><a href="centrální-limitní-věta.html#cb80-19" aria-hidden="true" tabindex="-1"></a>boostrap_is_89 <span class="ot">&lt;-</span> <span class="fu">quantile</span>(prumery_b,</span>
<span id="cb80-20"><a href="centrální-limitní-věta.html#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">probs =</span> <span class="fu">c</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>) <span class="co"># kvantil 0.055 a 0.945</span></span>
<span id="cb80-21"><a href="centrální-limitní-věta.html#cb80-21" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb80-22"><a href="centrální-limitní-věta.html#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="st">&quot; a &quot;</span>, <span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="st">&quot; kvantily empirického boostrapovanáho rozložení průměru je: &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;0.055 a 0.945 kvantily empirického boostrapovanáho rozložení průměru je: &quot;</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="centrální-limitní-věta.html#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(boostrap_is_89)</span></code></pre></div>
<pre><code>##  5.5% 94.5% 
##  0.40  0.56</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="centrální-limitní-věta.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;Interval spolehlivosti (vypočítaný analyticky) na konfidenční hladině &quot;</span>, <span class="dv">1</span> <span class="sc">-</span> alpha, <span class="st">&quot; je: &quot;</span>))</span></code></pre></div>
<pre><code>## [1] &quot;Interval spolehlivosti (vypočítaný analyticky) na konfidenční hladině 0.89 je: &quot;</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="centrální-limitní-věta.html#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">interval_spolehlivosti</span>(vyber, alpha))</span></code></pre></div>
<pre><code>## [1] 0.399752 0.560248</code></pre>

</div>
</div>
















<div class="footnotes">
<hr />
<ol start="8">
<li id="fn8"><p><span class="math inline">\(p_7 \sim N(0.19, \sqrt {\frac{0.19*0.81}{n}})\)</span><a href="centrální-limitní-věta.html#fnref8" class="footnote-back">↩︎</a></p></li>
<li id="fn9"><p>Tento vztah není lineární, tedy 2x větší výběr neznamená 2x menší směrodatnou odchylku rozložení parametru, směrodatná odchylka rozložení klesá <span class="math inline">\(\frac{1}{\sqrt{n}}\)</span><a href="centrální-limitní-věta.html#fnref9" class="footnote-back">↩︎</a></p></li>
<li id="fn10"><p>Směrodatná odchylka odhadnutá z dat se označuje <span class="math inline">\(s\)</span><a href="centrální-limitní-věta.html#fnref10" class="footnote-back">↩︎</a></p></li>
<li id="fn11"><p>Velikost tohoto výběru je dokonce tak malá, že aproximace t-rozdělením nemusí být přesná<a href="centrální-limitní-věta.html#fnref11" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prob-dist.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
