<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 4 Výběrové rozdělení parametrů | Úvod do statistiky</title>
  <meta name="description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 4 Výběrové rozdělení parametrů | Úvod do statistiky" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 4 Výběrové rozdělení parametrů | Úvod do statistiky" />
  
  <meta name="twitter:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

<meta name="author" content="Jan Schubert" />


<meta name="date" content="2022-04-09" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prob-dist.html"/>
<link rel="next" href="stats-test-single.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Úvod do statistiky</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Úvod<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#příklad-popisné-statistiky"><i class="fa fa-check"></i><b>1.1</b> Příklad popisné statistiky<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#příklad-inferenční-statistiky"><i class="fa fa-check"></i><b>1.2</b> Příklad inferenční statistiky<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#simulace"><i class="fa fa-check"></i><b>1.3</b> Simulace<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#o-modelech"><i class="fa fa-check"></i><b>1.4</b> O modelech<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="desc-stats.html"><a href="desc-stats.html"><i class="fa fa-check"></i><b>2</b> Popisná statistika<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="desc-stats.html"><a href="desc-stats.html#central-tend"><i class="fa fa-check"></i><b>2.1</b> Míry centrální tendence<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="desc-stats.html"><a href="desc-stats.html#desc-vars"><i class="fa fa-check"></i><b>2.2</b> Míry rozptýlenosti<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="desc-stats.html"><a href="desc-stats.html#kvantily"><i class="fa fa-check"></i><b>2.3</b> Míry polohy<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prob-dist.html"><a href="prob-dist.html"><i class="fa fa-check"></i><b>3</b> Pravděpodobnostní rozdělení<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="prob-dist.html"><a href="prob-dist.html#stats-lang"><i class="fa fa-check"></i><b>3.1</b> Pravděpodobnostní rozdělení jako jazyk statistiky<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="prob-dist.html"><a href="prob-dist.html#binom-dist"><i class="fa fa-check"></i><b>3.2</b> Binomické<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="prob-dist.html"><a href="prob-dist.html#norm-dist"><i class="fa fa-check"></i><b>3.3</b> Normální<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="prob-dist.html"><a href="prob-dist.html#t-dist"><i class="fa fa-check"></i><b>3.4</b> T<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="prob-dist.html"><a href="prob-dist.html#unif-dist"><i class="fa fa-check"></i><b>3.5</b> Uniformní<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="prob-dist.html"><a href="prob-dist.html#pois-dist"><i class="fa fa-check"></i><b>3.6</b> Poisson<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="prob-dist.html"><a href="prob-dist.html#chi-kvadrát"><i class="fa fa-check"></i><b>3.7</b> Chi-kvadrát<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="prob-dist.html"><a href="prob-dist.html#jak-vybrat-správný-model-pro-data"><i class="fa fa-check"></i><b>3.8</b> Jak vybrat správný model pro data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dist-params.html"><a href="dist-params.html"><i class="fa fa-check"></i><b>4</b> Výběrové rozdělení parametrů<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="dist-params.html"><a href="dist-params.html#clv-procento"><i class="fa fa-check"></i><b>4.1</b> Relativní četnost<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="dist-params.html"><a href="dist-params.html#clv-is"><i class="fa fa-check"></i><b>4.2</b> Interval spolehlivosti<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="dist-params.html"><a href="dist-params.html#bootstrap"><i class="fa fa-check"></i><b>4.3</b> Bootstrap<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="dist-params.html"><a href="dist-params.html#clv-mean"><i class="fa fa-check"></i><b>4.4</b> Průměr<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="dist-params.html"><a href="dist-params.html#rozptyl"><i class="fa fa-check"></i><b>4.5</b> Rozptyl<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-test-single.html"><a href="stats-test-single.html"><i class="fa fa-check"></i><b>5</b> Statistické testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats-test-single.html"><a href="stats-test-single.html#postup-statistického-testování"><i class="fa fa-check"></i><b>5.1</b> Postup statistického testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stats-test-single.html"><a href="stats-test-single.html#zvolení-testu"><i class="fa fa-check"></i><b>5.1.1</b> Zvolení testu<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="stats-test-single.html"><a href="stats-test-single.html#test-h0"><i class="fa fa-check"></i><b>5.1.2</b> Formulace nulové a alternativní hypotézy<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="stats-test-single.html"><a href="stats-test-single.html#test-t-statistika"><i class="fa fa-check"></i><b>5.1.3</b> Výpočet testovací statistiky<span></span></a></li>
<li class="chapter" data-level="5.1.4" data-path="stats-test-single.html"><a href="stats-test-single.html#interpretace-výsledku"><i class="fa fa-check"></i><b>5.1.4</b> Interpretace výsledku<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-účinku"><i class="fa fa-check"></i><b>5.2</b> Velikost účinku<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="stats-test-single.html"><a href="stats-test-single.html#souvislost-s-intervalem-spolehlivosti"><i class="fa fa-check"></i><b>5.3</b> Souvislost s intervalem spolehlivosti<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="stats-test-single.html"><a href="stats-test-single.html#test-power"><i class="fa fa-check"></i><b>5.4</b> Síla testu<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-výběru"><i class="fa fa-check"></i><b>5.5</b> Velikost výběru<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="stats-test-single.html"><a href="stats-test-single.html#tests-many"><i class="fa fa-check"></i><b>5.6</b> Mnoho testů<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html"><i class="fa fa-check"></i><b>6</b> Porovnání dvou průměrů a relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#průměry"><i class="fa fa-check"></i><b>6.1</b> Průměry<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#t2-test-ind"><i class="fa fa-check"></i><b>6.1.1</b> Dva nezávislé výběry<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#dva-závislé-výběry"><i class="fa fa-check"></i><b>6.1.2</b> Dva závislé výběry<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#relativní-četnosti"><i class="fa fa-check"></i><b>6.2</b> Relativní četnosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html"><i class="fa fa-check"></i><b>7</b> Porovnání více relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#test-dobré-shody"><i class="fa fa-check"></i><b>7.1</b> Test dobré shody<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#chi-kvadrát-test-nezávislosti"><i class="fa fa-check"></i><b>7.2</b> Chi-kvadrát test nezávislosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html"><i class="fa fa-check"></i><b>8</b> Porovnání více průměrů<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#problém-více-testů"><i class="fa fa-check"></i><b>8.1</b> Problém více testů<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#anova"><i class="fa fa-check"></i><b>8.2</b> ANOVA<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />Tato kniha podléhá <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Úvod do statistiky</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="dist-params" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Kapitola 4</span> Výběrové rozdělení parametrů<a href="dist-params.html#dist-params" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Během této kapitoly se dostaneme dále do základů statistiky a představíme si jeden z nejpoužívanějších principů statistiky, který nás bude provázat po zbytku semestru. Opět to bude náročnější kapitola a možná se k ní budete chtít vrátit zpět, jak budeme centrální limitní větu (CLV) aplikovat na další statistické problémy. V této kapitole si představíme její princip. V kapitole o pravděpodobnostních rozděleních <a href="prob-dist.html#prob-dist">3</a> jsme si ukázali, že existují různé typy rozdělení, které je možné použít k popsání (připodobnění) toho, jakých hodnot bude proměnná nabývat a v jaké četnosti. Často nás zajímají nejenom hodnoty náhodné proměnné, ale také některé její <strong>parametry</strong>, jako například průměr nebo procenta. Už víme, že hodnoty náhodné proměnné jsou ovlivněny náhodou, které může mít různé důvody. Je asi intuitivní, že i parametry této proměnné budou touto náhodou ovlivněny a že nebudou vždy stejné. No a protože tyto parametry budou nabývat různých hodnot, pak můžeme jejich rozdělení zkoumat jako výběrové rozdělení parametrů. A jako u každého jiného pravděpodobnostního rozdělení můžeme popsat jaké hodnoty a s jakou frekvencí bychom u proměnné očekávali.</p>
<p>Než se pustíme do principů CLV a výběrového rozdělení paramerů, zmíníme pár vět o termilogii, kterou budeme používat. Populační parametry, se zpravidla označují písmeny řecké abecedy. Výběrové parametry pak označujeme písmeny latinské abecedy.</p>
<table>
<thead>
<tr class="header">
<th>Parametr</th>
<th>Výběr</th>
<th>Populace</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>průměr</td>
<td><span class="math inline">\(\overline{x}\)</span></td>
<td><span class="math inline">\(\mu\)</span></td>
</tr>
<tr class="even">
<td>směrodatná odchylka</td>
<td><span class="math inline">\(s\)</span></td>
<td><span class="math inline">\(\sigma\)</span></td>
</tr>
<tr class="odd">
<td>procento</td>
<td><span class="math inline">\(p\)</span></td>
<td><span class="math inline">\(\pi\)</span></td>
</tr>
</tbody>
</table>
<div id="clv-procento" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Relativní četnost<a href="dist-params.html#clv-procento" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Vraťme se zpět ke Galtonově boxu. My jsme tento proces simulovali jako <span class="math inline">\(x_i \sim B(12, 0.5)\)</span>. Řekněme, že nás zajímá zjistit jaké procento míčků skončí v prostředním (sedmém) sloupci <span class="math inline">\(p\)</span>. Procento je nějaký parametr naší proměnné, který jsme zvolili, ale mohli bychom si zvolit například medián. Toto procento bude pokaždé když kuličky spustíme znova trochu jiné. Centrální limitní věta nám pomůže kvantifikovat, jak jiné toto procento bude.</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="dist-params.html#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb60-2"><a href="dist-params.html#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet micku</span></span>
<span id="cb60-3"><a href="dist-params.html#cb60-3" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">10000</span></span>
<span id="cb60-4"><a href="dist-params.html#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pravdepodobnost uspechu (napravo)</span></span>
<span id="cb60-5"><a href="dist-params.html#cb60-5" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb60-6"><a href="dist-params.html#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 0 by znamenalo všechny kulicky nalevo, 12 všechny kulicky napravo,</span></span>
<span id="cb60-7"><a href="dist-params.html#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="co"># celkem 13 možností, jak mohou kulicky skončit</span></span>
<span id="cb60-8"><a href="dist-params.html#cb60-8" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="dv">12</span></span>
<span id="cb60-9"><a href="dist-params.html#cb60-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-10"><a href="dist-params.html#cb60-10" aria-hidden="true" tabindex="-1"></a>vysledek <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb60-11"><a href="dist-params.html#cb60-11" aria-hidden="true" tabindex="-1"></a>cetnost <span class="ot">&lt;-</span> <span class="fu">table</span>(vysledek)</span>
<span id="cb60-12"><a href="dist-params.html#cb60-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-13"><a href="dist-params.html#cb60-13" aria-hidden="true" tabindex="-1"></a><span class="co"># pouzijeme nazev 6 v tabulce, protoze 0 je prvni sloupec</span></span>
<span id="cb60-14"><a href="dist-params.html#cb60-14" aria-hidden="true" tabindex="-1"></a>p_7 <span class="ot">&lt;-</span> cetnost[<span class="fu">names</span>(cetnost) <span class="sc">==</span> <span class="st">&quot;6&quot;</span>] <span class="sc">/</span> n</span></code></pre></div>
<p>Například v simulaci, kterou jsme provedli v kodu nahoře je procento kuliček v sedmém sloupci <span class="math inline">\(p_7\)</span> rovné 0.2227. Když jsme simulovali hodnoty náhodné proměnné, tak každá kulička představovala jedno pozorování. V simulaci, kterou si teď předvedeme, vždy spustíme kuličky, spočítáme procento v sedmém sloupci, kuličky pustíme znova, opět spočítáme procento kuliček v sedmém sloupci a tak dále. Každé procento, které takto vypočítáme, představuje jednu hodnotu nějaké nové náhodné proměnné. Nakonec si ukážeme jak vypadá histogram těchto procent. Předtím, než se na animaci podíváte zkuste pomocí vašich znalostí pravděpodobnostních rozdělení odhadnout, jaké bude mít rozdělení průměrů tvar.</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="dist-params.html#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># funkce na vypocet p_7</span></span>
<span id="cb61-2"><a href="dist-params.html#cb61-2" aria-hidden="true" tabindex="-1"></a>rel_cetnost <span class="ot">&lt;-</span> <span class="cf">function</span>(x, k) {</span>
<span id="cb61-3"><a href="dist-params.html#cb61-3" aria-hidden="true" tabindex="-1"></a>  cetnost <span class="ot">&lt;-</span> <span class="fu">table</span>(x)</span>
<span id="cb61-4"><a href="dist-params.html#cb61-4" aria-hidden="true" tabindex="-1"></a>  p <span class="ot">&lt;-</span> cetnost[<span class="fu">names</span>(cetnost) <span class="sc">==</span> k] <span class="sc">/</span> <span class="fu">sum</span>(cetnost)</span>
<span id="cb61-5"><a href="dist-params.html#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(p)</span>
<span id="cb61-6"><a href="dist-params.html#cb61-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb61-7"><a href="dist-params.html#cb61-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-8"><a href="dist-params.html#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb61-9"><a href="dist-params.html#cb61-9" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">90</span></span>
<span id="cb61-10"><a href="dist-params.html#cb61-10" aria-hidden="true" tabindex="-1"></a>p_7 <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(S))</span>
<span id="cb61-11"><a href="dist-params.html#cb61-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-12"><a href="dist-params.html#cb61-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> S) {</span>
<span id="cb61-13"><a href="dist-params.html#cb61-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spustime kulicky</span></span>
<span id="cb61-14"><a href="dist-params.html#cb61-14" aria-hidden="true" tabindex="-1"></a>  vysledek <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb61-15"><a href="dist-params.html#cb61-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocitame procento kulicek v kazdem sloupci</span></span>
<span id="cb61-16"><a href="dist-params.html#cb61-16" aria-hidden="true" tabindex="-1"></a>  p_7[i] <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(vysledek, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb61-17"><a href="dist-params.html#cb61-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-18"><a href="dist-params.html#cb61-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">hist</span>(p_7,</span>
<span id="cb61-19"><a href="dist-params.html#cb61-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">by =</span> <span class="fl">0.002</span>),</span>
<span id="cb61-20"><a href="dist-params.html#cb61-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>),</span>
<span id="cb61-21"><a href="dist-params.html#cb61-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Počet opakových spuštění kuliček: &quot;</span>, S[i]),</span>
<span id="cb61-22"><a href="dist-params.html#cb61-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb61-23"><a href="dist-params.html#cb61-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">xlab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb61-24"><a href="dist-params.html#cb61-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb61-25"><a href="dist-params.html#cb61-25" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-anim"></span>
<img src="book_files/figure-html/clv-anim-.gif" alt="rozdělení procenta kuliček v sedmém sloupci při opakovaném spuštění kuliček" width="672" />
<p class="caption">
Graf 4.1: rozdělení procenta kuliček v sedmém sloupci při opakovaném spuštění kuliček
</p>
</div>
<p>Jak je vidět z histogramu v <a href="dist-params.html#fig:clv-anim">4.1</a>, rozdělení procent z opakovaných spuštění kuliček je zhruba normálně rozloženo s průměrem 0.23 a směrodatnou odchylkou 0.004, nebo jinak <span class="math inline">\(p \sim N(\)</span> 0.23 <span class="math inline">\(,\)</span> 0.004 <span class="math inline">\()\)</span>. To není žádné překvapení. Jak víme z <a href="prob-dist.html#norm-dist">3.3</a> spojité proměnné, které se shlukují okolo nějakého bodu a mohou nabývat hodnot na levo a na pravo od tohoto bodu bývají často normálně rozděleny. <strong>Centrální limitní věta</strong> nám popisuje tento fenomen a říká nám, jak vypočítat parametry tohoto normálního rozdělení (tedy průměr a směrodatnou odchylku). V našem případě bychom parametry takového rozdělení mohli vypočítat jako <span class="math display">\[p \sim N(\pi, \frac{\sigma_{\pi}}{\sqrt{n}})\]</span>kde <span class="math inline">\(n\)</span> je velikost výběru (10000 v našem případě), pričemž z <a href="prob-dist.html#binom-dist">3.2</a> víme, že rozptyl u procent vypočítáme jako <span class="math inline">\(\sigma^2 = \pi*(1-\pi)\)</span> a směrodatnou odchylku jako <span class="math inline">\(\sigma = \sqrt{\pi*(1-\pi)}\)</span>. <span class="math inline">\(\frac{\sigma_{\pi}}{\sqrt{n}}\)</span> se nazývá <strong>směrodatná chyba odhadu</strong> a označuje se jako <span class="math inline">\(\sigma_{\pi}\)</span><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a>. Protože teoretická rozdělení parametru využívá k aproximaci normální rozdělení<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>, platí pro PDF stejné překlady, jaké jsme si ukazovali v <a href="prob-dist.html#norm-dist">3.3</a>, tedy, že jednotlivé hodnoty jsou na sobě nezávislé. Graf <a href="dist-params.html#fig:clv-comp">4.2</a> ukazuje porovnání histogramu z 90 opakovaných puštění kuliček a jejich procent v sedmém sloupci s teoretickým rozdělením tohoto parametru podle CLV<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a>.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="dist-params.html#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame p</span></span>
<span id="cb62-2"><a href="dist-params.html#cb62-2" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="dv">6</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb62-3"><a href="dist-params.html#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame smerodatnou odchylku dat</span></span>
<span id="cb62-4"><a href="dist-params.html#cb62-4" aria-hidden="true" tabindex="-1"></a>s_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat))</span>
<span id="cb62-5"><a href="dist-params.html#cb62-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-6"><a href="dist-params.html#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame pdf rozlozeni procent</span></span>
<span id="cb62-7"><a href="dist-params.html#cb62-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb62-8"><a href="dist-params.html#cb62-8" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> p_hat, <span class="at">sd =</span> s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n))</span>
<span id="cb62-9"><a href="dist-params.html#cb62-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-10"><a href="dist-params.html#cb62-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-11"><a href="dist-params.html#cb62-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_7,</span>
<span id="cb62-12"><a href="dist-params.html#cb62-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="fu">seq</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>, <span class="at">by =</span> <span class="fl">0.002</span>),</span>
<span id="cb62-13"><a href="dist-params.html#cb62-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="fl">0.21</span>, <span class="fl">0.24</span>),</span>
<span id="cb62-14"><a href="dist-params.html#cb62-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb62-15"><a href="dist-params.html#cb62-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-16"><a href="dist-params.html#cb62-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb62-17"><a href="dist-params.html#cb62-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-18"><a href="dist-params.html#cb62-18" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame na druhou osu</span></span>
<span id="cb62-19"><a href="dist-params.html#cb62-19" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">new =</span> <span class="cn">TRUE</span>)</span>
<span id="cb62-20"><a href="dist-params.html#cb62-20" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb62-21"><a href="dist-params.html#cb62-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb62-22"><a href="dist-params.html#cb62-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb62-23"><a href="dist-params.html#cb62-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">axes =</span> <span class="cn">FALSE</span>,</span>
<span id="cb62-24"><a href="dist-params.html#cb62-24" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb62-25"><a href="dist-params.html#cb62-25" aria-hidden="true" tabindex="-1"></a>  <span class="at">bty =</span> <span class="st">&quot;n&quot;</span></span>
<span id="cb62-26"><a href="dist-params.html#cb62-26" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-27"><a href="dist-params.html#cb62-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-28"><a href="dist-params.html#cb62-28" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb62-29"><a href="dist-params.html#cb62-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">legend =</span> <span class="fu">c</span>(</span>
<span id="cb62-30"><a href="dist-params.html#cb62-30" aria-hidden="true" tabindex="-1"></a>    <span class="st">&quot;rozdělení procent&quot;</span>,</span>
<span id="cb62-31"><a href="dist-params.html#cb62-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">paste0</span>(<span class="st">&quot;N(&quot;</span>, <span class="fu">round</span>(p_hat, <span class="dv">2</span>), <span class="st">&quot;,&quot;</span>, <span class="fu">round</span>(s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n), <span class="dv">3</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb62-32"><a href="dist-params.html#cb62-32" aria-hidden="true" tabindex="-1"></a>  ),</span>
<span id="cb62-33"><a href="dist-params.html#cb62-33" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb62-34"><a href="dist-params.html#cb62-34" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;#1f77b4&quot;</span>),</span>
<span id="cb62-35"><a href="dist-params.html#cb62-35" aria-hidden="true" tabindex="-1"></a>  <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb62-36"><a href="dist-params.html#cb62-36" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-37"><a href="dist-params.html#cb62-37" aria-hidden="true" tabindex="-1"></a>thicks <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(pdf), <span class="at">by =</span> <span class="dv">10</span>), <span class="dv">2</span>)</span>
<span id="cb62-38"><a href="dist-params.html#cb62-38" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">4</span>, <span class="at">at =</span> thicks, <span class="at">labels =</span> thicks)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-comp"></span>
<img src="book_files/figure-html/clv-comp-1.png" alt="Porovnání rozdělení 90 opakování procent kuliček v sedmém sloupci s teoretickým rozdělením procent kuliček v sedmém sloupci podle CLV" width="672" />
<p class="caption">
Graf 4.2: Porovnání rozdělení 90 opakování procent kuliček v sedmém sloupci s teoretickým rozdělením procent kuliček v sedmém sloupci podle CLV
</p>
</div>
<p>Jak je zřejmé s parametrů rozdělení, poloha tohoto rozdělení určena průměrem a šířka rozdělení bude ovlivněna směrodatnou chybou odhadu <span class="math inline">\(\frac{\sigma_{\pi}}{\sqrt{n}}\)</span>, tedy mírou variability v datech a velikostí našeho výběru. Čím větší velikost výběru, tím menší je směrodatná odchylka rozdělení parametru<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. Aby nedocházelo k záměně směrodatné odchylky rozdělení parametru a směrodatné odchylky výběru, používá se pro směrodatnou odchylku rozdělení parametru pojem směrodatná chyba odhadu.</p>
<p>Doposud jsme pro průměr rozdělení parametru a směrodatnou odchylku používali populační parametry, tedy věděli jsme hodnotu <span class="math inline">\(\pi\)</span> v populaci a také rozptyl dat <span class="math inline">\(\pi*(1-\pi)\)</span>. To vychází z toho, že u Galtonova boxu víme, jaký náhodný proces data generuje. Většinou ale tento náhodný proces neznáme a nemáme tedy informace o populačním průměru a směrodatné odchylce. V takovém případě odhadneme obě hodnoty z dat (výběru). Je asi intuitivní, že pokud bude velikost našeho výběru <span class="math inline">\(n\)</span> malá, bude existovat větší nejistota o odhadu populačního průměru a směrodatné odchylky z dat. Abychom tuto dodatečnou nejistotu zachytili v teoretickém pravděpodobnostním rozdělení parametru, použijeme k jeho aproximaci t-rozdělení s <span class="math inline">\(n-1\)</span> stupni volnosti, tedy <span class="math display">\[p \sim T(p, \frac{s_p}{\sqrt{n}}, n-1)\]</span><a href="#fn16" class="footnote-ref" id="fnref16"><sup>16</sup></a>Jak víme z <a href="prob-dist.html#t-dist">3.4</a>, t-rozdělení dává větší pravděpodobnost hodnotám více vzdáleným od průměru.</p>
<p>Graf <a href="dist-params.html#fig:clv-t">4.3</a> ukazuje teoretické rozdělení procenta kuliček v sedmém sloupci <span class="math inline">\(p_7\)</span> při <span class="math inline">\(n=20\)</span>, <span class="math inline">\(n=50\)</span> a <span class="math inline">\(n=100\)</span>. Tedy místo 10000, pustíme pouze 20, 50 a 100 kuliček. Abychom ukázali použití t-rozdělení a odhadu průměru a směrodatné odchylky z výběru, budeme chvilku předstírat, že nevíme jejich teoretické hodnoty a proto <span class="math inline">\(p_7\)</span> a <span class="math inline">\(s_7\)</span> odhadneme z výběru Jak je vidět při puštění pouze 20 kuliček je náš odhad velmi nepřesný. Procento kuliček, které skončí v sedmém sloupci může klidně být od 0 do 0.4<a href="#fn17" class="footnote-ref" id="fnref17"><sup>17</sup></a>. To dává smysl, představte si, jaká míra nejistoty existuje, pokud do Galtonova boxu nasypeme pouze 20 kuliček. S tím, jak se zvětšuje velikost výběru <span class="math inline">\(n\)</span>, klesá míra naší nejistoty o odhadu procenta kuliček v sedmém sloupci, klesá směrodatná chyba odhadu a tím pádem o šířka teoretického rozdělení parametru.</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="dist-params.html#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="co"># definujeme velikost vyberu</span></span>
<span id="cb63-2"><a href="dist-params.html#cb63-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">50</span>, <span class="dv">100</span>)</span>
<span id="cb63-3"><a href="dist-params.html#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="co"># definujeme hodnoty pro ktere budeme pocitat pdf</span></span>
<span id="cb63-4"><a href="dist-params.html#cb63-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.00</span>,<span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb63-5"><a href="dist-params.html#cb63-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-6"><a href="dist-params.html#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime prazdný graf, do ktereho budeme pridavat</span></span>
<span id="cb63-7"><a href="dist-params.html#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x,</span>
<span id="cb63-8"><a href="dist-params.html#cb63-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span> <span class="st">&quot;n&quot;</span>,</span>
<span id="cb63-9"><a href="dist-params.html#cb63-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>),</span>
<span id="cb63-10"><a href="dist-params.html#cb63-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb63-11"><a href="dist-params.html#cb63-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb63-12"><a href="dist-params.html#cb63-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-13"><a href="dist-params.html#cb63-13" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">rev</span>(RColorBrewer<span class="sc">::</span><span class="fu">brewer.pal</span>(<span class="fu">length</span>(N) <span class="sc">+</span> <span class="dv">1</span>, <span class="at">name =</span> <span class="st">&quot;Blues&quot;</span>)  )</span>
<span id="cb63-14"><a href="dist-params.html#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="dist-params.html#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N)) {</span>
<span id="cb63-16"><a href="dist-params.html#cb63-16" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provedeme vyber a odhadneme p a sd</span></span>
<span id="cb63-17"><a href="dist-params.html#cb63-17" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> N[i]</span>
<span id="cb63-18"><a href="dist-params.html#cb63-18" aria-hidden="true" tabindex="-1"></a>  .vyber <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(<span class="at">n =</span> n, <span class="at">size =</span> s, <span class="at">prob =</span> p)</span>
<span id="cb63-19"><a href="dist-params.html#cb63-19" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(.vyber, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb63-20"><a href="dist-params.html#cb63-20" aria-hidden="true" tabindex="-1"></a>  s_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_hat<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>p_hat))</span>
<span id="cb63-21"><a href="dist-params.html#cb63-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-22"><a href="dist-params.html#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocteme pdf pro T(p, s/sqrt(n), n-1) podle zobecneneho t-rozlozeni</span></span>
<span id="cb63-23"><a href="dist-params.html#cb63-23" aria-hidden="true" tabindex="-1"></a>  pdf_t <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span>(s_hat <span class="sc">/</span> <span class="fu">sqrt</span>(n)) <span class="sc">*</span> <span class="fu">dt</span>((x <span class="sc">-</span> p_hat)<span class="sc">/</span>(s_hat <span class="sc">/</span> <span class="fu">sqrt</span>(n)), <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb63-24"><a href="dist-params.html#cb63-24" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb63-25"><a href="dist-params.html#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pridame t-rozlozeni</span></span>
<span id="cb63-26"><a href="dist-params.html#cb63-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(x, pdf_t, <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> cols[i])</span>
<span id="cb63-27"><a href="dist-params.html#cb63-27" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb63-28"><a href="dist-params.html#cb63-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-29"><a href="dist-params.html#cb63-29" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame legendu</span></span>
<span id="cb63-30"><a href="dist-params.html#cb63-30" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb63-31"><a href="dist-params.html#cb63-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;T(p, s/sqrt(n), &quot;</span>, N<span class="dv">-1</span>, <span class="st">&quot;)&quot;</span>)),</span>
<span id="cb63-32"><a href="dist-params.html#cb63-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> cols[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(N)],</span>
<span id="cb63-33"><a href="dist-params.html#cb63-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span>,</span>
<span id="cb63-34"><a href="dist-params.html#cb63-34" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb63-35"><a href="dist-params.html#cb63-35" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-t"></span>
<img src="book_files/figure-html/clv-t-1.png" alt="Porovnání vlivu velikosti výběru n na směrodatnou chybu odhadu" width="672" />
<p class="caption">
Graf 4.3: Porovnání vlivu velikosti výběru n na směrodatnou chybu odhadu
</p>
</div>
</div>
<div id="clv-is" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Interval spolehlivosti<a href="dist-params.html#clv-is" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pokud dokážeme pomocí PDF popsat předpokládáné rozdělení výběrového parametru, dokážeme pomocí CDF spočítat pravděpodobnost, že by výběrový parametr nabyl nějaké hodnoty nebo vyšší/menší. Tedy v případě výběrového parametru procent kuliček v sedmém sloupci, dokážeme spočítat <span class="math inline">\(P(p \ge q)\)</span> nebo <span class="math inline">\(P(p &lt; q)\)</span>. Například, můžeme vypočítat kvantily, které pokryjí 95% hodnot rozdělení výběrového parametru okolo průměru, tedy <span class="math inline">\(p_{0.025}\)</span> a <span class="math inline">\(p_{0.975}\)</span>. Procento hodnot rozdělení výběrového parametru pokryté našim kvantilem označujeme jako <span class="math inline">\(1-\alpha\)</span> a tedy procento hodnot rozdělení výběrového parametru nepokryté našim kvantilem jako <span class="math inline">\(\alpha\)</span>. Graf <a href="dist-params.html#fig:is-1">4.4</a> ukazuje teoretické rozdělení výběrového parametru (procenta kuliček v sedmém sloupci) a modrá oblast ukazuje hodnoty p, které jsou menší než <span class="math inline">\(p_{0.025}\)</span> nebo větší než <span class="math inline">\(p_{0.975}\)</span>. K vypočítání kvantilů rozdělení použijeme funkci <code>qt</code>.</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="dist-params.html#cb64-1" aria-hidden="true" tabindex="-1"></a>probs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.025</span>, <span class="fl">0.975</span>)</span>
<span id="cb64-2"><a href="dist-params.html#cb64-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-3"><a href="dist-params.html#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame quantily zobecneneho t-rozlozeni pro probs</span></span>
<span id="cb64-4"><a href="dist-params.html#cb64-4" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">qt</span>(probs, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb64-5"><a href="dist-params.html#cb64-5" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> q <span class="sc">*</span> s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n) <span class="sc">+</span> p_hat</span>
<span id="cb64-6"><a href="dist-params.html#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="dist-params.html#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime prazdný graf, do ktereho budeme pridavat</span></span>
<span id="cb64-8"><a href="dist-params.html#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf_t,</span>
<span id="cb64-9"><a href="dist-params.html#cb64-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb64-10"><a href="dist-params.html#cb64-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>,</span>
<span id="cb64-11"><a href="dist-params.html#cb64-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.8</span>),</span>
<span id="cb64-12"><a href="dist-params.html#cb64-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">10</span>),</span>
<span id="cb64-13"><a href="dist-params.html#cb64-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>)</span>
<span id="cb64-14"><a href="dist-params.html#cb64-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-15"><a href="dist-params.html#cb64-15" aria-hidden="true" tabindex="-1"></a><span class="co"># naznacime kvantily a hodnoty vetsi nez nebo mensi nez</span></span>
<span id="cb64-16"><a href="dist-params.html#cb64-16" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame jako &quot;h&quot; abychom nazanacili integral </span></span>
<span id="cb64-17"><a href="dist-params.html#cb64-17" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x <span class="sc">&lt;</span> q[<span class="dv">1</span>]], pdf_t[x <span class="sc">&lt;</span> q[<span class="dv">1</span>]], <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb64-18"><a href="dist-params.html#cb64-18" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x <span class="sc">&gt;</span> q[<span class="dv">2</span>]], pdf_t[x <span class="sc">&gt;</span> q[<span class="dv">2</span>]], <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>, <span class="at">type =</span> <span class="st">&quot;h&quot;</span>)</span>
<span id="cb64-19"><a href="dist-params.html#cb64-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-20"><a href="dist-params.html#cb64-20" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb64-21"><a href="dist-params.html#cb64-21" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="st">&quot;p_0.025 | p_0.975&quot;</span>, <span class="fu">paste0</span>(<span class="st">&quot;T(&quot;</span>, <span class="fu">round</span>(p_hat, <span class="dv">2</span>),</span>
<span id="cb64-22"><a href="dist-params.html#cb64-22" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;,&quot;</span>,</span>
<span id="cb64-23"><a href="dist-params.html#cb64-23" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">round</span>(s_hat <span class="sc">/</span> <span class="fu">sqrt</span>(n), <span class="dv">2</span>),</span>
<span id="cb64-24"><a href="dist-params.html#cb64-24" aria-hidden="true" tabindex="-1"></a>                                              <span class="st">&quot;,&quot;</span>,</span>
<span id="cb64-25"><a href="dist-params.html#cb64-25" aria-hidden="true" tabindex="-1"></a>                                              <span class="fu">tail</span>(N, <span class="dv">1</span>)<span class="sc">-</span><span class="dv">1</span>,<span class="st">&quot;)&quot;</span>)</span>
<span id="cb64-26"><a href="dist-params.html#cb64-26" aria-hidden="true" tabindex="-1"></a>       ), </span>
<span id="cb64-27"><a href="dist-params.html#cb64-27" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb64-28"><a href="dist-params.html#cb64-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>),</span>
<span id="cb64-29"><a href="dist-params.html#cb64-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:is-1"></span>
<img src="book_files/figure-html/is-1-1.png" alt="Kvantily p_0.025 a p_0.975 pro rozdělení T(p, s/sqrt(n), 99)" width="672" />
<p class="caption">
Graf 4.4: Kvantily p_0.025 a p_0.975 pro rozdělení T(p, s/sqrt(n), 99)
</p>
</div>
<p>Pojďme si ještě jednou shrnout, co jsme vypočítali. Pomocí CLV jsme vypočítali pravděpodobnostní rozdělení výběrového parametru (procenta kuliček v sedmém sloupci). Toto rozdělení nám říká, s jakou pravděpodobností bychom získali další parametry, pokud bychom provedli nové výběry. Představme si opět na chvilku, že neznáme proces, který procenta kuliček v sedmém sloupci generuje (tedy neznáme populační <span class="math inline">\(\pi_7\)</span>). Pomocí pravděpodobnostního rozdělení parametru výběru bychom tedy mohli usoudit něco o populačním parametru, konkrétně to, že pokud bychom výběry z populace opakovali, pak by 95% hodnot výběrového parametru bylo v rozmezí <span class="math inline">\(p_{0.025}\)</span> a <span class="math inline">\(p_{0.975}\)</span>, tedy konkrétně mezi <span class="math inline">\(p_{0.025}=\)</span> 0.16 a <span class="math inline">\(p_{0.975}\)</span>= 0.34. To je nesmírně užitečná informace, která nám říká něco o populační hodnotě, kterou vůbec neznáme (v našem předstíraném případě). Skoro pokaždé budete při analýze pracovat s výběrem<a href="#fn18" class="footnote-ref" id="fnref18"><sup>18</sup></a> a pomocí CLV tedy můžete odhadnout populačního parametru. Gratuluji, právě jste sestrojili interval spolehlivosti! Formálně se interval spolehlivosti vypočítá jako <span class="math display">\[IS_{1-\alpha} = \overline{x} +/- t_{\alpha/2; 1-\alpha/2} \frac{s}{\sqrt{n}}\]</span>kde <span class="math inline">\(t\)</span> je hodnota kvantilu t-rozdělení s <span class="math inline">\(n-1\)</span> stupni volnosti pro <span class="math inline">\(\alpha/2\)</span> a <span class="math inline">\(1-\alpha/2\)</span>.</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="dist-params.html#cb65-1" aria-hidden="true" tabindex="-1"></a>t_q <span class="ot">&lt;-</span> <span class="fu">qt</span>(probs, n<span class="dv">-1</span>)</span>
<span id="cb65-2"><a href="dist-params.html#cb65-2" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> p_hat <span class="sc">+</span> t_q <span class="sc">*</span> s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n)</span></code></pre></div>
<p>Pokud bychom vypočítali interval spolehlivosti podle výše zmíněného vzorce pro <span class="math inline">\(\alpha=0.05\)</span>, pak bychom měli hodnoty mezi [0.16, 0.34], tedy pokud bychom výběry z populace opakovali, pak by 95% z nich bylo v rozmezí [0.16, 0.34].</p>
<p>Ještě ukážeme to, co jsme zmínili nahoře, tedy, že interval spolehlivosti nám říká v jakém rozmezí bychom očekávali dané procento hodnot (toto procento je dané námi zvolenou hladinou <span class="math inline">\(1-\alpha\)</span>) výběrového parametru při opakovaných výběrech. Budeme simulovat 100 výběrů, u každého výběru spočítáme interval spolehlivosti a zobrazíme ho šedě, pokud nepokrývá populační hodnotu <span class="math inline">\(\pi_7\)</span> a modře pokud ji pokrývá. Protože naše hladina spolehlivosti je zvolena na 90%, očekáváme, že ze 100 intervalů spolehlivosti, jich asi 90 pokryje populační hodnotu a asi 10 ji nepokryje<a href="#fn19" class="footnote-ref" id="fnref19"><sup>19</sup></a>.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="dist-params.html#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime si funkci na vypocet is</span></span>
<span id="cb66-2"><a href="dist-params.html#cb66-2" aria-hidden="true" tabindex="-1"></a>interval_spolehlivosti <span class="ot">&lt;-</span> <span class="cf">function</span>(p_hat, alpha, n) {</span>
<span id="cb66-3"><a href="dist-params.html#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spocitame populacni sd</span></span>
<span id="cb66-4"><a href="dist-params.html#cb66-4" aria-hidden="true" tabindex="-1"></a>  s_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_hat <span class="sc">*</span>(<span class="dv">1</span> <span class="sc">-</span> p_hat))</span>
<span id="cb66-5"><a href="dist-params.html#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocitame pravdepodobnosti 1-alpha/2</span></span>
<span id="cb66-6"><a href="dist-params.html#cb66-6" aria-hidden="true" tabindex="-1"></a>  probs <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> (alpha <span class="sc">/</span> <span class="dv">2</span>))</span>
<span id="cb66-7"><a href="dist-params.html#cb66-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spocitame kvantily pro 1/alpha/2</span></span>
<span id="cb66-8"><a href="dist-params.html#cb66-8" aria-hidden="true" tabindex="-1"></a>  t_q <span class="ot">&lt;-</span> <span class="fu">qt</span>(probs, n<span class="dv">-1</span>)</span>
<span id="cb66-9"><a href="dist-params.html#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spocitame interval spolehlivosti</span></span>
<span id="cb66-10"><a href="dist-params.html#cb66-10" aria-hidden="true" tabindex="-1"></a>  i_s <span class="ot">&lt;-</span> p_hat <span class="sc">+</span> t_q <span class="sc">*</span> s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb66-11"><a href="dist-params.html#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(i_s)</span>
<span id="cb66-12"><a href="dist-params.html#cb66-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-13"><a href="dist-params.html#cb66-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-14"><a href="dist-params.html#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb66-15"><a href="dist-params.html#cb66-15" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb66-16"><a href="dist-params.html#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="co"># velikost vyberu</span></span>
<span id="cb66-17"><a href="dist-params.html#cb66-17" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb66-18"><a href="dist-params.html#cb66-18" aria-hidden="true" tabindex="-1"></a><span class="co"># urcime hladinu spolehlivosti</span></span>
<span id="cb66-19"><a href="dist-params.html#cb66-19" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.1</span></span>
<span id="cb66-20"><a href="dist-params.html#cb66-20" aria-hidden="true" tabindex="-1"></a><span class="co"># populacni hodnota</span></span>
<span id="cb66-21"><a href="dist-params.html#cb66-21" aria-hidden="true" tabindex="-1"></a>pi <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(<span class="at">x =</span> <span class="dv">6</span>, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">prob =</span> <span class="fl">0.5</span>) </span>
<span id="cb66-22"><a href="dist-params.html#cb66-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-23"><a href="dist-params.html#cb66-23" aria-hidden="true" tabindex="-1"></a><span class="co"># vyvorime prazdny graf</span></span>
<span id="cb66-24"><a href="dist-params.html#cb66-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="dv">1</span><span class="sc">:</span>S, <span class="at">type=</span> <span class="st">&quot;n&quot;</span>, </span>
<span id="cb66-25"><a href="dist-params.html#cb66-25" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Pořadí&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>,</span>
<span id="cb66-26"><a href="dist-params.html#cb66-26" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylim =</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.45</span>))</span>
<span id="cb66-27"><a href="dist-params.html#cb66-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-28"><a href="dist-params.html#cb66-28" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(x <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb66-29"><a href="dist-params.html#cb66-29" aria-hidden="true" tabindex="-1"></a>  <span class="co"># udelame vyber a spocitame ...</span></span>
<span id="cb66-30"><a href="dist-params.html#cb66-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...vyberovy prumer a smerodatnou odchylku</span></span>
<span id="cb66-31"><a href="dist-params.html#cb66-31" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">rbinom</span>(n, <span class="at">size =</span> <span class="dv">12</span>, <span class="at">prob =</span> <span class="fl">0.5</span>)</span>
<span id="cb66-32"><a href="dist-params.html#cb66-32" aria-hidden="true" tabindex="-1"></a>  p_hat <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(vyber, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb66-33"><a href="dist-params.html#cb66-33" aria-hidden="true" tabindex="-1"></a>  s_hat <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(p_hat <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p_hat))</span>
<span id="cb66-34"><a href="dist-params.html#cb66-34" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-35"><a href="dist-params.html#cb66-35" aria-hidden="true" tabindex="-1"></a>  <span class="co"># spocitame interval spolehlivosti</span></span>
<span id="cb66-36"><a href="dist-params.html#cb66-36" aria-hidden="true" tabindex="-1"></a>  i_s <span class="ot">&lt;-</span><span class="fu">interval_spolehlivosti</span>(p_hat, alpha, n)</span>
<span id="cb66-37"><a href="dist-params.html#cb66-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb66-38"><a href="dist-params.html#cb66-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zvolime barvu podletoho, zda is pokryva populacni parametr</span></span>
<span id="cb66-39"><a href="dist-params.html#cb66-39" aria-hidden="true" tabindex="-1"></a>  .col <span class="ot">&lt;-</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb66-40"><a href="dist-params.html#cb66-40" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(i_s[<span class="dv">1</span>] <span class="sc">&gt;</span> pi <span class="sc">|</span> i_s[<span class="dv">2</span>] <span class="sc">&lt;</span> pi) {</span>
<span id="cb66-41"><a href="dist-params.html#cb66-41" aria-hidden="true" tabindex="-1"></a>    .col <span class="ot">&lt;-</span> <span class="st">&quot;grey&quot;</span>  </span>
<span id="cb66-42"><a href="dist-params.html#cb66-42" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb66-43"><a href="dist-params.html#cb66-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># zobrazime v grafu bodovy odhad</span></span>
<span id="cb66-44"><a href="dist-params.html#cb66-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">points</span>(x, p_hat, <span class="at">pch =</span> <span class="dv">19</span>, <span class="at">col =</span> .col)</span>
<span id="cb66-45"><a href="dist-params.html#cb66-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">c</span>(x, x), i_s, <span class="at">lwd =</span> <span class="dv">1</span>, <span class="at">col =</span> .col)</span>
<span id="cb66-46"><a href="dist-params.html#cb66-46" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb66-47"><a href="dist-params.html#cb66-47" aria-hidden="true" tabindex="-1"></a><span class="co"># pridame populacni prumer</span></span>
<span id="cb66-48"><a href="dist-params.html#cb66-48" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h =</span> pi, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb66-49"><a href="dist-params.html#cb66-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-50"><a href="dist-params.html#cb66-50" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb66-51"><a href="dist-params.html#cb66-51" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="st">&quot;populační parametr&quot;</span>,</span>
<span id="cb66-52"><a href="dist-params.html#cb66-52" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;black&quot;</span>,</span>
<span id="cb66-53"><a href="dist-params.html#cb66-53" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:is-chyba"></span>
<img src="book_files/figure-html/is-chyba-1.png" alt="Ukázka opakovaných výběrů z populace a jak hladina alpha ovlivňuje podíl intervalů pokrytých opakovaných výběrem" width="672" />
<p class="caption">
Graf 4.5: Ukázka opakovaných výběrů z populace a jak hladina alpha ovlivňuje podíl intervalů pokrytých opakovaných výběrem
</p>
</div>
<p>Šířku intervalu spolehlivosti (nejistoty ohledně hodnoty populačního parametru tedy ovlivňuje):</p>
<ul>
<li>směrodatná chyba odhadu parametru <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span> (a tedy jaká je variabilita v našich výběrových datech, měřeno směrodatnou odchylkou a velikostí výběru)</li>
<li>hladina spolehlivosti <span class="math inline">\(\alpha\)</span>. Čím menší je alpha, tím je interval spolehlivosti užší, ale tím více procent opakovaných výběrů by hodnotu populačního parametru nepokrylo. Standardně tedy zvolíme <span class="math inline">\(\alpha\)</span> relativně malé, aby náš interval spolehlivosti pokryl populační parametr ve velké většině případů, a to i za cenu toho, že intrval spolehlivosti bude širší.</li>
</ul>
</div>
<div id="bootstrap" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Bootstrap<a href="dist-params.html#bootstrap" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Pojďme se na chvilku vrátit ke grafu <a href="dist-params.html#fig:clv-anim">4.1</a>. Na tomto grafu jsme ukázali hypotetickou situaci, kdy jsme věděli jak vypadá rozdělení proměnné v celé populaci. Dělali jsme opakovené výběry, abychom ukázali, jak by vypadalo rozdělení parametru, kdybychom u každého výběru vypočítali parametr, který nás zajímá. Ukazuje se, že pomocí podobné metody můžeme vypočítat rozdělení parametru a to i bez toho, abychom měli data za celou populaci. Místo toho, abychom dělali náhodné výběry z populačních dat, tak budeme dělat <strong>náhodné výběry s opakováním z výběru o velikosti <span class="math inline">\(n\)</span></strong>. Výstupem tohoto výpočtu je vektor parametru, který nás zajímá, o velikosti rovnající se počtu výběrů s opakováním. Je důležité zdůraznit, že přestože počítáme rozdělení parametru empiricky, některé ze předpokladů, které jsme zmínili u výpočtu teoretického rozdělení, jsou stále platné. Především předpoklad o nezávislosti jednotlivých pozorování a o náhodném výběru z populace (pokud chceme dělat úsudky o celé populaci).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="dist-params.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet bootstrap vyberu</span></span>
<span id="cb67-2"><a href="dist-params.html#cb67-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb67-3"><a href="dist-params.html#cb67-3" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, S)</span>
<span id="cb67-4"><a href="dist-params.html#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb67-5"><a href="dist-params.html#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># udelame vyber s opakovanim</span></span>
<span id="cb67-6"><a href="dist-params.html#cb67-6" aria-hidden="true" tabindex="-1"></a>  boostrap_vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(.vyber, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb67-7"><a href="dist-params.html#cb67-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># vypocitame parametr vyberu</span></span>
<span id="cb67-8"><a href="dist-params.html#cb67-8" aria-hidden="true" tabindex="-1"></a>  p_hat[i] <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(boostrap_vyber, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb67-9"><a href="dist-params.html#cb67-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb67-10"><a href="dist-params.html#cb67-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-11"><a href="dist-params.html#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_hat, </span>
<span id="cb67-12"><a href="dist-params.html#cb67-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb67-13"><a href="dist-params.html#cb67-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Procento kuliček v sedmém sloupci&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span>,</span>
<span id="cb67-14"><a href="dist-params.html#cb67-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:bootstrap-ukazka"></span>
<img src="book_files/figure-html/bootstrap-ukazka-1.png" alt="Boostrap výpočet procenta kuliček v sedmém sloupci" width="672" />
<p class="caption">
Graf 4.6: Boostrap výpočet procenta kuliček v sedmém sloupci
</p>
</div>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="dist-params.html#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitale kvantil 0.025 a 0.975</span></span>
<span id="cb68-2"><a href="dist-params.html#cb68-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb68-3"><a href="dist-params.html#cb68-3" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> <span class="fu">quantile</span>(p_hat, <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p>Jako příklad se vrátíme k našemu výběru z <a href="dist-params.html#fig:is-chyba">4.5</a>, kdy jsme na chvilku předstírali, že neznáme populační data, respektive náhodný proces, který data generuje. Graf <a href="dist-params.html#fig:bootstrap-ukazka">4.6</a> ukazuje empirické rozdělení procenta kuliček, které skončí v sedmého sloupci. Pokud bychom chtěli vypočítat interval spolehlivosti, vypočítáme emprirický kvantil, tak jako jsme dělali v kapitole o mírách polohy <a href="desc-stats.html#kvantily">2.3</a>. 95% interval spolehlivosti je [0.17, 0.34].</p>
<p>Pokud můžeme vypočítat rozdělení parametru analyticky, proč bychom měli používat bootstrap, který je více náročný z hlediska potřeby provádět opakované výběry. Je to proto, že pomocí bootsrapu můžeme vypočítat empirické rozdělení i parametrů, pro které neexistuje jednoduché teoretické rozdělení. Pracujeme opět se stejným hypotetickým výběrem o velikosti <span class="math inline">\(n=\)</span> 100. Pokud bychom například chtěli vypočítat interval spolehlivosti poměru kuliček v pátém a sedmém sloupci, tedy <span class="math inline">\(\frac{p_{5}}{p_{7}}\)</span>, nebude jednoduché vypočítat směrodatnou chybu<a href="#fn20" class="footnote-ref" id="fnref20"><sup>20</sup></a>. S pomocí bootstrapu můžeme udělat <span class="math inline">\(S\)</span> výběrů s opakováním, u každého výběru vypočítat <span class="math inline">\(\frac{p_{5}}{p_{7}}\)</span>. Získáme tak vektor o velikosti <span class="math inline">\(S\)</span>, který můžeme použít k vypočítání empirického rozdělení parametru <span class="math inline">\(\frac{p_{5}}{p_{7}}\)</span>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="dist-params.html#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime funkci</span></span>
<span id="cb69-2"><a href="dist-params.html#cb69-2" aria-hidden="true" tabindex="-1"></a>bootstrap <span class="ot">&lt;-</span> <span class="cf">function</span>(x, func, S) {</span>
<span id="cb69-3"><a href="dist-params.html#cb69-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">length</span>(x)</span>
<span id="cb69-4"><a href="dist-params.html#cb69-4" aria-hidden="true" tabindex="-1"></a>  parameter <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, S)</span>
<span id="cb69-5"><a href="dist-params.html#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provedeme vybery s opakovanim</span></span>
<span id="cb69-6"><a href="dist-params.html#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb69-7"><a href="dist-params.html#cb69-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># udelame vyber s opakovanim</span></span>
<span id="cb69-8"><a href="dist-params.html#cb69-8" aria-hidden="true" tabindex="-1"></a>    boostrap_vyber <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb69-9"><a href="dist-params.html#cb69-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># vypocitame parametr vyberu</span></span>
<span id="cb69-10"><a href="dist-params.html#cb69-10" aria-hidden="true" tabindex="-1"></a>    parameter[i] <span class="ot">&lt;-</span> <span class="fu">func</span>(boostrap_vyber)</span>
<span id="cb69-11"><a href="dist-params.html#cb69-11" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-12"><a href="dist-params.html#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(parameter)</span>
<span id="cb69-13"><a href="dist-params.html#cb69-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-14"><a href="dist-params.html#cb69-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-15"><a href="dist-params.html#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="co"># funkce na vypocet pomeru</span></span>
<span id="cb69-16"><a href="dist-params.html#cb69-16" aria-hidden="true" tabindex="-1"></a>pomer <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb69-17"><a href="dist-params.html#cb69-17" aria-hidden="true" tabindex="-1"></a>  ans <span class="ot">&lt;-</span> <span class="fu">rel_cetnost</span>(x, <span class="st">&quot;4&quot;</span>) <span class="sc">/</span> <span class="fu">rel_cetnost</span>(x, <span class="st">&quot;6&quot;</span>)</span>
<span id="cb69-18"><a href="dist-params.html#cb69-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># pokud nebudou zadne kulicky v jednom ze sloupcu ...</span></span>
<span id="cb69-19"><a href="dist-params.html#cb69-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># ...vratit NA</span></span>
<span id="cb69-20"><a href="dist-params.html#cb69-20" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">length</span>(ans) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb69-21"><a href="dist-params.html#cb69-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(<span class="cn">NA</span>)</span>
<span id="cb69-22"><a href="dist-params.html#cb69-22" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb69-23"><a href="dist-params.html#cb69-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">return</span>(ans)</span>
<span id="cb69-24"><a href="dist-params.html#cb69-24" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb69-25"><a href="dist-params.html#cb69-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb69-26"><a href="dist-params.html#cb69-26" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame bootstrap parametru</span></span>
<span id="cb69-27"><a href="dist-params.html#cb69-27" aria-hidden="true" tabindex="-1"></a>p_hat <span class="ot">&lt;-</span> <span class="fu">bootstrap</span>(.vyber, pomer, S)</span>
<span id="cb69-28"><a href="dist-params.html#cb69-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-29"><a href="dist-params.html#cb69-29" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(p_hat, </span>
<span id="cb69-30"><a href="dist-params.html#cb69-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb69-31"><a href="dist-params.html#cb69-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Poměr procenta kuliček v pátém a sedmém sloupci&quot;</span>, </span>
<span id="cb69-32"><a href="dist-params.html#cb69-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span>,</span>
<span id="cb69-33"><a href="dist-params.html#cb69-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>)</span></code></pre></div>
<p><img src="book_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="dist-params.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitale kvantil 0.025 a 0.975</span></span>
<span id="cb70-2"><a href="dist-params.html#cb70-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb70-3"><a href="dist-params.html#cb70-3" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> <span class="fu">quantile</span>(p_hat, </span>
<span id="cb70-4"><a href="dist-params.html#cb70-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), </span>
<span id="cb70-5"><a href="dist-params.html#cb70-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>95% interval spolehlivosti pro <span class="math inline">\(\frac{p_{5}}{p_{7}}\)</span> je [0.11, 0.67].</p>
</div>
<div id="clv-mean" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Průměr<a href="dist-params.html#clv-mean" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jak jsme uvedli v <a href="dist-params.html#clv-procento">4.1</a>, CLV říká, že průměr nezávislých proměnných <span class="math inline">\(\theta\)</span> bude normálně rozložen se směrodatnou chybou rovnou <span class="math inline">\(\frac{s}{\sqrt(n)}\)</span><a href="#fn21" class="footnote-ref" id="fnref21"><sup>21</sup></a>, tedy <span class="math inline">\(\theta \sim N(\theta, \frac{s}{\sqrt(n)})\)</span>. U procent <span class="math inline">\(p\)</span> jsme směrodatnou odchylku počítali jako <span class="math inline">\(\sqrt{p(1-p)}\)</span>. U průměru počítáme směrodatnou odchylku jako <span class="math inline">\(s = \sqrt{\frac{1}{n-1}\sum_{i=1}^n (x_i - \overline{x})^2}\)</span>, tedy jak jsme si ukazovali v <a href="desc-stats.html#desc-vars">2.2</a>. rozdělení výběrového průměru náhodné proměnné <span class="math inline">\(x\)</span>, tedy bude <span class="math display">\[\overline{x} \sim T(\overline{x}, \frac{s}{\sqrt{n}}, n-1)\]</span>Platí přitom, že nezáleží na tom, zda náhodné proměnná pochází z normálního rozdělení. CLV se týká průměru této proměnné. Jako příklad si ukážeme hypotetickou situaci, v které budeme vědět populační rozdělení náhodné proměnné <span class="math inline">\(x_i\)</span>, která pochází z uniformního rozdělení <span class="math inline">\(x_i \sim U(-10, 10)\)</span>. Provedeme 5000 výběrů o velikosti <span class="math inline">\(n=100\)</span> z této populace, u každého spočítáme průměr a poté zobrazíme rozdělení těchto průměrů histogramem.</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="dist-params.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb71-2"><a href="dist-params.html#cb71-2" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="dv">5000</span></span>
<span id="cb71-3"><a href="dist-params.html#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vektor, kam budeme ukladat prumery</span></span>
<span id="cb71-4"><a href="dist-params.html#cb71-4" aria-hidden="true" tabindex="-1"></a>prumer <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, S)</span>
<span id="cb71-5"><a href="dist-params.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="co"># velikost vyberu</span></span>
<span id="cb71-6"><a href="dist-params.html#cb71-6" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb71-7"><a href="dist-params.html#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co"># parametry uniformniho rozlozeni</span></span>
<span id="cb71-8"><a href="dist-params.html#cb71-8" aria-hidden="true" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="sc">-</span><span class="dv">10</span></span>
<span id="cb71-9"><a href="dist-params.html#cb71-9" aria-hidden="true" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb71-10"><a href="dist-params.html#cb71-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-11"><a href="dist-params.html#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>S) {</span>
<span id="cb71-12"><a href="dist-params.html#cb71-12" aria-hidden="true" tabindex="-1"></a>  vyber <span class="ot">&lt;-</span> <span class="fu">runif</span>(n, <span class="at">min =</span> <span class="sc">-</span><span class="dv">10</span>, <span class="at">max =</span> <span class="dv">10</span>)</span>
<span id="cb71-13"><a href="dist-params.html#cb71-13" aria-hidden="true" tabindex="-1"></a>  prumer[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(vyber)</span>
<span id="cb71-14"><a href="dist-params.html#cb71-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-15"><a href="dist-params.html#cb71-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-16"><a href="dist-params.html#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(prumer,</span>
<span id="cb71-17"><a href="dist-params.html#cb71-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb71-18"><a href="dist-params.html#cb71-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">breaks =</span> <span class="dv">10</span>,</span>
<span id="cb71-19"><a href="dist-params.html#cb71-19" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>),</span>
<span id="cb71-20"><a href="dist-params.html#cb71-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb71-21"><a href="dist-params.html#cb71-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;Průměr x~U(-10, 10)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb71-22"><a href="dist-params.html#cb71-22" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-23"><a href="dist-params.html#cb71-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-24"><a href="dist-params.html#cb71-24" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>, </span>
<span id="cb71-25"><a href="dist-params.html#cb71-25" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">paste0</span>(<span class="st">&quot;průměr: &quot;</span>, <span class="fu">round</span>(<span class="fu">mean</span>(prumer), <span class="dv">2</span>),</span>
<span id="cb71-26"><a href="dist-params.html#cb71-26" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;</span><span class="sc">\n</span><span class="st">&quot;</span>,</span>
<span id="cb71-27"><a href="dist-params.html#cb71-27" aria-hidden="true" tabindex="-1"></a>                       <span class="st">&quot;směr.odchylka: &quot;</span>, <span class="fu">round</span>(<span class="fu">sd</span>(prumer), <span class="dv">2</span>)),</span>
<span id="cb71-28"><a href="dist-params.html#cb71-28" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">10</span>,</span>
<span id="cb71-29"><a href="dist-params.html#cb71-29" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb71-30"><a href="dist-params.html#cb71-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb71-31"><a href="dist-params.html#cb71-31" aria-hidden="true" tabindex="-1"></a>       )</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-unif"></span>
<img src="book_files/figure-html/clv-unif-1.png" alt="Průměr 5000 výběrů o velikosti n=100 z x~U(-10, 10)" width="672" />
<p class="caption">
Graf 4.7: Průměr 5000 výběrů o velikosti n=100 z x~U(-10, 10)
</p>
</div>
<p>Jak je vidět z grafu <a href="dist-params.html#fig:clv-unif">4.7</a> rozdělení průměrů z 5000 výběrů je normálně rozloženo. Průměr těchto 5000 průměrů je 0.01 a směrodatná odchylka je 0.57. Porovnejme tyto hodnoty s teoretickým rozdělením podle CLV. Z kapitoly o uniformním rozdělení <a href="prob-dist.html#unif-dist">3.5</a> víme, že průměr se vypočítá jako <span class="math inline">\(\mu = \frac{1}{2}(a+b)\)</span>, tedy pro <span class="math inline">\(U(-10 ,10)\)</span> je to hodnota 0. Rozptyl je <span class="math inline">\(\sigma^2 = \frac{1}{12}(b-a)^2\)</span>, tedy pro <span class="math inline">\(U(-10 ,10)\)</span> hodnota 33.33. Směrodatná chyba odhadu je <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>, tedy 0.58. Jak je vidět, parametry normálního rozdělení průměru podle CLV se shodují s údaji, které jsme získali při simulaci naší hypotetické situace.</p>
<p>Pokud bychom chtěli vypočítat <strong>interval spolehlivosti</strong>, můžeme postupovat stejně jako jsme uvedli v kapitole o intervalu spolehlivosti <a href="dist-params.html#clv-is">4.2</a>. Pokud máme k dispozici výběr proměnné <span class="math inline">\(x_i\)</span>, pak platí <span class="math display">\[IS_{1-\alpha} = \overline{x} +/- t_{\alpha/2; 1-\alpha/2} \frac{s}{\sqrt{n}}\]</span>tedy, že k výběrovému průměru přičteme/odečteme hodnotu směrodatné chyby odhadu vynásobenou kvantilem t-rozdělení (podle zvolené hladiny <span class="math inline">\(\alpha\)</span>).</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="dist-params.html#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zvolime hladinu spolehlivosti</span></span>
<span id="cb72-2"><a href="dist-params.html#cb72-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb72-3"><a href="dist-params.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame vyberovy prumer</span></span>
<span id="cb72-4"><a href="dist-params.html#cb72-4" aria-hidden="true" tabindex="-1"></a>x_hat <span class="ot">&lt;-</span> <span class="fu">mean</span>(vyber)</span>
<span id="cb72-5"><a href="dist-params.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame vyberovou smer. odchylku</span></span>
<span id="cb72-6"><a href="dist-params.html#cb72-6" aria-hidden="true" tabindex="-1"></a>s_hat <span class="ot">&lt;-</span> <span class="fu">sd</span>(vyber)</span>
<span id="cb72-7"><a href="dist-params.html#cb72-7" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame kvantil t rozdeleni pro n-1</span></span>
<span id="cb72-8"><a href="dist-params.html#cb72-8" aria-hidden="true" tabindex="-1"></a>t_q <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>), <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb72-9"><a href="dist-params.html#cb72-9" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame interval spolehlivosti</span></span>
<span id="cb72-10"><a href="dist-params.html#cb72-10" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> x_hat <span class="sc">+</span> t_q <span class="sc">*</span> s_hat<span class="sc">/</span><span class="fu">sqrt</span>(n)</span>
<span id="cb72-11"><a href="dist-params.html#cb72-11" aria-hidden="true" tabindex="-1"></a><span class="co"># zaokrouhlime pro prehlednost</span></span>
<span id="cb72-12"><a href="dist-params.html#cb72-12" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> <span class="fu">round</span>(i_s, <span class="dv">2</span>)</span></code></pre></div>
<p>Abychom si ukázali výpočet intervalu spolehlivosti, použijeme poslední výběr z naší simulace. Průměr tohoto výběru o velikosti <span class="math inline">\(n=\)</span> 100 je -0.18 a směrodatná odchylka je 5.57. 95% interval spolehlivosti je [-1.28, 0.93]. Tedy, pokud bychom výběry opakovali, pak by 95% výběrů mělo průměr v rozmezí [-1.28, 0.93]. Protože se jedná o hypotetickou situaci, tak my víme, že populační výběr pro <span class="math inline">\(U(-10, 10)\)</span> je roven 0. Jak je vidět, přestože náš výběr je pouze o velikosti <span class="math inline">\(n=\)</span> 100, pak dokážeme pomocí intervalu spolehlivosti získat informaci o populačním průměru.</p>
</div>
<div id="rozptyl" class="section level2 hasAnchor" number="4.5">
<h2><span class="header-section-number">4.5</span> Rozptyl<a href="dist-params.html#rozptyl" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Poslední z parametrů, jehož výběrové rozdělění si představíme je rozptyl, respektive směrodatná odchylka. Stejně jako platí u průměru, i rozptyl různých náhodných proměnných se bude lišit v závislosti na výběru. Interval spolehlivosti pro výběrový rozptyl <span class="math inline">\(s^2\)</span> je možné zapsat analytickou formou jako <span class="math display">\[\frac{(n-1)s^2}{\chi^2_{\alpha/2}} \le \sigma^2 \le \frac{(n-1)s^2}{\chi^2_{1-\alpha/2}}\]</span>kde <span class="math inline">\(\chi^2\)</span> je kvantil chi-kvadrát rozdělení s <span class="math inline">\(n-1\)</span> stupni volnosti. K výpočtu výběrového rozdělení rozptylu bychom také mohli použít bootstrap. Vraťme se zpátky k výpočtu počtu slov ve větě z kapitoly <a href="prob-dist.html#pois-dist">3.6</a>, kde jsme počet slov ve větě <span class="math inline">\(s_i\)</span> modelovali jako <span class="math inline">\(log(s_i) \sim T(2.61, 0.66, 66)\)</span>. Zkoumaný proslov můžeme chápat jako výběr z populace proslovů. Tedy vypočítaný výběrový průměr <span class="math inline">\(log(\overline{s}) = 2.61\)</span> a výběrová směrodatná odchylka rovná <span class="math inline">\(0.66\)</span> se budou lišit v závislosti na výběru. Tuto nejistotu bychom měli vzít v potaz i při predikci procenta vět delších než 20 slov. Graf <a href="dist-params.html#fig:clv-prumer-sd">4.8</a> ukazuje výběrové rozdělení průměru a výběrové rozdělení směrodatné odchylky.</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="dist-params.html#cb73-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">66</span></span>
<span id="cb73-2"><a href="dist-params.html#cb73-2" aria-hidden="true" tabindex="-1"></a>vyberovy_prumer <span class="ot">&lt;-</span> <span class="fl">2.61</span></span>
<span id="cb73-3"><a href="dist-params.html#cb73-3" aria-hidden="true" tabindex="-1"></a>vyberova_sd <span class="ot">&lt;-</span> <span class="fl">0.66</span></span>
<span id="cb73-4"><a href="dist-params.html#cb73-4" aria-hidden="true" tabindex="-1"></a>smerodatna_chyba <span class="ot">&lt;-</span> vyberova_sd <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb73-5"><a href="dist-params.html#cb73-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-6"><a href="dist-params.html#cb73-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame pdf vyberoveho rozdeleni prumery</span></span>
<span id="cb73-7"><a href="dist-params.html#cb73-7" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">2.2</span>, <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb73-8"><a href="dist-params.html#cb73-8" aria-hidden="true" tabindex="-1"></a>pdf_prumer <span class="ot">&lt;-</span> <span class="fu">dt</span>((x <span class="sc">-</span> vyberovy_prumer) <span class="sc">/</span> smerodatna_chyba, <span class="at">df =</span> n<span class="dv">-1</span>) <span class="sc">*</span> <span class="dv">1</span><span class="sc">/</span>smerodatna_chyba</span>
<span id="cb73-9"><a href="dist-params.html#cb73-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-10"><a href="dist-params.html#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb73-11"><a href="dist-params.html#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="co"># vyberove rozdeleni prumeru</span></span>
<span id="cb73-12"><a href="dist-params.html#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf_prumer,</span>
<span id="cb73-13"><a href="dist-params.html#cb73-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Logaritmus počtu slov ve větě&quot;</span>,</span>
<span id="cb73-14"><a href="dist-params.html#cb73-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb73-15"><a href="dist-params.html#cb73-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb73-16"><a href="dist-params.html#cb73-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Výběrové rozdělení průměru&quot;</span>,</span>
<span id="cb73-17"><a href="dist-params.html#cb73-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb73-18"><a href="dist-params.html#cb73-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.7</span>)</span>
<span id="cb73-19"><a href="dist-params.html#cb73-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-20"><a href="dist-params.html#cb73-20" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame pdf vyberove směrodatné odchylky</span></span>
<span id="cb73-21"><a href="dist-params.html#cb73-21" aria-hidden="true" tabindex="-1"></a>r_s <span class="ot">&lt;-</span> <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span>vyberova_sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="fl">1e5</span>, n<span class="dv">-1</span>))</span>
<span id="cb73-22"><a href="dist-params.html#cb73-22" aria-hidden="true" tabindex="-1"></a>pdf_s <span class="ot">&lt;-</span> <span class="fu">density</span>(r_s, <span class="at">n=</span><span class="fl">1e5</span>)</span>
<span id="cb73-23"><a href="dist-params.html#cb73-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-24"><a href="dist-params.html#cb73-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-25"><a href="dist-params.html#cb73-25" aria-hidden="true" tabindex="-1"></a><span class="co"># vyberove rozdeleni rozptylu</span></span>
<span id="cb73-26"><a href="dist-params.html#cb73-26" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(pdf_s,</span>
<span id="cb73-27"><a href="dist-params.html#cb73-27" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Logaritmus počtu slov ve větě&quot;</span>,</span>
<span id="cb73-28"><a href="dist-params.html#cb73-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb73-29"><a href="dist-params.html#cb73-29" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb73-30"><a href="dist-params.html#cb73-30" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;Výběrové rozdělení směr.odchylky&quot;</span>,</span>
<span id="cb73-31"><a href="dist-params.html#cb73-31" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb73-32"><a href="dist-params.html#cb73-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.main =</span> <span class="fl">0.7</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-prumer-sd"></span>
<img src="book_files/figure-html/clv-prumer-sd-1.png" alt="PDF výběrového průměru a směrodatné odchylky" width="960" />
<p class="caption">
Graf 4.8: PDF výběrového průměru a směrodatné odchylky
</p>
</div>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="dist-params.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame jeste interval spolehlivosti</span></span>
<span id="cb74-2"><a href="dist-params.html#cb74-2" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb74-3"><a href="dist-params.html#cb74-3" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>)</span>
<span id="cb74-4"><a href="dist-params.html#cb74-4" aria-hidden="true" tabindex="-1"></a>is_prumer <span class="ot">&lt;-</span> vyberovy_prumer <span class="sc">+</span> smerodatna_chyba <span class="sc">*</span> <span class="fu">qt</span>(q, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb74-5"><a href="dist-params.html#cb74-5" aria-hidden="true" tabindex="-1"></a>is_sd <span class="ot">&lt;-</span> <span class="fu">quantile</span>(r_s, <span class="at">probs =</span> q)</span></code></pre></div>
<p>95% interval spolehlivosti pro průměr je [2.45, 2.77] a 95% interval spolehlivosti pro směrodatnou odchylku je [0.56, 0.8]. Pokud bychom převedli hodnoty zpět na původní škálu, pak by byl 95% interval spolehlivosti pro průměr počtu slov ve větě [11.56, 15.99] a 95% interval spolehlivosti pro směrodatnou odchylku je [1.76, 2.22]. Abychom tuto nejistotu vzali v potaz při naší predikci budeme simulovat výběry z t-rozdělení, kde zohledníme vypočítanou nejistotu ve výběrovém průměru a směrodatné odchylce.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="dist-params.html#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet simulaci</span></span>
<span id="cb75-2"><a href="dist-params.html#cb75-2" aria-hidden="true" tabindex="-1"></a>s <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb75-3"><a href="dist-params.html#cb75-3" aria-hidden="true" tabindex="-1"></a><span class="co"># matrix na ukladani simulaci</span></span>
<span id="cb75-4"><a href="dist-params.html#cb75-4" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> s, <span class="at">ncol =</span> n)</span>
<span id="cb75-5"><a href="dist-params.html#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>s) {</span>
<span id="cb75-6"><a href="dist-params.html#cb75-6" aria-hidden="true" tabindex="-1"></a>  S[i, ] <span class="ot">&lt;-</span> <span class="fu">rt</span>(n, <span class="at">df =</span> n<span class="dv">-1</span>) <span class="sc">*</span> </span>
<span id="cb75-7"><a href="dist-params.html#cb75-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>((n<span class="dv">-1</span>)<span class="sc">*</span>vyberova_sd<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, n<span class="dv">-1</span>)) <span class="sc">+</span> <span class="co"># vyberovy rozptyl</span></span>
<span id="cb75-8"><a href="dist-params.html#cb75-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rnorm</span>(<span class="dv">1</span>, vyberovy_prumer, smerodatna_chyba) <span class="co"># vyberovy prumer</span></span>
<span id="cb75-9"><a href="dist-params.html#cb75-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb75-10"><a href="dist-params.html#cb75-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-11"><a href="dist-params.html#cb75-11" aria-hidden="true" tabindex="-1"></a><span class="co"># zobrazime prvnich 100</span></span>
<span id="cb75-12"><a href="dist-params.html#cb75-12" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(s,</span>
<span id="cb75-13"><a href="dist-params.html#cb75-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb75-14"><a href="dist-params.html#cb75-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlab =</span> <span class="st">&quot;log(s)&quot;</span>,</span>
<span id="cb75-15"><a href="dist-params.html#cb75-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">ylab =</span> <span class="st">&quot;Hustota pravděpodobnosti (PDF)&quot;</span>, <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb75-16"><a href="dist-params.html#cb75-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb75-17"><a href="dist-params.html#cb75-17" aria-hidden="true" tabindex="-1"></a>  <span class="at">xlim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">5</span>), <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.85</span>),</span>
<span id="cb75-18"><a href="dist-params.html#cb75-18" aria-hidden="true" tabindex="-1"></a>  <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb75-19"><a href="dist-params.html#cb75-19" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-20"><a href="dist-params.html#cb75-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span>) {</span>
<span id="cb75-21"><a href="dist-params.html#cb75-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provedeme vybery z t rozdeleni o stejne velikosti vyberu</span></span>
<span id="cb75-22"><a href="dist-params.html#cb75-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lines</span>(<span class="fu">density</span>(S[i, ]), <span class="at">col =</span> <span class="fu">adjustcolor</span>(<span class="st">&quot;black&quot;</span>, <span class="at">alpha.f =</span> <span class="fl">0.2</span>))</span>
<span id="cb75-23"><a href="dist-params.html#cb75-23" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:clv-sim-t"></span>
<img src="book_files/figure-html/clv-sim-t-1.png" alt="Prvních 50 simulací výběrů z t-rozdělení při n=66 a zohlednění nejistoty výběrového průměru a směrodatné odchylky" width="672" />
<p class="caption">
Graf 4.9: Prvních 50 simulací výběrů z t-rozdělení při n=66 a zohlednění nejistoty výběrového průměru a směrodatné odchylky
</p>
</div>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="dist-params.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame (P &gt; log(20))</span></span>
<span id="cb76-2"><a href="dist-params.html#cb76-2" aria-hidden="true" tabindex="-1"></a>q <span class="ot">&lt;-</span> <span class="fu">log</span>(<span class="dv">20</span>)</span>
<span id="cb76-3"><a href="dist-params.html#cb76-3" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">apply</span>(S, <span class="dv">1</span>, <span class="cf">function</span>(x) <span class="fu">sum</span>(x <span class="sc">&gt;</span> q) <span class="sc">/</span> n)</span>
<span id="cb76-4"><a href="dist-params.html#cb76-4" aria-hidden="true" tabindex="-1"></a>i_s <span class="ot">&lt;-</span> <span class="fu">quantile</span>(cdf, <span class="at">probs =</span> <span class="fu">c</span>(alpha<span class="sc">/</span><span class="dv">2</span>, <span class="dv">1</span><span class="sc">-</span>alpha<span class="sc">/</span><span class="dv">2</span>))</span></code></pre></div>
<p>Provedeme 10^{5} simulaci, v každé simulaci provedeme výběr ze zobezněného t rozdělení, o velikosti <span class="math inline">\(n=\)</span> 66. U každého výběru vezmeme v potaz nejistotu o odhadu výběrového průměru a výběrové směrodatné odchylky. Graf <a href="dist-params.html#fig:clv-sim-t">4.9</a> ukazuje prvních 50 simulací počtu slov ve větě <span class="math inline">\(log(s_i)\)</span>. Abychom spočítali pravděpodobnost, že v libovolném budoucím proslovu o 66 větách bude věta delší než 20 slov, tedy <span class="math inline">\(P(log(s_i) &gt; log(20))\)</span>, pak u každé simulace spočítáme % hodnot větších než <span class="math inline">\(log(20)\)</span>. Protože existuje nejistota ohledně každého výběru, pak je i ohledně odhadu <span class="math inline">\(P(log(s_i) &gt; log(20))\)</span> nejistota. Průměr odhadu <span class="math inline">\(P(log(s_i) &gt; log(20))\)</span> je 0.28 a směrodatná odchylka 0.07. Můžeme použít empirický kvantil a výpočítat, že 95% interval spolehlivosti pro podíl vět s počet slov větších než 20 je [15.15, 42.42]<a href="#fn22" class="footnote-ref" id="fnref22"><sup>22</sup></a>. Jak je tedy vidět interval spolehlivosti je široký. To plyne z toho, že v samotných datech je velký rozptyl v počtu slov ve větě a také z toho, že naše data obsahují pouze 66 vět.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="12">
<li id="fn12"><p>V případě, že neznáme populační rozptyl <span class="math inline">\(\sigma^2\)</span> a populační průměr <span class="math inline">\(\pi\)</span>, tak se směrodatná chyba odhadu označuje jako <span class="math inline">\(s_{p}\)</span>.<a href="dist-params.html#fnref12" class="footnote-back">↩︎</a></p></li>
<li id="fn13"><p>Respektive t-rozdělení pokud je velikost našeho výběru malá a populační parametry neznámé.<a href="dist-params.html#fnref13" class="footnote-back">↩︎</a></p></li>
<li id="fn14"><p><span class="math inline">\(p_7 \sim N(0.19, \sqrt {\frac{0.19*0.81}{n}})\)</span><a href="dist-params.html#fnref14" class="footnote-back">↩︎</a></p></li>
<li id="fn15"><p>Tento vztah není lineární, tedy 2x větší výběr neznamená 2x menší směrodatnou odchylku rozdělení parametru, směrodatná odchylka rozdělení klesá <span class="math inline">\(\frac{1}{\sqrt{n}}\)</span>.<a href="dist-params.html#fnref15" class="footnote-back">↩︎</a></p></li>
<li id="fn16"><p>Směrodatná odchylka odhadnutá z dat se označuje <span class="math inline">\(s\)</span>.<a href="dist-params.html#fnref16" class="footnote-back">↩︎</a></p></li>
<li id="fn17"><p>Velikost tohoto výběru je dokonce tak malá, že aproximace t-rozdělením nemusí být přesná.<a href="dist-params.html#fnref17" class="footnote-back">↩︎</a></p></li>
<li id="fn18"><p>Ať už výběrem z populace jedniců, nebo výběrem výrobků z nějakého výrobního procesu nebo výběrem teplot měřených v nějaký čas dne apod.<a href="dist-params.html#fnref18" class="footnote-back">↩︎</a></p></li>
<li id="fn19"><p>Protože náš výběr je pouze 100, nebude přesně 10 a 90.<a href="dist-params.html#fnref19" class="footnote-back">↩︎</a></p></li>
<li id="fn20"><p>Pro představu <a href="https://en.wikipedia.org/wiki/Fieller%27s_theorem">zde</a> je analytické řešení.<a href="dist-params.html#fnref20" class="footnote-back">↩︎</a></p></li>
<li id="fn21"><p>Směrodatnou odchylku parametru nazýváme směrodatná chyba, aby nedocházelo k záměně se směrodatnou odchylkou výběru.<a href="dist-params.html#fnref21" class="footnote-back">↩︎</a></p></li>
<li id="fn22"><p>Při libovolném budoucím proslovu o 66 větách <span class="math inline">\(n=66\)</span>. Pokud by byl budoucí proslov delší, byl by interval spolehlivosti pro odhad <span class="math inline">\(P(log(s_i) &gt; log(20))\)</span> menší, protože bychom měli více vět a tím pádem stabilnější odhad.<a href="dist-params.html#fnref22" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prob-dist.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="stats-test-single.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
