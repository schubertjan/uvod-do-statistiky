<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Kapitola 5 Statistické testování | Úvod do statistiky</title>
  <meta name="description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  <meta name="generator" content="bookdown 0.25 and GitBook 2.6.7" />

  <meta property="og:title" content="Kapitola 5 Statistické testování | Úvod do statistiky" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Kapitola 5 Statistické testování | Úvod do statistiky" />
  
  <meta name="twitter:description" content="Tato kniha obsahuje materiál ke cvičení kurzu Úvod do statistiky (JSB535)." />
  

<meta name="author" content="Jan Schubert" />


<meta name="date" content="2022-04-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="dist-params.html"/>
<link rel="next" href="porovnání-dvou-průměrů-a-relativních-četností.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Úvod do statistiky</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Úvod<span></span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#příklad-popisné-statistiky"><i class="fa fa-check"></i><b>1.1</b> Příklad popisné statistiky<span></span></a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#příklad-inferenční-statistiky"><i class="fa fa-check"></i><b>1.2</b> Příklad inferenční statistiky<span></span></a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#simulace"><i class="fa fa-check"></i><b>1.3</b> Simulace<span></span></a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#o-modelech"><i class="fa fa-check"></i><b>1.4</b> O modelech<span></span></a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="desc-stats.html"><a href="desc-stats.html"><i class="fa fa-check"></i><b>2</b> Popisná statistika<span></span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="desc-stats.html"><a href="desc-stats.html#central-tend"><i class="fa fa-check"></i><b>2.1</b> Míry centrální tendence<span></span></a></li>
<li class="chapter" data-level="2.2" data-path="desc-stats.html"><a href="desc-stats.html#desc-vars"><i class="fa fa-check"></i><b>2.2</b> Míry rozptýlenosti<span></span></a></li>
<li class="chapter" data-level="2.3" data-path="desc-stats.html"><a href="desc-stats.html#kvantily"><i class="fa fa-check"></i><b>2.3</b> Míry polohy<span></span></a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="prob-dist.html"><a href="prob-dist.html"><i class="fa fa-check"></i><b>3</b> Pravděpodobnostní rozdělení<span></span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="prob-dist.html"><a href="prob-dist.html#stats-lang"><i class="fa fa-check"></i><b>3.1</b> Pravděpodobnostní rozdělení jako jazyk statistiky<span></span></a></li>
<li class="chapter" data-level="3.2" data-path="prob-dist.html"><a href="prob-dist.html#binom-dist"><i class="fa fa-check"></i><b>3.2</b> Binomické<span></span></a></li>
<li class="chapter" data-level="3.3" data-path="prob-dist.html"><a href="prob-dist.html#norm-dist"><i class="fa fa-check"></i><b>3.3</b> Normální<span></span></a></li>
<li class="chapter" data-level="3.4" data-path="prob-dist.html"><a href="prob-dist.html#t-dist"><i class="fa fa-check"></i><b>3.4</b> T<span></span></a></li>
<li class="chapter" data-level="3.5" data-path="prob-dist.html"><a href="prob-dist.html#unif-dist"><i class="fa fa-check"></i><b>3.5</b> Uniformní<span></span></a></li>
<li class="chapter" data-level="3.6" data-path="prob-dist.html"><a href="prob-dist.html#pois-dist"><i class="fa fa-check"></i><b>3.6</b> Poisson<span></span></a></li>
<li class="chapter" data-level="3.7" data-path="prob-dist.html"><a href="prob-dist.html#chi-kvadrát"><i class="fa fa-check"></i><b>3.7</b> Chi-kvadrát<span></span></a></li>
<li class="chapter" data-level="3.8" data-path="prob-dist.html"><a href="prob-dist.html#jak-vybrat-správný-model-pro-data"><i class="fa fa-check"></i><b>3.8</b> Jak vybrat správný model pro data<span></span></a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="dist-params.html"><a href="dist-params.html"><i class="fa fa-check"></i><b>4</b> Výběrové rozdělení parametrů<span></span></a>
<ul>
<li class="chapter" data-level="4.1" data-path="dist-params.html"><a href="dist-params.html#clv-procento"><i class="fa fa-check"></i><b>4.1</b> Relativní četnost<span></span></a></li>
<li class="chapter" data-level="4.2" data-path="dist-params.html"><a href="dist-params.html#clv-is"><i class="fa fa-check"></i><b>4.2</b> Interval spolehlivosti<span></span></a></li>
<li class="chapter" data-level="4.3" data-path="dist-params.html"><a href="dist-params.html#bootstrap"><i class="fa fa-check"></i><b>4.3</b> Bootstrap<span></span></a></li>
<li class="chapter" data-level="4.4" data-path="dist-params.html"><a href="dist-params.html#clv-mean"><i class="fa fa-check"></i><b>4.4</b> Průměr<span></span></a></li>
<li class="chapter" data-level="4.5" data-path="dist-params.html"><a href="dist-params.html#rozptyl"><i class="fa fa-check"></i><b>4.5</b> Rozptyl<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="stats-test-single.html"><a href="stats-test-single.html"><i class="fa fa-check"></i><b>5</b> Statistické testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1" data-path="stats-test-single.html"><a href="stats-test-single.html#postup-statistického-testování"><i class="fa fa-check"></i><b>5.1</b> Postup statistického testování<span></span></a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="stats-test-single.html"><a href="stats-test-single.html#zvolení-testu"><i class="fa fa-check"></i><b>5.1.1</b> Zvolení testu<span></span></a></li>
<li class="chapter" data-level="5.1.2" data-path="stats-test-single.html"><a href="stats-test-single.html#test-h0"><i class="fa fa-check"></i><b>5.1.2</b> Formulace nulové a alternativní hypotézy<span></span></a></li>
<li class="chapter" data-level="5.1.3" data-path="stats-test-single.html"><a href="stats-test-single.html#test-t-statistika"><i class="fa fa-check"></i><b>5.1.3</b> Výpočet testovací statistiky<span></span></a></li>
<li class="chapter" data-level="5.1.4" data-path="stats-test-single.html"><a href="stats-test-single.html#interpretace-výsledku"><i class="fa fa-check"></i><b>5.1.4</b> Interpretace výsledku<span></span></a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-účinku"><i class="fa fa-check"></i><b>5.2</b> Velikost účinku<span></span></a></li>
<li class="chapter" data-level="5.3" data-path="stats-test-single.html"><a href="stats-test-single.html#souvislost-s-intervalem-spolehlivosti"><i class="fa fa-check"></i><b>5.3</b> Souvislost s intervalem spolehlivosti<span></span></a></li>
<li class="chapter" data-level="5.4" data-path="stats-test-single.html"><a href="stats-test-single.html#test-power"><i class="fa fa-check"></i><b>5.4</b> Síla testu<span></span></a></li>
<li class="chapter" data-level="5.5" data-path="stats-test-single.html"><a href="stats-test-single.html#velikost-výběru"><i class="fa fa-check"></i><b>5.5</b> Velikost výběru<span></span></a></li>
<li class="chapter" data-level="5.6" data-path="stats-test-single.html"><a href="stats-test-single.html#tests-many"><i class="fa fa-check"></i><b>5.6</b> Mnoho testů<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html"><i class="fa fa-check"></i><b>6</b> Porovnání dvou průměrů a relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="6.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#průměry"><i class="fa fa-check"></i><b>6.1</b> Průměry<span></span></a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#t2-test-ind"><i class="fa fa-check"></i><b>6.1.1</b> Dva nezávislé výběry<span></span></a></li>
<li class="chapter" data-level="6.1.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#dva-závislé-výběry"><i class="fa fa-check"></i><b>6.1.2</b> Dva závislé výběry<span></span></a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="porovnání-dvou-průměrů-a-relativních-četností.html"><a href="porovnání-dvou-průměrů-a-relativních-četností.html#relativní-četnosti"><i class="fa fa-check"></i><b>6.2</b> Relativní četnosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html"><i class="fa fa-check"></i><b>7</b> Porovnání více relativních četností<span></span></a>
<ul>
<li class="chapter" data-level="7.1" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#test-dobré-shody"><i class="fa fa-check"></i><b>7.1</b> Test dobré shody<span></span></a></li>
<li class="chapter" data-level="7.2" data-path="porovnání-více-relativních-četností.html"><a href="porovnání-více-relativních-četností.html#chi-kvadrát-test-nezávislosti"><i class="fa fa-check"></i><b>7.2</b> Chi-kvadrát test nezávislosti<span></span></a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html"><i class="fa fa-check"></i><b>8</b> Porovnání více průměrů<span></span></a>
<ul>
<li class="chapter" data-level="8.1" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#problém-více-testů"><i class="fa fa-check"></i><b>8.1</b> Problém více testů<span></span></a></li>
<li class="chapter" data-level="8.2" data-path="porovnání-více-průměrů.html"><a href="porovnání-více-průměrů.html#anova"><i class="fa fa-check"></i><b>8.2</b> ANOVA<span></span></a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="korelace.html"><a href="korelace.html"><i class="fa fa-check"></i><b>9</b> Korelace<span></span></a>
<ul>
<li class="chapter" data-level="9.1" data-path="korelace.html"><a href="korelace.html#kovariance"><i class="fa fa-check"></i><b>9.1</b> Kovariance<span></span></a></li>
<li class="chapter" data-level="9.2" data-path="korelace.html"><a href="korelace.html#korelační-koeficient"><i class="fa fa-check"></i><b>9.2</b> Korelační koeficient<span></span></a></li>
<li class="chapter" data-level="9.3" data-path="korelace.html"><a href="korelace.html#statistické-testování-a-interval-spolehlivosti"><i class="fa fa-check"></i><b>9.3</b> Statistické testování a interval spolehlivosti<span></span></a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a>
<a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/4.0/88x31.png" /></a><br />Tato kniha podléhá <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/">Creative Commons Attribution-NonCommercial 4.0 International License</a>.
</li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Úvod do statistiky</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stats-test-single" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Kapitola 5</span> Statistické testování<a href="stats-test-single.html#stats-test-single" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Statistické testy tvoří základní kámen moderní vědy. Jsou používány v klinických studiích na určení efektu léku, v A/B testech na určení toho, zda nějaká intervence funguje, nebo v analýze výběrových šetření na určení toho, zda je nějaký vztah důsledkem náhody. V Popperově filozofii vědeckého poznání jsou statistické testy používány k falzifikaci vědeckých teorií<a href="#fn23" class="footnote-ref" id="fnref23"><sup>23</sup></a>.</p>
<p>Statistické testování zahrnuje soubor různých testů podle problému, který se snažíme vyřešit a podle proměnné, kterou používáme. My si v této kapitole na příkladu jednovýběrového t-testu pro průměr ukážeme principy statistického testování, které platí i pro další typy statistických testů. Výběr testu záleží na problému a hypotéze, kterou jsme pro daný výzkumný problém stanovili. Z matematického hlediska nebude v této kapitole mnoho nového. Budeme využívat znalostí o výběrovém rozdělení parametru (viz <a href="dist-params.html#dist-params">4</a>) a pouze ho uvedme do kontextu statistického testu.</p>
<div id="postup-statistického-testování" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Postup statistického testování<a href="stats-test-single.html#postup-statistického-testování" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Každý statistický test má čtyři fáze:</p>
<ol style="list-style-type: decimal">
<li>zvolení testu podle výzkumné otázky a typu dat,</li>
<li>formulace nulové <span class="math inline">\(H_0\)</span> a alternativní <span class="math inline">\(H_1\)</span> hypotézy,</li>
<li>výpočet testovací statistiky</li>
<li>interpretace výsledku</li>
</ol>
<div id="zvolení-testu" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Zvolení testu<a href="stats-test-single.html#zvolení-testu" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Pro toto cvičení budeme používat jednovýběrový t-test pro průměr. Tedy, budeme testovat hodnotu průměru jednoho výběru. Bude nás zajímat průměrná doba, kterou dospělí jedinci v České republice stráví denně na internetu (v minutách). Následující data pocházejí z European Social Study, která byla provedena v roce 2018. První sloupec obsahuje id respondenta a druhý počet minut kolik strávil denně na internetu. Pojďme se podívat na data.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="stats-test-single.html#cb78-1" aria-hidden="true" tabindex="-1"></a>ess <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;https://raw.githubusercontent.com/schubertjan/uvod-do-statistiky/master/dats/int_use.csv&quot;</span>)</span>
<span id="cb78-2"><a href="stats-test-single.html#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(ess)</span></code></pre></div>
<pre><code>##       idno       int_use_day_mins
##  Min.   : 8403   Min.   : 60.0   
##  1st Qu.:15605   1st Qu.: 97.5   
##  Median :26020   Median :127.5   
##  Mean   :32457   Mean   :147.1   
##  3rd Qu.:50716   3rd Qu.:172.5   
##  Max.   :63736   Max.   :300.0   
##                  NA&#39;s   :6</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="stats-test-single.html#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># odstranit chybejici hodnoty</span></span>
<span id="cb80-2"><a href="stats-test-single.html#cb80-2" aria-hidden="true" tabindex="-1"></a>ess_bez_na <span class="ot">&lt;-</span> ess[<span class="sc">!</span><span class="fu">is.na</span>(ess<span class="sc">$</span>int_use_day_mins), ]</span>
<span id="cb80-3"><a href="stats-test-single.html#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins,</span>
<span id="cb80-4"><a href="stats-test-single.html#cb80-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb80-5"><a href="stats-test-single.html#cb80-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb80-6"><a href="stats-test-single.html#cb80-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Počet min na internetu (týdně)&quot;</span>,</span>
<span id="cb80-7"><a href="stats-test-single.html#cb80-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;Četnost&quot;</span></span>
<span id="cb80-8"><a href="stats-test-single.html#cb80-8" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:tests-hist"></span>
<img src="book_files/figure-html/tests-hist-1.png" alt="Histogram týdenného počtu minut na internetu" width="672" />
<p class="caption">
Graf 5.1: Histogram týdenného počtu minut na internetu
</p>
</div>
<p>Jak je vidět z <a href="stats-test-single.html#fig:tests-hist">5.1</a>, většina lidí tráví na internetu mezi 100 a 150 minutami týdně. Průměrný počet minut na internetu je 147.14. Jak je obvyklé u proměnných, které mají hranici na levé straně<a href="#fn24" class="footnote-ref" id="fnref24"><sup>24</sup></a>, rozložení náhodné proměnné je zešikmené pozitivně, tedy má více odlehlých hodnot na pravo od průměru. Jak ale víme z CLV <a href="dist-params.html#clv-mean">4.4</a> výběrové rozdělení parametru (v našem případě budeme zkoumat průměr) náhodné proměnné bude normálně rozděleno, i když samotná náhodná proměnná normálně rozložená není.</p>
</div>
<div id="test-h0" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Formulace nulové a alternativní hypotézy<a href="stats-test-single.html#test-h0" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>V této fázi formulujeme nulovou a alternativní hypotézu na základě naší výzkumné otázky. Tyto hypotézy formulujeme <strong>vždy před výpočtem testovací statistiky</strong> a vybíráme je tak, aby nám posloužili k možnému vyvrácení vědecké teorie. Technicky nám nic nebrání počítat různé testovací statistiky a poté vybrat tu, která vychází zajímavě, ale tímto způsobem se rychle dostaneme do nebezpečné situace. Statistické testy neslouží k objevování vztahů a proto by se tak neměly používat (viz <a href="stats-test-single.html#tests-many">5.6</a>)! My si ukážeme tři různé nulové hypotézy, abychom si ukázali rozdíl mezi dvojstranným, levostranným a pravostranným testem. Ve reálném výzkumu si ale vybereme pouze takovou hypotézu, které odpovídá výzkumné otázce (a která vychází z vědecké teorie).</p>
<p><strong>Dvojstranná hypotéza</strong></p>
<p><span class="math inline">\(H_0 = 180\)</span></p>
<p><span class="math inline">\(H_1 \neq 180\)</span></p>
<p><strong>Levostranná hypotéza</strong></p>
<p><span class="math inline">\(H_0 \ge 180\)</span></p>
<p><span class="math inline">\(H_1 &lt; 180\)</span></p>
<p><strong>Pravostranná hypotéza</strong></p>
<p><span class="math inline">\(H_0 \le 180\)</span></p>
<p><span class="math inline">\(H_1 &gt; 180\)</span></p>
</div>
<div id="test-t-statistika" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Výpočet testovací statistiky<a href="stats-test-single.html#test-t-statistika" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Výpočet testovací statistiky bude záležet na tom, který test zvolíme. Různé testy májí různé testovací statistiky a proto je důležité u zvoleného testu porozumět tomu, jakou testovací statistiku počítáme. Obecně ale platí, že každá testovací statistika se vypočítá jako <span class="math inline">\(testovaci\;statistika = \frac{bodovy\;odhad - nulova\;hypoteza}{smerodatna\;chyba\;odhadu}\)</span></p>
<p>V našem případě jednovýběrového t-testu pro průměr je naší testovací statistikou t-skór. T-skór vypočítáme jako <span class="math inline">\(t = \frac{\overline{x} - \mu_0}{\frac{s}{\sqrt{n}}}\)</span>, kde <span class="math inline">\(\overline{x}\)</span> je náš výběrový průměr, <span class="math inline">\(\mu_0\)</span> je hodnota z nulové hypotézy a <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span> je směrodatná chyba odhadu. Výběrový průměr spočítáme snadno a směrodatnou chybu odhadu výběrového průměru známe z centrální limitní věty a intervalů spolehlivosti. Testovací statistiku <span class="math inline">\(t\)</span> budeme počítat s <span class="math inline">\(n-1\)</span> stupni volnosti.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="stats-test-single.html#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="co"># testovaci_statistika = bodovy_odhad - nulova_hypoteza / smerodatna_chyba_odhadu</span></span>
<span id="cb81-2"><a href="stats-test-single.html#cb81-2" aria-hidden="true" tabindex="-1"></a>bodovy_odhad <span class="ot">&lt;-</span> <span class="fu">mean</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins)</span>
<span id="cb81-3"><a href="stats-test-single.html#cb81-3" aria-hidden="true" tabindex="-1"></a>nulova_hypoteza <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb81-4"><a href="stats-test-single.html#cb81-4" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ess_bez_na)</span>
<span id="cb81-5"><a href="stats-test-single.html#cb81-5" aria-hidden="true" tabindex="-1"></a>smerodatna_chyba_odhadu <span class="ot">&lt;-</span> <span class="fu">sd</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins) <span class="sc">/</span> <span class="fu">sqrt</span>(n)</span>
<span id="cb81-6"><a href="stats-test-single.html#cb81-6" aria-hidden="true" tabindex="-1"></a>testovaci_statistika <span class="ot">&lt;-</span> (bodovy_odhad <span class="sc">-</span> nulova_hypoteza) <span class="sc">/</span> smerodatna_chyba_odhadu</span></code></pre></div>
<p>Bodový odhad je výběrov průměr <span class="math inline">\(\overline{x}=\)</span> 147.14. Směrodatná chyba odhadu <span class="math inline">\(s_{\overline{x}}=\)</span> 19.33. Testovací statistika je <span class="math inline">\(t=\)</span> -1.7.</p>
<p>U každého statistického testu si zvolíme nějakou kritickou mez, která je určena chybou I. druhu <span class="math inline">\(\alpha\)</span>. <span class="math inline">\(\alpha\)</span> nám udává pravděpodobnost, že nesprávně zamítneme nulovou hypotézu. Konvenčně se udává hladina <span class="math inline">\(\alpha = 0.05\)</span>, ale my si zvolíme nějakou jinou, například <span class="math inline">\(\alpha=0.11\)</span>, abychom si ukázali, že tato hladina je do jisté míry arbitrární a záleží na více věcech (jako je síla testu, typ chyby, kterou chcete akceptovat - I.druhu vs II.druhu. Více viz <a href="stats-test-single.html#test-power">5.4</a>). Protože t-skór pochází ze studentova t standardního rozdělení s <span class="math inline">\(n-1\)</span> stupni volnosti, můžeme ho vypočítat pomocí funkcí, které již známe (stejně jako jsme určovali u intervalů spolehlivosti). Kritická mez bude záležet na typu nulové a alternativní hypotézy. Pojďme si ukázat, jak bude kritická mez vypadat na grafu rozdělení testovací statistiky za předpokladu <span class="math inline">\(H_0\)</span>. Zároveň si do grafu zakreslíme hodnotu naší testovací statistiky.</p>
</div>
<div id="interpretace-výsledku" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Interpretace výsledku<a href="stats-test-single.html#interpretace-výsledku" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Modrá vertikální přímka značí kritickou mez, za kterou bychom zamítali <span class="math inline">\(H_0\)</span>. Modrý region pak značí region, kde zamítáme <span class="math inline">\(H_0\)</span>. Pokud se testovací statistika nachází v tomto regionu, zamítáme <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>. V opačném případě <span class="math inline">\(H_0\)</span> zamítnout nemůžeme. Graf <a href="stats-test-single.html#fig:tests-inter-left">5.2</a> ukazuje výběrové rozdělení průměru za předpokladu <span class="math inline">\(H_0\)</span> pro levostranný test, graf <a href="stats-test-single.html#fig:tests-inter-right">5.3</a> ukazuje výběrové rozdělení průměru za předpokladu platnosti <span class="math inline">\(H_0\)</span> pro pravostranný test a <a href="stats-test-single.html#fig:tests-inter-both">5.4</a> ukazuje výběrové rozdělení průměru za předpokladu platnosti <span class="math inline">\(H_0\)</span> pro oboustranný test.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="stats-test-single.html#cb82-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.11</span></span>
<span id="cb82-2"><a href="stats-test-single.html#cb82-2" aria-hidden="true" tabindex="-1"></a>kritickou_mez_levostranny <span class="ot">&lt;-</span> <span class="fu">qt</span>(alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb82-3"><a href="stats-test-single.html#cb82-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb82-4"><a href="stats-test-single.html#cb82-4" aria-hidden="true" tabindex="-1"></a>pdf <span class="ot">&lt;-</span> <span class="fu">dt</span>(x, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb82-5"><a href="stats-test-single.html#cb82-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-6"><a href="stats-test-single.html#cb82-6" aria-hidden="true" tabindex="-1"></a><span class="co"># levostranna</span></span>
<span id="cb82-7"><a href="stats-test-single.html#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb82-8"><a href="stats-test-single.html#cb82-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Výběrový průměr (standardizovaný)&quot;</span>,</span>
<span id="cb82-9"><a href="stats-test-single.html#cb82-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb82-10"><a href="stats-test-single.html#cb82-10" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb82-11"><a href="stats-test-single.html#cb82-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb82-12"><a href="stats-test-single.html#cb82-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb82-13"><a href="stats-test-single.html#cb82-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-14"><a href="stats-test-single.html#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x <span class="sc">&lt;</span> kritickou_mez_levostranny], pdf[x <span class="sc">&lt;</span> kritickou_mez_levostranny],</span>
<span id="cb82-15"><a href="stats-test-single.html#cb82-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb82-16"><a href="stats-test-single.html#cb82-16" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb82-17"><a href="stats-test-single.html#cb82-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb82-18"><a href="stats-test-single.html#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> kritickou_mez_levostranny, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>)</span>
<span id="cb82-19"><a href="stats-test-single.html#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> testovaci_statistika, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:tests-inter-left"></span>
<img src="book_files/figure-html/tests-inter-left-1.png" alt="Rozdělení výběrového průměru za platnosti H0: levostranný" width="672" />
<p class="caption">
Graf 5.2: Rozdělení výběrového průměru za platnosti H0: levostranný
</p>
</div>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="stats-test-single.html#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pravostrannou</span></span>
<span id="cb83-2"><a href="stats-test-single.html#cb83-2" aria-hidden="true" tabindex="-1"></a>kritickou_mez_pravostranny <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="dv">1</span> <span class="sc">-</span> alpha, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb83-3"><a href="stats-test-single.html#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb83-4"><a href="stats-test-single.html#cb83-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Výběrový průměr (standardizovaný)&quot;</span>,</span>
<span id="cb83-5"><a href="stats-test-single.html#cb83-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb83-6"><a href="stats-test-single.html#cb83-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb83-7"><a href="stats-test-single.html#cb83-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb83-8"><a href="stats-test-single.html#cb83-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb83-9"><a href="stats-test-single.html#cb83-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-10"><a href="stats-test-single.html#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x <span class="sc">&gt;</span> kritickou_mez_pravostranny], pdf[x <span class="sc">&gt;</span> kritickou_mez_pravostranny],</span>
<span id="cb83-11"><a href="stats-test-single.html#cb83-11" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb83-12"><a href="stats-test-single.html#cb83-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb83-13"><a href="stats-test-single.html#cb83-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb83-14"><a href="stats-test-single.html#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> kritickou_mez_pravostranny, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>)</span>
<span id="cb83-15"><a href="stats-test-single.html#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> testovaci_statistika, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:tests-inter-right"></span>
<img src="book_files/figure-html/tests-inter-right-1.png" alt="Rozdělení výběrového průměru za platnosti H0: pravostranný" width="672" />
<p class="caption">
Graf 5.3: Rozdělení výběrového průměru za platnosti H0: pravostranný
</p>
</div>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="stats-test-single.html#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># oboustranny</span></span>
<span id="cb84-2"><a href="stats-test-single.html#cb84-2" aria-hidden="true" tabindex="-1"></a>kritickou_mez_oboustranny <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="fu">c</span>(alpha <span class="sc">/</span> <span class="dv">2</span>, <span class="dv">1</span> <span class="sc">-</span> alpha <span class="sc">/</span> <span class="dv">2</span>), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb84-3"><a href="stats-test-single.html#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf,</span>
<span id="cb84-4"><a href="stats-test-single.html#cb84-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Výběrový průměr (standardizovaný)&quot;</span>,</span>
<span id="cb84-5"><a href="stats-test-single.html#cb84-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb84-6"><a href="stats-test-single.html#cb84-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="st">&quot;&quot;</span>,</span>
<span id="cb84-7"><a href="stats-test-single.html#cb84-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>,</span>
<span id="cb84-8"><a href="stats-test-single.html#cb84-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;grey&quot;</span></span>
<span id="cb84-9"><a href="stats-test-single.html#cb84-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-10"><a href="stats-test-single.html#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x[x <span class="sc">&lt;</span> kritickou_mez_oboustranny[<span class="dv">1</span>] <span class="sc">|</span> x <span class="sc">&gt;</span> kritickou_mez_oboustranny[<span class="dv">2</span>]],</span>
<span id="cb84-11"><a href="stats-test-single.html#cb84-11" aria-hidden="true" tabindex="-1"></a>     pdf[x <span class="sc">&lt;</span> kritickou_mez_oboustranny[<span class="dv">1</span>] <span class="sc">|</span> x <span class="sc">&gt;</span> kritickou_mez_oboustranny[<span class="dv">2</span>]],</span>
<span id="cb84-12"><a href="stats-test-single.html#cb84-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>,</span>
<span id="cb84-13"><a href="stats-test-single.html#cb84-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span></span>
<span id="cb84-14"><a href="stats-test-single.html#cb84-14" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb84-15"><a href="stats-test-single.html#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> kritickou_mez_oboustranny, <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>)</span>
<span id="cb84-16"><a href="stats-test-single.html#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> testovaci_statistika, <span class="at">lty =</span> <span class="dv">2</span>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:tests-inter-both"></span>
<img src="book_files/figure-html/tests-inter-both-1.png" alt="Rozdělení výběrového průměru za platnosti H0: oboustranný" width="672" />
<p class="caption">
Graf 5.4: Rozdělení výběrového průměru za platnosti H0: oboustranný
</p>
</div>
<p>Při oboustranné hypotéze: <span class="math inline">\(H_0 = 180\)</span> a tedy <span class="math inline">\(H_1 \neq 180\)</span>, je kritické mez +/- 1.715361 Naše testovací statistika má hodnotu -1.6994055 a není tedy menší než kritické mez. V takovém případě bychom <strong>nezamítali</strong> <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>.</p>
<p>Při levostranné hypotéze: <span class="math inline">\(H_0 \ge 180\)</span> a <span class="math inline">\(H_1 &lt; 180\)</span> je kritické mez -1.288595. Testovací statistika je menší než tato kritická hodnota a my proto <strong>zamítáme</strong> <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>.</p>
<p>Při pravostranné hypotéze: <span class="math inline">\(H_0 \le 180\)</span> a <span class="math inline">\(H_1 &gt; 180\)</span> je kritické mez 1.288595. Testovací statistika je menší než tato kritická hodnota a my proto <strong>nezamítáme</strong> <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>.</p>
<p>Abychom nemuseli stále počítat hodnoty kritické meze, které se mohou lišit v závislosti na rozdělení výběrové statistiky a chybě prvního druhu (<span class="math inline">\(alpha\)</span>), používá se tzv p-hodnota, což vyjadřuje pravděpodobnost, že uvidíme pozorovanou hodnotu nebo ještě extrémnější (za předpokladu <span class="math inline">\(H_0\)</span>). P-hodnotu můžeme vypočítat jako distribuční funkci (CDF) podle toho, jaký typ <span class="math inline">\(H_0\)</span> jsme zvolili.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="stats-test-single.html#cb85-1" aria-hidden="true" tabindex="-1"></a>p_levostranny <span class="ot">&lt;-</span> <span class="fu">pt</span>(testovaci_statistika, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb85-2"><a href="stats-test-single.html#cb85-2" aria-hidden="true" tabindex="-1"></a>p_pravostranny <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(testovaci_statistika, <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb85-3"><a href="stats-test-single.html#cb85-3" aria-hidden="true" tabindex="-1"></a>p_oboustrany <span class="ot">&lt;-</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pt</span>(<span class="fu">abs</span>(testovaci_statistika), <span class="at">df =</span> n <span class="sc">-</span> <span class="dv">1</span>)) <span class="sc">*</span> <span class="dv">2</span></span></code></pre></div>
<p>P-hodnota levostranného testu při alpha 0.11 je 0.06. P-hodnota pravostranného testu při alpha 0.11 je 0.94. P-hodnota oboustranného testu při alpha 0.11 je 0.11.</p>
<p>Vidíme, že hodnota p je menší, než zvolená <span class="math inline">\(\alpha\)</span> pouze u levostranného testu, takže bychom zde zamítli <span class="math inline">\(H_0\)</span> ve prospěch <span class="math inline">\(H_1\)</span>. Jak vidíme, výsledek se shoduje s porovnáním testovací statistiky k vypočtené kritické hladině. Výhodou je, že můžeme výpočet kritické hladiny přeskočit, rovnou vypočítat p-hodnotu a porovnat k námi zvolené <span class="math inline">\(\alpha\)</span>.</p>
<p>Ještě je důležité dodat, že pokud nemůžeme zamítnout <span class="math inline">\(H_0\)</span>, tak to neznamená, že hodnota parametru v populaci se rovná <span class="math inline">\(H_0\)</span><a href="#fn25" class="footnote-ref" id="fnref25"><sup>25</sup></a>. Znamená to pouze, že v našich datech neexistuje dostatek evidence k tomu, abychom mohli na hladině spolehlivosti <span class="math inline">\(1-\alpha\)</span> řící, zda je výběrový parametr odlišný od <span class="math inline">\(H_0\)</span>.</p>
<p>Pokud byste chtěli počítat jednovýběrový z-test pro průměr místo t-testu, pouze nahradíte rozdělení výběrového průměru za normální rozdělení (z-test ještě dále předpokládá, že známe populační rozptyl <span class="math inline">\(\sigma\)</span>). V praxi ale můžete použít t-test, protože víme, že při vetším počtu pozorování (<span class="math inline">\(n&gt;50\)</span>) se t-rozdělení velmi podobá normálnímu.</p>
<p>V R existuje na vypočítání t-testu funkce <code>t.test</code>, který má argumenty <code>x</code> náhodnou proměnnou, kterou testujeme, <code>alternative</code> určení typu <span class="math inline">\(H_0\)</span> a <span class="math inline">\(H_1\)</span>, <code>conf.level</code> určení spolehlivosti testu a <code>mu</code> hodnotu <span class="math inline">\(H_0\)</span>, vůči které test provádíme.</p>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="stats-test-single.html#cb86-1" aria-hidden="true" tabindex="-1"></a>t_test_levostranna <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins,</span>
<span id="cb86-2"><a href="stats-test-single.html#cb86-2" aria-hidden="true" tabindex="-1"></a>     <span class="at">alternative =</span> <span class="st">&quot;less&quot;</span>,</span>
<span id="cb86-3"><a href="stats-test-single.html#cb86-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha,</span>
<span id="cb86-4"><a href="stats-test-single.html#cb86-4" aria-hidden="true" tabindex="-1"></a>     <span class="at">mu =</span> nulova_hypoteza</span>
<span id="cb86-5"><a href="stats-test-single.html#cb86-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-6"><a href="stats-test-single.html#cb86-6" aria-hidden="true" tabindex="-1"></a>t_test_pravostranny <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins,</span>
<span id="cb86-7"><a href="stats-test-single.html#cb86-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">alternative =</span> <span class="st">&quot;greater&quot;</span>,</span>
<span id="cb86-8"><a href="stats-test-single.html#cb86-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha,</span>
<span id="cb86-9"><a href="stats-test-single.html#cb86-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">mu =</span> nulova_hypoteza</span>
<span id="cb86-10"><a href="stats-test-single.html#cb86-10" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb86-11"><a href="stats-test-single.html#cb86-11" aria-hidden="true" tabindex="-1"></a>t_test_oboustranny <span class="ot">&lt;-</span> <span class="fu">t.test</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins,</span>
<span id="cb86-12"><a href="stats-test-single.html#cb86-12" aria-hidden="true" tabindex="-1"></a>     <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb86-13"><a href="stats-test-single.html#cb86-13" aria-hidden="true" tabindex="-1"></a>     <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha,</span>
<span id="cb86-14"><a href="stats-test-single.html#cb86-14" aria-hidden="true" tabindex="-1"></a>     <span class="at">mu =</span> nulova_hypoteza</span>
<span id="cb86-15"><a href="stats-test-single.html#cb86-15" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
</div>
<div id="velikost-účinku" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Velikost účinku<a href="stats-test-single.html#velikost-účinku" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Statistické testování nám prozradí pouze směr účinku naší hypotézy, nikoliv však její sílu/efekt. K tomu nám slouží Cohenovo d. Vypočítá se jako <span class="math inline">\(d = \frac{|(bodovy\;odhad - H_0)|}{smerodatna\;odchylka\;mereni}\)</span>. Všimněte si, že <span class="math inline">\(d\)</span> je vlastně standardizovaným rozdílem mezi bodovým odhadem a <span class="math inline">\(H_0\)</span>. Obecně se udává následující síly účinku pro hodnoty <span class="math inline">\(d\)</span>:</p>
<table>
<thead>
<tr class="header">
<th>&lt; 0.2</th>
<th>0.2 - 0.5</th>
<th>0.5 - 0.8</th>
<th>0.8 - 1.2</th>
<th>&gt; 1.2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>velmi malý</td>
<td>malý efekt</td>
<td>střední efekt</td>
<td>velký efekt</td>
<td>velmi velky</td>
</tr>
</tbody>
</table>
<p>Pro náši úlohu by se <span class="math inline">\(d\)</span> vypočítalo jako:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="stats-test-single.html#cb87-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">abs</span>(bodovy_odhad <span class="sc">-</span> nulova_hypoteza) <span class="sc">/</span> <span class="fu">sd</span>(ess_bez_na<span class="sc">$</span>int_use_day_mins)</span></code></pre></div>
<p>Velikost účinku je 0.45, což odpovídá spíše malému efektu.</p>
</div>
<div id="souvislost-s-intervalem-spolehlivosti" class="section level2 hasAnchor" number="5.3">
<h2><span class="header-section-number">5.3</span> Souvislost s intervalem spolehlivosti<a href="stats-test-single.html#souvislost-s-intervalem-spolehlivosti" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Konstrukt intervalu spolehlivosti a statistických testů vychází ze stejné matematické teorie a to sice, že nejistota ohledně bodového výběrového odhadu se dá modelovat pomocí standardní chyby odhadu <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>. Graf <a href="stats-test-single.html#fig:test-h0-is">5.5</a> ukazuje výběrové rozdělení průměru, které jsme počítali v <a href="dist-params.html#dist-params">4</a> a výběrové rozdělení za platnosti <span class="math inline">\(H_0\)</span>. Všimněte si, že p-hodnota je vlastně <span class="math inline">\(P(x_i \le \overline{x})\)</span> za platnosti H0. Tedy, pokud platí rozdělení parametru za H0 (pokud je průměr roven naší <span class="math inline">\(H_0\)</span>), jaká je pravděpodobnost, že bychom v našem výběru sledovali tuto hodnotu nebo extrémnější. Matematicky to je tento výpočet stejný, jako levostranný test, který jsme počítali nahoře<a href="#fn26" class="footnote-ref" id="fnref26"><sup>26</sup></a>. Statistické testování tedy z matematického hlediska nepřináší žádné nové koncepty a používá teorii CLV <a href="dist-params.html#dist-params">4</a> a pravděpodobnostních rozdělení <a href="prob-dist.html#norm-dist">3.3</a>.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="stats-test-single.html#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame vyberove rozdeleni parametru...</span></span>
<span id="cb88-2"><a href="stats-test-single.html#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ..pomoci zobecneneho t rozdeleni</span></span>
<span id="cb88-3"><a href="stats-test-single.html#cb88-3" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">80</span>, <span class="dv">250</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb88-4"><a href="stats-test-single.html#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="co"># stpne volnosti</span></span>
<span id="cb88-5"><a href="stats-test-single.html#cb88-5" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">nrow</span>(ess_bez_na) <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb88-6"><a href="stats-test-single.html#cb88-6" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame pdf</span></span>
<span id="cb88-7"><a href="stats-test-single.html#cb88-7" aria-hidden="true" tabindex="-1"></a>pdf_vyber <span class="ot">&lt;-</span> <span class="fu">dt</span>((x <span class="sc">-</span> bodovy_odhad) <span class="sc">/</span> smerodatna_chyba_odhadu,</span>
<span id="cb88-8"><a href="stats-test-single.html#cb88-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">df =</span> df</span>
<span id="cb88-9"><a href="stats-test-single.html#cb88-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">*</span> <span class="dv">1</span> <span class="sc">/</span> smerodatna_chyba_odhadu</span>
<span id="cb88-10"><a href="stats-test-single.html#cb88-10" aria-hidden="true" tabindex="-1"></a>h0 <span class="ot">&lt;-</span> <span class="dv">180</span></span>
<span id="cb88-11"><a href="stats-test-single.html#cb88-11" aria-hidden="true" tabindex="-1"></a><span class="co"># spocitame vyberove rozdeleni za predpokladu H0</span></span>
<span id="cb88-12"><a href="stats-test-single.html#cb88-12" aria-hidden="true" tabindex="-1"></a>pdf_h0 <span class="ot">&lt;-</span> <span class="fu">dt</span>((x <span class="sc">-</span> h0) <span class="sc">/</span> smerodatna_chyba_odhadu,</span>
<span id="cb88-13"><a href="stats-test-single.html#cb88-13" aria-hidden="true" tabindex="-1"></a>             <span class="at">df =</span> df</span>
<span id="cb88-14"><a href="stats-test-single.html#cb88-14" aria-hidden="true" tabindex="-1"></a>) <span class="sc">*</span> <span class="dv">1</span> <span class="sc">/</span> smerodatna_chyba_odhadu</span>
<span id="cb88-15"><a href="stats-test-single.html#cb88-15" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame p hodnotu jako cdf za predpokladu h0</span></span>
<span id="cb88-16"><a href="stats-test-single.html#cb88-16" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> <span class="fu">pt</span>((bodovy_odhad <span class="sc">-</span> h0) <span class="sc">/</span> smerodatna_chyba_odhadu, <span class="at">df =</span> df)</span>
<span id="cb88-17"><a href="stats-test-single.html#cb88-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-18"><a href="stats-test-single.html#cb88-18" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pdf_vyber,</span>
<span id="cb88-19"><a href="stats-test-single.html#cb88-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;Počet min na internetu (týdně)&quot;</span>,</span>
<span id="cb88-20"><a href="stats-test-single.html#cb88-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PDF&quot;</span>,</span>
<span id="cb88-21"><a href="stats-test-single.html#cb88-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb88-22"><a href="stats-test-single.html#cb88-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Za platnosti H0: P(x&lt;&quot;</span>, <span class="fu">round</span>(bodovy_odhad, <span class="dv">2</span>), <span class="st">&quot;)=&quot;</span>, <span class="fu">round</span>(p_hodnota, <span class="dv">2</span>)),</span>
<span id="cb88-23"><a href="stats-test-single.html#cb88-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;l&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span></span>
<span id="cb88-24"><a href="stats-test-single.html#cb88-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb88-25"><a href="stats-test-single.html#cb88-25" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, pdf_h0, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb88-26"><a href="stats-test-single.html#cb88-26" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> bodovy_odhad, <span class="at">lty =</span> <span class="dv">2</span>)</span>
<span id="cb88-27"><a href="stats-test-single.html#cb88-27" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v =</span> h0, <span class="at">lty =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">&quot;grey&quot;</span>)</span>
<span id="cb88-28"><a href="stats-test-single.html#cb88-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-29"><a href="stats-test-single.html#cb88-29" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">&quot;topright&quot;</span>,</span>
<span id="cb88-30"><a href="stats-test-single.html#cb88-30" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend =</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&quot;Výběr. rozděl. průměru; </span><span class="sc">\n</span><span class="st"> T(&quot;</span>, </span>
<span id="cb88-31"><a href="stats-test-single.html#cb88-31" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(bodovy_odhad, <span class="dv">2</span>), <span class="st">&quot;, &quot;</span>, </span>
<span id="cb88-32"><a href="stats-test-single.html#cb88-32" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(smerodatna_chyba_odhadu, <span class="dv">2</span>), <span class="st">&quot;, &quot;</span>,</span>
<span id="cb88-33"><a href="stats-test-single.html#cb88-33" aria-hidden="true" tabindex="-1"></a>                         df, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb88-34"><a href="stats-test-single.html#cb88-34" aria-hidden="true" tabindex="-1"></a>                  <span class="st">&quot;Bodový odhad&quot;</span>,</span>
<span id="cb88-35"><a href="stats-test-single.html#cb88-35" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;Výběr. rozděl. H0; </span><span class="sc">\n</span><span class="st"> T(&quot;</span>, </span>
<span id="cb88-36"><a href="stats-test-single.html#cb88-36" aria-hidden="true" tabindex="-1"></a>                         h0, <span class="st">&quot;, &quot;</span>, </span>
<span id="cb88-37"><a href="stats-test-single.html#cb88-37" aria-hidden="true" tabindex="-1"></a>                         <span class="fu">round</span>(smerodatna_chyba_odhadu, <span class="dv">2</span>),  <span class="st">&quot;, &quot;</span>,</span>
<span id="cb88-38"><a href="stats-test-single.html#cb88-38" aria-hidden="true" tabindex="-1"></a>                         df, <span class="st">&quot;)&quot;</span>), </span>
<span id="cb88-39"><a href="stats-test-single.html#cb88-39" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">paste0</span>(<span class="st">&quot;H0: &quot;</span>, h0)),</span>
<span id="cb88-40"><a href="stats-test-single.html#cb88-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">col =</span> <span class="fu">c</span>(<span class="st">&quot;#1f77b4&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;grey&quot;</span>, <span class="st">&quot;grey&quot;</span>),</span>
<span id="cb88-41"><a href="stats-test-single.html#cb88-41" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>),</span>
<span id="cb88-42"><a href="stats-test-single.html#cb88-42" aria-hidden="true" tabindex="-1"></a>       <span class="at">lty =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb88-43"><a href="stats-test-single.html#cb88-43" aria-hidden="true" tabindex="-1"></a>       <span class="at">cex =</span> <span class="fl">0.7</span></span>
<span id="cb88-44"><a href="stats-test-single.html#cb88-44" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:test-h0-is"></span>
<img src="book_files/figure-html/test-h0-is-1.png" alt="Výběrové rozdělení průměru a výběrové rozdělení za platnosti H0" width="672" />
<p class="caption">
Graf 5.5: Výběrové rozdělení průměru a výběrové rozdělení za platnosti H0
</p>
</div>
</div>
<div id="test-power" class="section level2 hasAnchor" number="5.4">
<h2><span class="header-section-number">5.4</span> Síla testu<a href="stats-test-single.html#test-power" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Proč nezvolit chybu I. druhu <span class="math inline">\(\alpha\)</span> vždy velmi malou, abychom si byli jisti, že pravděpodobnost našich dat při platnosti <span class="math inline">\(H_0\)</span> je velmi malá? K tomu, abychom pochopili, jakou <span class="math inline">\(\alpha\)</span> zvolit si musíme představit i chybu II. druhu <span class="math inline">\(\beta\)</span>. Chyba I. druhu <span class="math inline">\(\alpha\)</span> nám určuje pravděpodobnost, že zamítneme <span class="math inline">\(H_0\)</span>, pokud ve skutečnosti <span class="math inline">\(H_0\)</span> je platná. Někdy se taková chyba označuje jako false positive (FP). Situace, kdy správně zamítneme <span class="math inline">\(H_0\)</span> a ona ve skutečnosti neplatí, se někdy označuje jako tru positive (TP). Teď si představme situaci, v které <span class="math inline">\(H_0\)</span> nezamítneme, ale ona ve skutečnosti neplatí (tedy platí <span class="math inline">\(H_1\)</span>). Takové situace se někdy říká false negative (FN). A právě tuto chybu vyjadřuje chyba II. druhu <span class="math inline">\(\beta\)</span>. Síla testu se vypočítá jako <span class="math inline">\(1-\beta\)</span> a označuje se tedy TP. Síla testu nám říká pravděpodobnost, s kterým test správně určí <span class="math inline">\(H_1\)</span>, pokud ve skutečnosti rozdíl existuje. Tabulka dole ukazuje všechny situace, které mohou nastat a jak se tyto situace vztahují na chyby I. a II. druhu<a href="#fn27" class="footnote-ref" id="fnref27"><sup>27</sup></a>.</p>
<p>Tabulka: Ukázka výsledků testů v zavislosti na skutečnosti.</p>
<table>
<thead>
<tr class="header">
<th></th>
<th></th>
<th>Závěr testu</th>
<th></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><strong>Skutečnost</strong></td>
<td></td>
<td><strong><span class="math inline">\(H_0\)</span> platí</strong></td>
<td><strong><span class="math inline">\(H_0\)</span> neplatí</strong></td>
</tr>
<tr class="even">
<td><strong><span class="math inline">\(H_0\)</span> platí</strong></td>
<td></td>
<td>TN (<span class="math inline">\(1-\alpha\)</span>)</td>
<td>FP (<span class="math inline">\(\alpha\)</span>)</td>
</tr>
<tr class="odd">
<td><strong><span class="math inline">\(H_0\)</span> neplatí</strong></td>
<td></td>
<td>FN (<span class="math inline">\(\beta\)</span>)</td>
<td>TP (<span class="math inline">\(1-\beta\)</span>)</td>
</tr>
</tbody>
</table>
<p>Velikost chyby I. druhu je úměrná chybě II. druhu. Chyba II. druhu nám udává pravděpodobnost, že nezamítneme <span class="math inline">\(H_0\)</span>, pokud ve skutečnosti platí <span class="math inline">\(H_1\)</span>. Aplikace <a href="stats-test-single.html#fig:test-app">5.6</a> ukazuje jak spolu souvisí tyto dvě chyby v případě jednovýběrového z-testu<a href="#fn28" class="footnote-ref" id="fnref28"><sup>28</sup></a>. Graf udává rozdělení parametru za platnosti <span class="math inline">\(H_0\)</span> a rozdělení za platnosti <span class="math inline">\(H_1\)</span>. Červena plocha pod rozdělením <span class="math inline">\(H_0\)</span> ukazuje oblast zamítnutí <span class="math inline">\(H_0\)</span> při platnosti <span class="math inline">\(H_0\)</span> (tedy <span class="math inline">\(\alpha\)</span>) a modrá plocha ukazuje oblast nezamítnutí <span class="math inline">\(H_0\)</span> při platnosti <span class="math inline">\(H_1\)</span>. Jak si můžeme vyzkoušet v aplikaci, při snížení chyby I. druhu <span class="math inline">\(\alpha\)</span>, vzroste chyba II. druhu <span class="math inline">\(\beta\)</span> a naopak. Zároveň si můžeme všimnout, že při zvolení oboustranného testu se chyba II. druhu <span class="math inline">\(\beta\)</span> při stejné <span class="math inline">\(\alpha\)</span> sníží a to z toho důvodu, že posuneme hranici, kde zamítáme <span class="math inline">\(H_0\)</span>. Dále si všimněme, že velikost <span class="math inline">\(\beta\)</span> závisí na standarní chybě odhadu, která určuje šířku obou rozdělení parametru<a href="#fn29" class="footnote-ref" id="fnref29"><sup>29</sup></a>. Čím je standardní chyba odhadu menší, tím je menší <span class="math inline">\(\beta\)</span>. Dále závisí chyba II. druhu <span class="math inline">\(\beta\)</span> na vzdálenosti průměru <span class="math inline">\(H_0\)</span> od <span class="math inline">\(H_1\)</span>. Čím je tato vzdálenost větší, tím je chyba II. menší.</p>
<div class="figure"><span style="display:block;" id="fig:test-app"></span>
<iframe src="https://shiny.rit.albany.edu/stat/betaprob/?showcase=0" width="672" height="400px" data-external="1">
</iframe>
<p class="caption">
Graf 5.6: Ukázka závislosti chyby I. a II. druhu. Zdroj: <a href="https://shiny.rit.albany.edu/stat/betaprob/" class="uri">https://shiny.rit.albany.edu/stat/betaprob/</a>
</p>
</div>
<p>Jakým způsobem vybrat velikost <span class="math inline">\(\alpha\)</span> bude záležet na problému, v kterém test provádíme. Jaké důsledky má chyba I. druhu (FP) a chyba II.druhu (FN)? Co hrozí pokud na základě testu rozhodneme určíme špatně, že něco je pravda, pokud to ve skutečnosti pravda není (FP) a co hrozí, pokud určíme špatně, že něco pravda není, pokud to ve skutečnosti pravda je (FN)? To, jak závažné důsledky mají FP a FN závisí na situaci, v které test aplikujeme. Uvažujme příklad, kdy pacientovy odebereme vzorky krve a sledujeme hodnoty určitých látek. Na základě statistického testu potom vyhodnotíme, zda množství látek indikuje nějakou nemoc. Důsledek FP je, že pacientovi řekneme, že má nemoc, pokud ji ve skutečnosti nemá. Pokud léčení takové nemoci není nákladné a nemá žádné vedlejší účinky, pak se nic tak velkého nestalo. Důsledek FN ve stejném příkladu znamená, že pacientovi řekneme, že nemoc nemá, ale on ji ve skutečnosti má. Pokud má nemoc závažné důsledky, pak může taková chyba způsobit pacientovi závažné zdravotní komplikace. V takovém případě bychom chtěli, aby chyba FN (<span class="math inline">\(\beta\)</span>) byla poměrně malá. Nyní si představme situaci, v které používáme statistický test, abychom určili, zda někdo podvádí ve výkazu nákladů na pracovní cestu. Na kontrolu máme zhruba 14 dní, protože náklady musíme zaměstnanci uhradit v příští výplatě. Řekněme, že testujeme určitou kombinaci čísel, které se ve výkazu opakují. Pokud označíme nějaké daňové přiznání za podvodné, musíme podrobně zkontrolovat všechny faktury a účtenky v daném výkazu a to je velmi pracné. Protože máme jenom omezený počet dní, v kterých můžeme výkazy kontrolovat, budume chtít, abychom si byli docela jisti, že někdo podvádí. V takovém případě je důsledek FP velmi náročný na čas a budeme se proto snažit <span class="math inline">\(\alpha\)</span> určit tak, aby nebylo mnoho FP.</p>
</div>
<div id="velikost-výběru" class="section level2 hasAnchor" number="5.5">
<h2><span class="header-section-number">5.5</span> Velikost výběru<a href="stats-test-single.html#velikost-výběru" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Teorii statistického testování můžeme využít při designu výzkumu k tomu, abychom stanovili nutnou velikost výběru. Vycházíme přitom z toho, že velikost výběru je jednou z proměnných při výpočtu směrodatné chyby odhadu parametru <span class="math inline">\(\frac{s}{\sqrt{n}}\)</span>. Zpravidla stanovíme, jakou chybu odhadu jsme schopni akceptovat <span class="math inline">\(\delta\)</span> a podle toho určíme velikost výběru <span class="math inline">\(n\)</span>. Velikost výběru potom vypočítáme jako <span class="math inline">\(n=(\frac{z_{1-\alpha} * \sigma}{\delta})^2\)</span>, tedy jako hodnotu kvantilu <span class="math inline">\(z\)</span> rozdělení na hladině spolehlivosti <span class="math inline">\(1-\alpha\)</span> vynásobenou populační směrodatnou odchylkou náhodné proměnné <span class="math inline">\(\sigma\)</span>. Pokud populační směrodatnou odchylku neznáme, můžeme ji odhadnout pomocí dostupných znalostí o zkoumané proměnné, nebo simulovat různá rozdělení a vybrat takové <span class="math inline">\(s\)</span>, které nejvíce odpovídá našim předpokladům.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="stats-test-single.html#cb89-1" aria-hidden="true" tabindex="-1"></a>delta <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb89-2"><a href="stats-test-single.html#cb89-2" aria-hidden="true" tabindex="-1"></a>smer_odchylka <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fl">0.05</span> <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fl">0.05</span>))</span>
<span id="cb89-3"><a href="stats-test-single.html#cb89-3" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">qnorm</span>(<span class="fl">0.975</span>)</span>
<span id="cb89-4"><a href="stats-test-single.html#cb89-4" aria-hidden="true" tabindex="-1"></a><span class="co"># vypocitame n</span></span>
<span id="cb89-5"><a href="stats-test-single.html#cb89-5" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> (z <span class="sc">*</span> smer_odchylka <span class="sc">/</span> delta)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb89-6"><a href="stats-test-single.html#cb89-6" aria-hidden="true" tabindex="-1"></a><span class="co"># zaokrouhlime</span></span>
<span id="cb89-7"><a href="stats-test-single.html#cb89-7" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">round</span>(n)</span></code></pre></div>
<p>Při odhadu volebních preferencí bychom chtěli, aby chyba odhadu u malých stran (preference okolo 5%) při <span class="math inline">\(\alpha=0.05\)</span> byla +/- 1 p.b. Pak bychom počítali <span class="math inline">\(n=(\frac{z_{0.975}*\sqrt{0.05(1-0.05)}}{0.01})^2\)</span>. K tomu, abychom u malých stran měli interval spolehlivosti pro hladinu spolehlivosti <span class="math inline">\(1-\alpha=\)</span> 0.95 s +/- 1 p.b, pak bychom potřebovali výběr o velikosti 1825.</p>
</div>
<div id="tests-many" class="section level2 hasAnchor" number="5.6">
<h2><span class="header-section-number">5.6</span> Mnoho testů<a href="stats-test-single.html#tests-many" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Jak jsme zmínili v <a href="stats-test-single.html#test-h0">5.1.2</a>, <span class="math inline">\(H_0\)</span> a <span class="math inline">\(H_1\)</span> je potřeba zvolit před použitím statistického testu. V případě, že používáme statistické testy pro nalezení vztahů mezi více proměnnými, narazíme na problém s FP. Abychom si tento případ ukázali, vytvoříme data, kde jsou na sobě všechny proměnné nezávislé. Každá proměnná pochází z rozdělení <span class="math inline">\(N(0, 1)\)</span>. U každé proměnné budeme testovat, zda platí <span class="math inline">\(H_0: \mu = 0\)</span> a <span class="math inline">\(H_1: \mu \ne 0\)</span>. Zajímá nás, kolik statisticky významných vztahů bychom v našich datech našli.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="stats-test-single.html#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># vytvorime nahodna data o 1000 pozorovanich a 200 promennych</span></span>
<span id="cb90-2"><a href="stats-test-single.html#cb90-2" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">1000</span></span>
<span id="cb90-3"><a href="stats-test-single.html#cb90-3" aria-hidden="true" tabindex="-1"></a>k <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb90-4"><a href="stats-test-single.html#cb90-4" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="cf">function</span>(x) <span class="fu">rnorm</span>(n))</span>
<span id="cb90-5"><a href="stats-test-single.html#cb90-5" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> <span class="fl">0.05</span></span>
<span id="cb90-6"><a href="stats-test-single.html#cb90-6" aria-hidden="true" tabindex="-1"></a><span class="co"># budeme ukaladat p hodnotu</span></span>
<span id="cb90-7"><a href="stats-test-single.html#cb90-7" aria-hidden="true" tabindex="-1"></a>p_hodnota <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, k)</span>
<span id="cb90-8"><a href="stats-test-single.html#cb90-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb90-9"><a href="stats-test-single.html#cb90-9" aria-hidden="true" tabindex="-1"></a>     <span class="co"># provedeme test test</span></span>
<span id="cb90-10"><a href="stats-test-single.html#cb90-10" aria-hidden="true" tabindex="-1"></a>     t_test <span class="ot">&lt;-</span> <span class="fu">t.test</span>(</span>
<span id="cb90-11"><a href="stats-test-single.html#cb90-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">x =</span> M[, i],</span>
<span id="cb90-12"><a href="stats-test-single.html#cb90-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">alternative =</span> <span class="st">&quot;two.sided&quot;</span>,</span>
<span id="cb90-13"><a href="stats-test-single.html#cb90-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">conf.level =</span> <span class="dv">1</span> <span class="sc">-</span> alpha,</span>
<span id="cb90-14"><a href="stats-test-single.html#cb90-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">mu =</span> <span class="dv">0</span></span>
<span id="cb90-15"><a href="stats-test-single.html#cb90-15" aria-hidden="true" tabindex="-1"></a>     )</span>
<span id="cb90-16"><a href="stats-test-single.html#cb90-16" aria-hidden="true" tabindex="-1"></a>     <span class="co"># ulozime p-hodnotu</span></span>
<span id="cb90-17"><a href="stats-test-single.html#cb90-17" aria-hidden="true" tabindex="-1"></a>     p_hodnota[i] <span class="ot">&lt;-</span> t_test<span class="sc">$</span>p.value</span>
<span id="cb90-18"><a href="stats-test-single.html#cb90-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb90-19"><a href="stats-test-single.html#cb90-19" aria-hidden="true" tabindex="-1"></a><span class="co"># pocet false positive</span></span>
<span id="cb90-20"><a href="stats-test-single.html#cb90-20" aria-hidden="true" tabindex="-1"></a>FP <span class="ot">&lt;-</span> <span class="fu">sum</span>(p_hodnota <span class="sc">&lt;=</span> alpha)</span>
<span id="cb90-21"><a href="stats-test-single.html#cb90-21" aria-hidden="true" tabindex="-1"></a><span class="co"># bonferroniho korekce</span></span>
<span id="cb90-22"><a href="stats-test-single.html#cb90-22" aria-hidden="true" tabindex="-1"></a>p_new <span class="ot">&lt;-</span> alpha <span class="sc">/</span> k</span>
<span id="cb90-23"><a href="stats-test-single.html#cb90-23" aria-hidden="true" tabindex="-1"></a>FP_new <span class="ot">&lt;-</span> <span class="fu">sum</span>(p_hodnota <span class="sc">&lt;=</span> p_new)</span></code></pre></div>
<p>Při počtu proměnných 200 provádíme 200 statistických testů. V našich datech jsme našli 14 statisticky významných výsledků (0.07% ze všech provedených testů). Tedy 14 false positive testů. Samozřejmě, v našich datech pocházejí všechny proměnné z rozdělení s průměrem 0 a jakýkoliv vztah je pouze v důsledku náhody. Podíl FP testů bude zhruba odpovídat zvolené chybě <span class="math inline">\(\alpha\)</span>. Jedním ze způsobů, jak se s tímto problémem vypořádat je pomocí <strong>Bonferroniho korekce</strong>, která bere v potaz počet provedených testů a upraví statisticky významnou p-hodnotu na novou hodnotu <span class="math inline">\(p_i \le \frac{\alpha}{m}\)</span>, kde <span class="math inline">\(m\)</span> je počet provedených testů. Pokud bychom bonferroniho korekci provedli na našem případu, pak by nová hodnota <span class="math inline">\(p_i\)</span>, za kterou zamítáme <span class="math inline">\(H_0\)</span> byla 0. Počet statisticky významných testů by tak byl 0. Jak ale víme z kapitoly <a href="stats-test-single.html#test-power">5.4</a>, snižování chyby I. druhu <span class="math inline">\(\alpha\)</span> vedek nárůstu FN, tedy chyby II. druhu <span class="math inline">\(\beta\)</span><a href="#fn30" class="footnote-ref" id="fnref30"><sup>30</sup></a>. Pokud je cílem pouze exploratorní analýza velkého počtu dat, je možné použít očekávanou hodnotu pozitivních testů jako kritérium pro určení toho, zda některé z pozitivních testů jsou TP. Počet pozitivních testů je náhodná proměnná a lze ji modelovat poissonových rozdělením <a href="prob-dist.html#pois-dist">3.6</a>. V našem případě při <span class="math inline">\(\alpha=\)</span> 0.05 bychom z 200 testů očekávali 10 pozitivních testů jenom vlivem náhody. Graf <a href="stats-test-single.html#fig:test-pois">5.7</a> ukazuje očekávané rozdělení pro <span class="math inline">\(Poisson(\)</span> 10 <span class="math inline">\()\)</span>. Můžeme potom vyučít CDF, abychom vypočítali pravděpodobnost, že z 200 testů jich bude právě <span class="math inline">\(q\)</span> pozitivních, tedy <span class="math inline">\(P(x &gt; q)\)</span>.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="stats-test-single.html#cb91-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">30</span></span>
<span id="cb91-2"><a href="stats-test-single.html#cb91-2" aria-hidden="true" tabindex="-1"></a>lambda <span class="ot">&lt;-</span> alpha <span class="sc">*</span> k</span>
<span id="cb91-3"><a href="stats-test-single.html#cb91-3" aria-hidden="true" tabindex="-1"></a>pmf <span class="ot">&lt;-</span> <span class="fu">dpois</span>(x, lambda)</span>
<span id="cb91-4"><a href="stats-test-single.html#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, pmf,</span>
<span id="cb91-5"><a href="stats-test-single.html#cb91-5" aria-hidden="true" tabindex="-1"></a>     <span class="at">type =</span> <span class="st">&quot;h&quot;</span>, <span class="at">lwd =</span> <span class="dv">5</span>,</span>
<span id="cb91-6"><a href="stats-test-single.html#cb91-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">col =</span> <span class="st">&quot;#1f77b4&quot;</span>,</span>
<span id="cb91-7"><a href="stats-test-single.html#cb91-7" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">&quot;s&quot;</span>,</span>
<span id="cb91-8"><a href="stats-test-single.html#cb91-8" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">&quot;PMF&quot;</span>,</span>
<span id="cb91-9"><a href="stats-test-single.html#cb91-9" aria-hidden="true" tabindex="-1"></a>     <span class="at">main =</span> <span class="fu">paste0</span>(<span class="st">&quot;Poisson(&quot;</span>, <span class="fu">round</span>(lambda, <span class="dv">2</span>), <span class="st">&quot;)&quot;</span>)</span>
<span id="cb91-10"><a href="stats-test-single.html#cb91-10" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="figure"><span style="display:block;" id="fig:test-pois"></span>
<img src="book_files/figure-html/test-pois-1.png" alt="Očekávaný počet pozitivních testů z 200" width="672" />
<p class="caption">
Graf 5.7: Očekávaný počet pozitivních testů z 200
</p>
</div>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="stats-test-single.html#cb92-1" aria-hidden="true" tabindex="-1"></a>cdf <span class="ot">&lt;-</span> <span class="fu">ppois</span>(FP, lambda, <span class="at">lower.tail =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>V našem případě, kdy máme 14 pozitivních testů, je <span class="math inline">\(P(x &gt;\)</span> 14 <span class="math inline">\()=\)</span> 0.08. V případě, že by některé pozitivní testy byly TP, by tato pravděpodobnost byla malá. My bychom potom například mohli vybrat testy s nejmenší p-hodnotou a tyto proměnné dále prozkoumat.</p>

</div>
</div>
<div class="footnotes">
<hr />
<ol start="23">
<li id="fn23"><p>Více o tématu falzifikace např. <a href="https://cs.wikipedia.org/wiki/Falzifikovatelnost">zde</a>.<a href="stats-test-single.html#fnref23" class="footnote-back">↩︎</a></p></li>
<li id="fn24"><p>Nelze trávit méně než 0 minut.<a href="stats-test-single.html#fnref24" class="footnote-back">↩︎</a></p></li>
<li id="fn25"><p>Velmi pravděpodobně hodnota parametru nebude rovna právě <span class="math inline">\(H_0\)</span>.<a href="stats-test-single.html#fnref25" class="footnote-back">↩︎</a></p></li>
<li id="fn26"><p>V případě pravostranného testu bychom počítali <span class="math inline">\(P(x_i \ge \overline{x})\)</span>. V případě oboustranného testu bychom počítali <span class="math inline">\(P(x_i \le \overline{x})\)</span> &amp; <span class="math inline">\(P(x_i \ge \overline{x})\)</span>.<a href="stats-test-single.html#fnref26" class="footnote-back">↩︎</a></p></li>
<li id="fn27"><p>TP = true positive, TN = true negative, FP = false positive, FN = false negative.<a href="stats-test-single.html#fnref27" class="footnote-back">↩︎</a></p></li>
<li id="fn28"><p>Tedy jako t-test s větším počtem pozorování<a href="stats-test-single.html#fnref28" class="footnote-back">↩︎</a></p></li>
<li id="fn29"><p>Tedy za předpokladu <span class="math inline">\(H_0\)</span> a za předpokladu <span class="math inline">\(H_1\)</span>.<a href="stats-test-single.html#fnref29" class="footnote-back">↩︎</a></p></li>
<li id="fn30"><p>Řekneme, že nelze vyvrátit <span class="math inline">\(H_0\)</span>, i když ve skutečnosti neplatí.<a href="stats-test-single.html#fnref30" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="dist-params.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="porovnání-dvou-průměrů-a-relativních-četností.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection",
"download": false
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
